<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.3.0 -->
  <title>Squirrel Prover - Squirrel Prover</title>

  <!--  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'> -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  <link rel="stylesheet" href="style.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

</head>

<body>
  <a id="anchor-top"></a>
  <section class="page-header">
<!--    <a href="index.html"><img src="logo/logo-full.png" width = 530px></a> -->
    <h2 class="project-tagline">Squirrel Prover</h2>
    <h3 class="project-name">(soon with an awesome logo!)</h3>
    <a class="btn" href="https://github.com/squirrel-prover/squirrel-prover/#readme"><i class="fa fa-laptop"></i> Install</a>
    <a class="btn" href="tutorial.html"><i class="fa fa-graduation-cap"></i> Tutorial</a>
    <a class="btn" href="https://github.com/squirrel-prover/squirrel-prover/"><i class="fa fa-file-code-o"></i> Source code</a>
    <a class="btn" href="index.html#refs"><i class="fa fa-file-o"></i> Publications</a>
  </section>

  <div>
    <section class="main-content">

      <h1></h1>

<!-- do not indent this line, may cause indentation problems in fenced code blocks! -->
<h1 id="about-this-tutorial">About This Tutorial</h1>
<p>This tutorial is extracted from <strong>Squirell</strong> repository file <a href="https://github.com/squirrel-prover/squirrel-prover/blob/master/examples/tutorial/tutorial.sp%60">squirrel-prover/examples/tutorial.sp</a></p>
<p>If you have installed <strong>Squirrel</strong> along with <em>Proof General</em> (cf. <a href="https://github.com/squirrel-prover/squirrel-prover#readme">readme</a>), you can also open this file with <em>emacs</em> and all code blocks provided bellow will be executable.</p>
<h1 id="protocol-modelling">Protocol modelling</h1>
<h2 id="messages">Messages</h2>
<p>Messages exchanged by a protocol are modelled using <em>terms</em>.</p>
<p>Concretely, a message is either</p>
<ul>
<li>a name <code>n</code> used to model a random sampling;</li>
<li>the application of a function <code>f(m_1,...,m_k)</code>.</li>
</ul>
<p>In <strong>Squirrel</strong>, a function symbol without any assumption can be defined with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode squirrel"><code class="sourceCode squirrel"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a>  <span class="kw">abstract</span> ok : message</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>  <span class="kw">abstract</span> ko : message</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a>  <span class="kw">abstract</span> f1 : message -&gt; message</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a>  <span class="kw">abstract</span> f2 : message -&gt; message -&gt; message.</span></code></pre></div>
<p><code>ok</code> and <code>ko</code> are constants, and <code>f1</code> is a function that expects a message, and then return a message. <code>f2</code> is then a function symbol of arity two, and function symbols of any arity can be defined this way.</p>
<p>A name <code>n</code> allows to model secret keys, or some random challenge. As we wish to be able to refer to an unbounded number of session, we allow names to be indexed, each value of the index yielding a fresh independent random. We denote by <code>n[i]</code> an indexed name, with variable <code>i</code> as an index. Names can be indexed by any number of indices.</p>
<p>In the tool, one can declare names and indexed names with the following.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode squirrel"><code class="sourceCode squirrel"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a>  <span class="kw">name</span> n : message</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>  <span class="kw">name</span> n1 : index -&gt; message</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a>  <span class="kw">name</span> n2 : index -&gt; index -&gt; message.</span></code></pre></div>
<p>To model a setting where multiple people each have their own secret key, one could declare an indexed name as follows.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode squirrel"><code class="sourceCode squirrel"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="kw">name</span> key : index -&gt; message.</span></code></pre></div>
<h2 id="cryptographic-assumptions">Cryptographic assumptions</h2>
<p>Symbol functions can be defined as being an encryption, or a hash function, or a signature, or… The tool will then assume that such functions satisfy some classical cryptographic assumptions.</p>
<p>The possible sorts and corresponding assumptions are:</p>
<ul>
<li>encryption, <strong>CCA1</strong> &amp; <strong>INT-CTXT</strong>, symmetric and asymmetric</li>
<li>signatures, <strong>EUF-CMA</strong></li>
<li>hash functions, <strong>PRF</strong>, and thus <strong>EUF-CMA</strong>, <strong>CR</strong></li>
</ul>
<p>Each are declared in the following way.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode squirrel"><code class="sourceCode squirrel"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="kw">signature</span> sign,checksign,pk</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="kw">hash</span> h</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="kw">senc</span> enc,dec</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="kw">aenc</span> asenc,asdec,aspk.</span></code></pre></div>
<h2 id="protocols">Protocols</h2>
<p>Protocols are described inside a pi-calculus. It is based on the following constructs:</p>
<ul>
<li><code>new n</code> id used to instantiate a fresh name;</li>
<li><code>out(c,m)</code> is used to send the term <code>m</code> over the channel <code>c</code>;</li>
<li><code>in(c,x)</code> is used to receive some value from channel <code>c</code>, bound to the variable <code>x</code>;</li>
<li><code>act; P</code> correspond to the sequential composition of action <code>act</code> with process <code>P</code>; … TODO</li>
</ul>
<p>As an example, we use a small <em>RFID</em> based protocol, with a tag and a reader, called the basic hash protocol:</p>
<ul>
<li>Mayla Brusò, Kostas Chatzikokolakis, and Jerry den Hartog. <em>Formal Verification of Privacy for RFID Systems</em>. pages 75–88, July 2010.</li>
</ul>
<pre><code>T --&gt; R : &lt;nT, h(nT,kT)&gt;
R --&gt; T : ok</code></pre>
<p>We first declare the channels used by the protocol. Remark that channels are mostly byproducts of the theory, and do not play a big role.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode squirrel"><code class="sourceCode squirrel"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">channel</span> cT</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="kw">channel</span> cR.</span></code></pre></div>
<p>We then define a first process of a protocol, which may correspond to multiple identies, and thus depend on some index variable <code>i</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode squirrel"><code class="sourceCode squirrel"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="kw">process</span> tag(i:index) =</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a>  <span class="st">new</span> nT;</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a>  T : <span class="st">out</span>(cT, &lt;nT, h(nT,key(i))&gt;).</span></code></pre></div>
<p>We can then declare the reader.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode squirrel"><code class="sourceCode squirrel"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="kw">process</span> reader(j:index) =</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>  <span class="st">in</span>(cT,x);</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>  try find i such that snd(x) = h(fst(x),key(i)) <span class="st">in</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a>   R : <span class="st">out</span>(cR,ok)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a>  <span class="st">else</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true"></a>    <span class="st">out</span>(cR,ko).</span></code></pre></div>
<p>And we finally declare the final system. We instantiate multiple copies of the reader, and for each value <code>i</code>, we also instantiate multilpe copies of <code>tag(i)</code> with the replicaiton over <code>k</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode squirrel"><code class="sourceCode squirrel"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="kw">system</span> ((!_j reader(j)) | (!_i !_k tag(i))).</span></code></pre></div>
<p>A system declared this way is given the name <code>default</code>. Other systems can be defined and given an epxlicit name. For instance, the following declare the system <code>simple</code>, where each tag can only be executed once for each identity.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode squirrel"><code class="sourceCode squirrel"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="kw">system</span> [simple] ((!_j reader(j)) | (!_i tag(i))).</span></code></pre></div>
<h1 id="reachability-properties">Reachability properties</h1>
<p>We express reachabilities formulas inside a first-order logic. In this logic, terms can be of type <code>message</code>, <code>boolean</code>, <code>index</code> and <code>timestamp</code>. The logic proves that formulas are true for all possible traces of the protocol, and for all possible values of the variable given this trace/</p>
<p>For instance, a timestamp variable <code>t</code> allows to talk about a given point inside a trace. <code>t</code> will intuitively have to take the value of some concrete action, e.g., <code>T(i)</code> or <code>R(j)</code> in our example.</p>
<h2 id="macros">Macros</h2>
<p>To discuss about the value of the output performed at some timestamp, we use macros: * <code>input@t</code> is the value given as input by the attacker to the action at t; * <code>output@t</code> is the output performed by action at t; * <code>cond@t</code> is the executability condition at t; * <code>frame@t</code> is the sequence of all previous outputs up to t; * <code>exec@t</code> is the conjonction of all executability conditions up to t.</p>
<h2 id="formulas">Formulas</h2>
<p>It is then possible to write formulas that capture properties satisfied by all executions of the protocol. For instance, the following formula describes that the executability execution of the reader in fact implies some authentication property, in the sense that there must exists an action T(i,k) that was executed before the reader, and such the input of the reader corresonds to the name of T(i,k).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode squirrel"><code class="sourceCode squirrel"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="kw">goal</span> wa :</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a>  <span class="kw">forall</span> (i:index, j:index),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a>  happens(R(j,i)) =&gt;</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a>     cond@R(j,i) =&gt;</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a>         <span class="kw">exists</span> (k:index),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a>              T(i,k) &lt;= R(j,i) &amp;&amp; fst(input@R(j,i)) = nT(i,k).</span></code></pre></div>
<p>We write bellow the simple proof of this statement. Once inside a proof context, delimited by <code>Proof.</code> and <code>Qed.</code>, it is possible to get the list of available tactics by typing <code>help.</code>, and details about any tactic with <code>help tacticname.</code></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode squirrel"><code class="sourceCode squirrel"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="kw">Proof</span>.</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a><span class="kw">help</span>.</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a><span class="kw">help</span> <span class="kw">simpl</span>.</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a><span class="kw">simpl</span>.</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true"></a><span class="kw">expand</span> cond@R(j,i).</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true"></a><span class="kw">euf</span> H.</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true"></a>by <span class="kw">exists</span> k.</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true"></a><span class="kw">Qed</span>.</span></code></pre></div>
<h1 id="indistinguishability-properties">Indistinguishability properties</h1>
<p>WIP</p>
<p>*)</p>

      <hr>
      <div class="footer-nav">
        <div class="footer-nav-Body">
          <div class="footer-nav-Row">
            <div class="footer-nav-Left">&nbsp;</div>
            <div class="footer-nav-Mid"><a href="#anchor-top">Top</a></div>
            <div class="footer-nav-Right">&nbsp;</div>
          </div>
        </div>
      </div>
    </section>


  </div>
</body>
