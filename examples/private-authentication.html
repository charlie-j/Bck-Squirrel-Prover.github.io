<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="UTF-8">

  <title>Squirrel Prover - Squirrel Prover</title>
  
  <link rel="stylesheet" href="style.css">
</head>

<body>
<span style="display: none;"><span class="input-line" id="in0">(*******************************************************************************
PRIVATE AUTHENTICATION

The Private Authentication protocol as described in [F] involves an initiator A
and a responder B.
The initiator A sends a message `enc(&lt;pkA,n0&gt;,r0,pkB)` to the responder B,
where `pkA` (respectively `pkB`) is the public key of A (respectively B).
The responder B checks that the first projection of the decryption of the 
received message is equal to `pkA` and that the second projection of the 
decryption of the received message has a correct length.
In that case, B sends back `enc(&lt;n0,n&gt;,r,pkA)`.

The protocol is as follows:

A -&gt; B : enc(&lt;pkA,n0&gt;,r0,pkB)
B -&gt; A : enc(&lt;n0,n&gt;,r,pkA)

This is a &quot;light&quot; model without the last check of A.

In this file, we prove anonymity, _i.e._ that an attacker cannot tell whether 
a session is initiated by an identity A or by an identity Abis.

[F] G. Bana and H. Comon-Lundh. A computationally complete symbolic
attacker for equivalence properties. In 2014 ACM Conference on
Computer and Communications Security, CCS ’14, pages 609–620.
ACM, 2014
*******************************************************************************)
(**
When this option is set to `true`, Squirrel checks whether each tactic invoked
for the proof is also sound for quantum attackers.
**)
set postQuantumSound=true.</span><span class="output-line" id="out0">true
</span><span class="input-line" id="in1">

(** 
We first declare the communication channels, the function symbols for the public
encryption scheme as well as the several names used in the protocol's messages. 
**)

channel cA
channel cAbis
channel cB
channel cO

aenc enc,dec,pk

name kA : message
name kAbis : message
name kB : message

name n0 : index -&gt; message
name r0 : index -&gt; message
name n0bis : index -&gt; message
name r0bis : index -&gt; message

name n : index -&gt; message
name r : index -&gt; message.</span><span class="output-line" id="out1"></span><span class="input-line" id="in2">

(**
We also declare a public function symbol `plus`, which we will use to model
the addition of lengths of messages.
**)

abstract plus : message -&gt; message -&gt; message.</span><span class="output-line" id="out2"></span><span class="input-line" id="in3">

(**
The initiator A is indexed by `i` to represent an unbounded number of sessions
and is defined by a single output.
**)
process A(i:index) =
  out(cA, enc(&lt;pk(kA),n0(i)&gt;,r0(i),pk(kB))).</span><span class="output-line" id="out3"></span><span class="input-line" id="in4">

(**
We define a similar process for the initiator Abis.
**)
process Abis(i:index) =
  out(cAbis, enc(&lt;pk(kAbis),n0bis(i)&gt;,r0bis(i),pk(kB))).</span><span class="output-line" id="out4"></span><span class="input-line" id="in5">

(**
The responder B is indexed by `j` to represent an unbounded number of sessions.
In order to express anonymity using an equivalence property, we model two 
systems using the `diff` operator.
On the left side, the key `kA` is used while the right side uses the key `kAbis`.
**)
process B(j:index) =
  in(cB, mess);
  let dmess = dec(mess, kB) in
  out(cB,
    enc(
      (if fst(dmess) = diff(pk(kA),pk(kAbis)) &amp;&amp; len(snd(dmess)) = len(n(j)) then
         &lt;snd(dmess), n(j)&gt;
       else
         &lt;n(j), n(j)&gt;),
      r(j), pk(diff(kA,kAbis)))
  ).</span><span class="output-line" id="out5"></span><span class="input-line" id="in6">

(**
The protocol is finally defined by a system where an unbounded number of 
sessions for A, Abis and B play in parallel, after having outputted the 
public keys of A, Abis and B.
**)
system O: 
  out(cO,&lt;&lt;pk(kA),pk(kAbis)&gt;,pk(kB)&gt;); 
  (!_i A(i) | !_ibis Abis(ibis) | !_j B(j)).</span><span class="output-line" id="out6">Un-processed system:
  
  O:
  <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cO</span>,pair(pair(pk(kA),pk(kAbis)),pk(kB)));
  (!_i <span class="pn" style="font-weight:bold; color: #0000AA">A</span> i) | ((!_ibis <span class="pn" style="font-weight:bold; color: #0000AA">Abis</span> ibis) | (!_j <span class="pn" style="font-weight:bold; color: #0000AA">B</span> j))

Processed system:
  
  O:
  <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cO</span>,pair(pair(pk(kA),pk(kAbis)),pk(kB)));
  (!_i A: <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cA</span>,enc(pair(pk(kA),n0(i)),r0(i),pk(kB))); <span class="pn" style="font-weight:bold; color: #0000AA">null</span>) |
  ((!_ibis
      Abis:
      <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cAbis</span>,enc(pair(pk(kAbis),n0bis(ibis)),r0bis(ibis),pk(kB))); <span class="pn" style="font-weight:bold; color: #0000AA">null</span>) |
   (!_j
      <span class="pio" style="font-weight: bold">in</span>(<span class="pc">cB</span>,<span class="pv" style="font-weight: bold; color: #AA00AA">mess</span>);
      <span class="pk" style="font-weight: bold">let</span> <span class="pv" style="font-weight: bold; color: #AA00AA">dmess</span> = dec(mess,kB) <span class="pk" style="font-weight: bold">in</span>
      B:
      <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cB</span>,
      enc(<span>if</span>
          (fst(dmess(j)) = <span>diff</span>(pk(kA),pk(kAbis)) &amp;&amp;
           len(snd(dmess(j))) = len(n(j)))
          <span>then</span> pair(snd(dmess(j)),n(j)) <span>else</span> pair(n(j),n(j)),r(j),
           pk(<span>diff</span>(kA,kAbis)))); <span class="pn" style="font-weight:bold; color: #0000AA">null</span>))

System default registered with actions (init,O,A,Abis,B).
</span><span class="input-line" id="in7">

(**
This axiom states that the length of a pair is equal to the sum of the lengths
of each component of the pair.
**)

axiom length (m1:message, m2:message): len(&lt;m1,m2&gt;) = plus(len(m1),len(m2)).</span><span class="output-line" id="out7"></span><span class="input-line" id="in8">

(** Helper lemma for pushing conditionals under the `len(_)` function. **)
goal if_len (b : boolean, y,z:message):
  len(if b then y else z) =
  (if b then len(y) else len(z)).</span><span class="output-line" id="out8">Goal if_len :
  <span class="gf" style="font-weight: bold">len</span>(if b then y else z) = if b then <span class="gf" style="font-weight: bold">len</span>(y) else <span class="gf" style="font-weight: bold">len</span>(z)
</span><span class="input-line" id="in9">
Proof.</span><span class="output-line" id="out9">[goal&gt; Focused goal (1/1):
System: default
Variables: b:bool,y,z:message
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="gf" style="font-weight: bold">len</span>(if b then y else z) = if b then <span class="gf" style="font-weight: bold">len</span>(y) else <span class="gf" style="font-weight: bold">len</span>(z)

</span><span class="input-line" id="in10"> 
  case b;
  try ((yesif; yesif) + (noif; noif)).</span><span class="output-line" id="out10">[&gt; Line 118: ((case b);(try ((yesif;yesif)+(noif;noif)))) 
[goal&gt; Goal if_len is proved 
</span><span class="input-line" id="in11">
Qed.</span><span class="output-line" id="out11">Exiting proof mode.


</span><span class="input-line" id="in12">

(** 
The anonymity property is expressed as an equivalence between the left side 
(the one using `kA` and the right side (the one using `kAbis`) of the system.
This property is expressed by the logic formula `forall t:timestamp, frame@t`
where `frame@t` is a bi-frame.
**)
equiv anonymity.</span><span class="output-line" id="out12">Goal anonymity :
  forall t:timestamp, <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@t
</span><span class="input-line" id="in13">
(**
The high-level idea of the proof is as follows: we show that the message 
outputted by the role B does not give any element to the attacker
to distinguish the left side from the right side, relying on the fact that
encryption satisfies key privacy and IND-CCA1 assumptions.
**)
Proof.</span><span class="output-line" id="out13">[goal&gt; Focused goal (1/1):
Systems: default
Variables: t:timestamp
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)]
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@t


</span><span class="input-line" id="in14">
  (**
  We start by adding to the frame the two public keys `pk(kA)`, `pk(kAbis)`
  and `pk(kB)` since any execution starts by the action `O` outputting them.
  This allows to simplify some cases in the proof below.
  **)
  enrich pk(kA), pk(kAbis), pk(kB).</span><span class="output-line" id="out14">[&gt; Line 140: (enrich pk(kA), pk(kAbis), pk(kB)) 
[goal&gt; Focused goal (1/1):
Systems: default
Variables: t:timestamp
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)]
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@t


</span><span class="input-line" id="in15">

  induction t.</span><span class="output-line" id="out15">[&gt; Line 142: (induction t) 
[goal&gt; Focused goal (1/4):
Systems: default
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">O</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">O</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@<span class="ga" style="color: #00AA00">O</span>


</span><span class="input-line" id="in16">

  (** Case where t = O.
  This case is trivial thanks to the addition of `pk(kA)`, `pk(kAbis)`
  and `pk(kB)` in the frame.
  **)
  expandall.</span><span class="output-line" id="out16">[&gt; Line 148: expandall 
[goal&gt; Focused goal (1/4):
Systems: default
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">O</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">O</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: &lt;<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">O</span>),
    &lt;<span class="gf" style="font-weight: bold">of_bool</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">O</span>) &amp;&amp; true),
     if (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">O</span>) &amp;&amp; true) then &lt;&lt;<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)&gt;,<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)&gt;&gt;&gt;


</span><span class="input-line" id="in17">
  fa 3.</span><span class="output-line" id="out17">[&gt; Line 149: (fa 3) 
[goal&gt; Focused goal (1/3):
Systems: default
Variables: i:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">A(i)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@<span class="ga" style="color: #00AA00">A(i)</span>


</span><span class="input-line" id="in18">

  (** Case where t = A(i).
  The output of this action is the same on both sides. We show that this
  output can be removed from the frame so that we can conclude by 
  induction hypothesis.
  We start by expanding all macros and splitting the pairs and function
  applications. We are then left with the two names `n0(i)` and `r0(i)` 
  used for the encryption. These names are fresh (_i.e._ does not appear
  anywhere else in the frame) so we are able to remove them with the
  `fresh` tactic.
  **)
  expandall.</span><span class="output-line" id="out18">[&gt; Line 161: expandall 
[goal&gt; Focused goal (1/3):
Systems: default
Variables: i:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">A(i)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: &lt;<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>),
    &lt;<span class="gf" style="font-weight: bold">of_bool</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>) &amp;&amp; true),
     if (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>) &amp;&amp; true) then <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>),<span class="gn" style="color: #AA5500">n0</span>(i)&gt;,<span class="gn" style="color: #AA5500">r0</span>(i),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>))&gt;&gt;


</span><span class="input-line" id="in19">
  fa 3.</span><span class="output-line" id="out19">[&gt; Line 162: (fa 3) 
[goal&gt; Focused goal (1/3):
Systems: default
Variables: i:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">A(i)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>)
4: &lt;<span class="gf" style="font-weight: bold">of_bool</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>) &amp;&amp; true),
    if (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>) &amp;&amp; true) then <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>),<span class="gn" style="color: #AA5500">n0</span>(i)&gt;,<span class="gn" style="color: #AA5500">r0</span>(i),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>))&gt;


</span><span class="input-line" id="in20"> fa 4.</span><span class="output-line" id="out20">[&gt; Line 162: (fa 4) 
[goal&gt; Focused goal (1/3):
Systems: default
Variables: i:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">A(i)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>)
4: if (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>) &amp;&amp; true) then <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>),<span class="gn" style="color: #AA5500">n0</span>(i)&gt;,<span class="gn" style="color: #AA5500">r0</span>(i),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>))


</span><span class="input-line" id="in21"> fa 4.</span><span class="output-line" id="out21">[&gt; Line 162: (fa 4) 
[goal&gt; Focused goal (1/3):
Systems: default
Variables: i:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">A(i)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>)
4: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>),<span class="gn" style="color: #AA5500">n0</span>(i)&gt;,<span class="gn" style="color: #AA5500">r0</span>(i),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>))


</span><span class="input-line" id="in22"> fa 4.</span><span class="output-line" id="out22">[&gt; Line 162: (fa 4) 
[goal&gt; Focused goal (1/3):
Systems: default
Variables: i:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">A(i)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>)
4: &lt;<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>),<span class="gn" style="color: #AA5500">n0</span>(i)&gt;
5: <span class="gn" style="color: #AA5500">r0</span>(i)


</span><span class="input-line" id="in23"> fa 4.</span><span class="output-line" id="out23">[&gt; Line 162: (fa 4) 
[goal&gt; Focused goal (1/3):
Systems: default
Variables: i:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">A(i)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>)
4: <span class="gn" style="color: #AA5500">n0</span>(i)
5: <span class="gn" style="color: #AA5500">r0</span>(i)


</span><span class="input-line" id="in24"> 
  fresh 5.</span><span class="output-line" id="out24">[&gt; Line 163: (fresh 5) 
[goal&gt; Focused goal (1/3):
Systems: default
Variables: i:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">A(i)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>)
4: <span class="gn" style="color: #AA5500">n0</span>(i)
5: if (forall (i0:index), (<span class="ga" style="color: #00AA00">A(i0)</span> &lt; <span class="ga" style="color: #00AA00">A(i)</span> =&gt; i0 &lt;&gt; i)) then <span class="gf" style="font-weight: bold">zero</span> else <span class="gn" style="color: #AA5500">r0</span>(i)


</span><span class="input-line" id="in25"> yesif 5.</span><span class="output-line" id="out25">[&gt; Line 163: (yesif 5) 
[goal&gt; Focused goal (1/3):
Systems: default
Variables: i:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">A(i)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>)
4: <span class="gn" style="color: #AA5500">n0</span>(i)


</span><span class="input-line" id="in26">
  fresh 4.</span><span class="output-line" id="out26">[&gt; Line 164: (fresh 4) 
[goal&gt; Focused goal (1/3):
Systems: default
Variables: i:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">A(i)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">A(i)</span>)
4: if (forall (i0:index), (<span class="ga" style="color: #00AA00">A(i0)</span> &lt; <span class="ga" style="color: #00AA00">A(i)</span> =&gt; i0 &lt;&gt; i)) then <span class="gf" style="font-weight: bold">zero</span> else <span class="gn" style="color: #AA5500">n0</span>(i)


</span><span class="input-line" id="in27"> yesif 4.</span><span class="output-line" id="out27">[&gt; Line 164: (yesif 4) 
[goal&gt; Focused goal (1/2):
Systems: default
Variables: ibis:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@<span class="ga" style="color: #00AA00">Abis(ibis)</span>


</span><span class="input-line" id="in28">

  (** Case where t = Abis(ibis).
  Similar to the previous case.
  **)
  expandall.</span><span class="output-line" id="out28">[&gt; Line 169: expandall 
[goal&gt; Focused goal (1/2):
Systems: default
Variables: ibis:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: &lt;<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>),
    &lt;<span class="gf" style="font-weight: bold">of_bool</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>) &amp;&amp; true),
     if (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>) &amp;&amp; true) then
       <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>),<span class="gn" style="color: #AA5500">n0bis</span>(ibis)&gt;,<span class="gn" style="color: #AA5500">r0bis</span>(ibis),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>))&gt;&gt;


</span><span class="input-line" id="in29">
  fa 3.</span><span class="output-line" id="out29">[&gt; Line 170: (fa 3) 
[goal&gt; Focused goal (1/2):
Systems: default
Variables: ibis:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)
4: &lt;<span class="gf" style="font-weight: bold">of_bool</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>) &amp;&amp; true),
    if (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>) &amp;&amp; true) then
      <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>),<span class="gn" style="color: #AA5500">n0bis</span>(ibis)&gt;,<span class="gn" style="color: #AA5500">r0bis</span>(ibis),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>))&gt;


</span><span class="input-line" id="in30"> fa 4.</span><span class="output-line" id="out30">[&gt; Line 170: (fa 4) 
[goal&gt; Focused goal (1/2):
Systems: default
Variables: ibis:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)
4: if (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>) &amp;&amp; true) then
     <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>),<span class="gn" style="color: #AA5500">n0bis</span>(ibis)&gt;,<span class="gn" style="color: #AA5500">r0bis</span>(ibis),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>))


</span><span class="input-line" id="in31"> fa 4.</span><span class="output-line" id="out31">[&gt; Line 170: (fa 4) 
[goal&gt; Focused goal (1/2):
Systems: default
Variables: ibis:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)
4: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>),<span class="gn" style="color: #AA5500">n0bis</span>(ibis)&gt;,<span class="gn" style="color: #AA5500">r0bis</span>(ibis),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>))


</span><span class="input-line" id="in32"> fa 4.</span><span class="output-line" id="out32">[&gt; Line 170: (fa 4) 
[goal&gt; Focused goal (1/2):
Systems: default
Variables: ibis:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)
4: &lt;<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>),<span class="gn" style="color: #AA5500">n0bis</span>(ibis)&gt;
5: <span class="gn" style="color: #AA5500">r0bis</span>(ibis)


</span><span class="input-line" id="in33"> fa 4.</span><span class="output-line" id="out33">[&gt; Line 170: (fa 4) 
[goal&gt; Focused goal (1/2):
Systems: default
Variables: ibis:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)
4: <span class="gn" style="color: #AA5500">n0bis</span>(ibis)
5: <span class="gn" style="color: #AA5500">r0bis</span>(ibis)


</span><span class="input-line" id="in34"> 
  fresh 5.</span><span class="output-line" id="out34">[&gt; Line 171: (fresh 5) 
[goal&gt; Focused goal (1/2):
Systems: default
Variables: ibis:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)
4: <span class="gn" style="color: #AA5500">n0bis</span>(ibis)
5: if (forall (ibis0:index), (<span class="ga" style="color: #00AA00">Abis(ibis0)</span> &lt; <span class="ga" style="color: #00AA00">Abis(ibis)</span> =&gt; ibis0 &lt;&gt; ibis))
     then <span class="gf" style="font-weight: bold">zero</span> else <span class="gn" style="color: #AA5500">r0bis</span>(ibis)


</span><span class="input-line" id="in35"> yesif 5.</span><span class="output-line" id="out35">[&gt; Line 171: (yesif 5) 
[goal&gt; Focused goal (1/2):
Systems: default
Variables: ibis:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)
4: <span class="gn" style="color: #AA5500">n0bis</span>(ibis)


</span><span class="input-line" id="in36">
  fresh 4.</span><span class="output-line" id="out36">[&gt; Line 172: (fresh 4) 
[goal&gt; Focused goal (1/2):
Systems: default
Variables: ibis:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Abis(ibis)</span>)
4: if (forall (ibis0:index), (<span class="ga" style="color: #00AA00">Abis(ibis0)</span> &lt; <span class="ga" style="color: #00AA00">Abis(ibis)</span> =&gt; ibis0 &lt;&gt; ibis))
     then <span class="gf" style="font-weight: bold">zero</span> else <span class="gn" style="color: #AA5500">n0bis</span>(ibis)


</span><span class="input-line" id="in37"> yesif 4.</span><span class="output-line" id="out37">[&gt; Line 172: (yesif 4) 
[goal&gt; Focused goal (1/1):
Systems: default
Variables: j:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">B(j)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@<span class="ga" style="color: #00AA00">B(j)</span>


</span><span class="input-line" id="in38">

  (** Case where t = B(j). 
  We have to show that the output message does not give any information
  to the attacker to distinguish the left side from the right side.
  **)
  expand frame, output, exec, cond, dmess.</span><span class="output-line" id="out38">[&gt; Line 178: (expand frame, output, exec, cond, dmess) 
[goal&gt; Focused goal (1/1):
Systems: default
Variables: j:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">B(j)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: &lt;<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>),
    &lt;<span class="gf" style="font-weight: bold">of_bool</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>) &amp;&amp; true),
     if (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>) &amp;&amp; true) then
       <span class="gf" style="font-weight: bold">enc</span>(if (<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>)) = diff(<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)) &amp;&amp;
               <span class="gf" style="font-weight: bold">len</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>))) = <span class="gf" style="font-weight: bold">len</span>(<span class="gn" style="color: #AA5500">n</span>(j))) then
             &lt;<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>)),<span class="gn" style="color: #AA5500">n</span>(j)&gt; else &lt;<span class="gn" style="color: #AA5500">n</span>(j),<span class="gn" style="color: #AA5500">n</span>(j)&gt;,<span class="gn" style="color: #AA5500">r</span>(j),
       <span class="gf" style="font-weight: bold">pk</span>(diff(<span class="gn" style="color: #AA5500">kA</span>,<span class="gn" style="color: #AA5500">kAbis</span>)))&gt;&gt;


</span><span class="input-line" id="in39">
  fa 3.</span><span class="output-line" id="out39">[&gt; Line 179: (fa 3) 
[goal&gt; Focused goal (1/1):
Systems: default
Variables: j:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">B(j)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
4: &lt;<span class="gf" style="font-weight: bold">of_bool</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>) &amp;&amp; true),
    if (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>) &amp;&amp; true) then
      <span class="gf" style="font-weight: bold">enc</span>(if (<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>)) = diff(<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)) &amp;&amp;
              <span class="gf" style="font-weight: bold">len</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>))) = <span class="gf" style="font-weight: bold">len</span>(<span class="gn" style="color: #AA5500">n</span>(j))) then
            &lt;<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>)),<span class="gn" style="color: #AA5500">n</span>(j)&gt; else &lt;<span class="gn" style="color: #AA5500">n</span>(j),<span class="gn" style="color: #AA5500">n</span>(j)&gt;,<span class="gn" style="color: #AA5500">r</span>(j),
      <span class="gf" style="font-weight: bold">pk</span>(diff(<span class="gn" style="color: #AA5500">kA</span>,<span class="gn" style="color: #AA5500">kAbis</span>)))&gt;


</span><span class="input-line" id="in40"> fa 4.</span><span class="output-line" id="out40">[&gt; Line 179: (fa 4) 
[goal&gt; Focused goal (1/1):
Systems: default
Variables: j:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">B(j)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
4: if (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>) &amp;&amp; true) then
     <span class="gf" style="font-weight: bold">enc</span>(if (<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>)) = diff(<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)) &amp;&amp;
             <span class="gf" style="font-weight: bold">len</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>))) = <span class="gf" style="font-weight: bold">len</span>(<span class="gn" style="color: #AA5500">n</span>(j))) then
           &lt;<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>)),<span class="gn" style="color: #AA5500">n</span>(j)&gt; else &lt;<span class="gn" style="color: #AA5500">n</span>(j),<span class="gn" style="color: #AA5500">n</span>(j)&gt;,<span class="gn" style="color: #AA5500">r</span>(j),
     <span class="gf" style="font-weight: bold">pk</span>(diff(<span class="gn" style="color: #AA5500">kA</span>,<span class="gn" style="color: #AA5500">kAbis</span>)))


</span><span class="input-line" id="in41"> fa 4.</span><span class="output-line" id="out41">[&gt; Line 179: (fa 4) 
[goal&gt; Focused goal (1/1):
Systems: default
Variables: j:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">B(j)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
4: <span class="gf" style="font-weight: bold">enc</span>(if (<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>)) = diff(<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)) &amp;&amp;
           <span class="gf" style="font-weight: bold">len</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>))) = <span class="gf" style="font-weight: bold">len</span>(<span class="gn" style="color: #AA5500">n</span>(j))) then
         &lt;<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>)),<span class="gn" style="color: #AA5500">n</span>(j)&gt; else &lt;<span class="gn" style="color: #AA5500">n</span>(j),<span class="gn" style="color: #AA5500">n</span>(j)&gt;,<span class="gn" style="color: #AA5500">r</span>(j),
   <span class="gf" style="font-weight: bold">pk</span>(diff(<span class="gn" style="color: #AA5500">kA</span>,<span class="gn" style="color: #AA5500">kAbis</span>)))


</span><span class="input-line" id="in42">
  (**
  We first use the key privacy assumption: knowing only a cipertext, it 
  should not be possible to know which specific key was used.
  The corresponding `enckp` tactic allows here to replace `kAbis` by `kA`
  on the right side.
  **)
  enckp 4.</span><span class="output-line" id="out42">[&gt; Line 186: (enckp 4) 
[goal&gt; Focused goal (1/1):
Systems: default
Variables: j:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">B(j)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
4: <span class="gf" style="font-weight: bold">enc</span>(if (<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>)) = diff(<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)) &amp;&amp;
           <span class="gf" style="font-weight: bold">len</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>))) = <span class="gf" style="font-weight: bold">len</span>(<span class="gn" style="color: #AA5500">n</span>(j))) then
         &lt;<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>)),<span class="gn" style="color: #AA5500">n</span>(j)&gt; else &lt;<span class="gn" style="color: #AA5500">n</span>(j),<span class="gn" style="color: #AA5500">n</span>(j)&gt;,<span class="gn" style="color: #AA5500">r</span>(j),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>))


</span><span class="input-line" id="in43"> 
  (**
  We now use the ciphertext indistinguishability (IND-CCA1) assumption,
  which requires to show that the lengths of the plaintexts on both sides
  are equal.
  **)
  cca1 4.</span><span class="output-line" id="out43">[&gt; Line 192: (cca1 4) 
[goal&gt; Focused goal (1/1):
Systems: default
Variables: j:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">B(j)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
4: <span class="gf" style="font-weight: bold">len</span>(
     if (<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>)) = diff(<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)) &amp;&amp;
         <span class="gf" style="font-weight: bold">len</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>))) = <span class="gf" style="font-weight: bold">len</span>(<span class="gn" style="color: #AA5500">n</span>(j))) then
       &lt;<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>)),<span class="gn" style="color: #AA5500">n</span>(j)&gt; else &lt;<span class="gn" style="color: #AA5500">n</span>(j),<span class="gn" style="color: #AA5500">n</span>(j)&gt;)


</span><span class="input-line" id="in44">
  (** We use the lemma `if_len` to push the conditional under len(_). **)
  rewrite if_len length.</span><span class="output-line" id="out44">[&gt; Line 194: (rewrite ... ...) 
[goal&gt; Focused goal (1/1):
Systems: default
Variables: j:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">B(j)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
4: if (<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>)) = diff(<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)) &amp;&amp;
       <span class="gf" style="font-weight: bold">len</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>))) = <span class="gf" style="font-weight: bold">len</span>(<span class="gn" style="color: #AA5500">n</span>(j))) then
     <span class="gf" style="font-weight: bold">plus</span>(<span class="gf" style="font-weight: bold">len</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>))),<span class="gf" style="font-weight: bold">len</span>(<span class="gn" style="color: #AA5500">n</span>(j))) else <span class="gf" style="font-weight: bold">len</span>(&lt;<span class="gn" style="color: #AA5500">n</span>(j),<span class="gn" style="color: #AA5500">n</span>(j)&gt;)


</span><span class="input-line" id="in45">
  (** We use the `ifeq` tactic to replace `len(snd(dec(input@B(j),kB)))` 
  by `len(n(j))` in the then branch since this equality is implied by 
  the condition. **)  
  ifeq 4, len(snd(dec(input@B(j),kB))), len(n(j)).</span><span class="output-line" id="out45">[&gt; Line 198: (ifeq 4, len(snd(dec(input@B(j),kB))), len(n(j))) 
[goal&gt; Focused goal (1/1):
Systems: default
Variables: j:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">B(j)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
4: if (<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>)) = diff(<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)) &amp;&amp;
       <span class="gf" style="font-weight: bold">len</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">B(j)</span>,<span class="gn" style="color: #AA5500">kB</span>))) = <span class="gf" style="font-weight: bold">len</span>(<span class="gn" style="color: #AA5500">n</span>(j))) then
     <span class="gf" style="font-weight: bold">plus</span>(<span class="gf" style="font-weight: bold">len</span>(<span class="gn" style="color: #AA5500">n</span>(j)),<span class="gf" style="font-weight: bold">len</span>(<span class="gn" style="color: #AA5500">n</span>(j))) else <span class="gf" style="font-weight: bold">len</span>(&lt;<span class="gn" style="color: #AA5500">n</span>(j),<span class="gn" style="color: #AA5500">n</span>(j)&gt;)


</span><span class="input-line" id="in46">
  (** We now notice that the two branches of the conditional are equal,
  we can thus simplify the term by keeping only the then branch.
  Showing that the two branches are equal relies on the `length` axiom
  defined above. **)
  trivialif 4.</span><span class="output-line" id="out46">[&gt; Line 203: (trivialif 4) 
[goal&gt; Focused goal (1/2):
System: default
Variables: j:index
H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">B(j)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="gf" style="font-weight: bold">plus</span>(<span class="gf" style="font-weight: bold">len</span>(<span class="gn" style="color: #AA5500">n</span>(j)),<span class="gf" style="font-weight: bold">len</span>(<span class="gn" style="color: #AA5500">n</span>(j))) = <span class="gf" style="font-weight: bold">len</span>(&lt;<span class="gn" style="color: #AA5500">n</span>(j),<span class="gn" style="color: #AA5500">n</span>(j)&gt;)

</span><span class="input-line" id="in47"> by rewrite length.</span><span class="output-line" id="out47">[&gt; Line 203: by (rewrite ...) 
[goal&gt; Focused goal (1/1):
Systems: default
Variables: j:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">B(j)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
4: <span class="gf" style="font-weight: bold">plus</span>(<span class="gf" style="font-weight: bold">len</span>(<span class="gn" style="color: #AA5500">n</span>(j)),<span class="gf" style="font-weight: bold">len</span>(<span class="gn" style="color: #AA5500">n</span>(j)))


</span><span class="input-line" id="in48">
  (** We conclude using the fact that `n(j)` is fresh. **)
  fa 4.</span><span class="output-line" id="out48">[&gt; Line 205: (fa 4) 
[goal&gt; Focused goal (1/1):
Systems: default
Variables: j:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">B(j)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
4: <span class="gf" style="font-weight: bold">len</span>(<span class="gn" style="color: #AA5500">n</span>(j))


</span><span class="input-line" id="in49"> fa 4.</span><span class="output-line" id="out49">[&gt; Line 205: (fa 4) 
[goal&gt; Focused goal (1/1):
Systems: default
Variables: j:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">B(j)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
4: <span class="gn" style="color: #AA5500">n</span>(j)


</span><span class="input-line" id="in50">
  fresh 4.</span><span class="output-line" id="out50">[&gt; Line 206: (fresh 4) 
[goal&gt; Focused goal (1/1):
Systems: default
Variables: j:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">B(j)</span>)]
IH: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>), <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>), <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kB</span>)
1: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kAbis</span>)
2: <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">kA</span>)
3: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">B(j)</span>)
4: if (forall (j0:index), (<span class="ga" style="color: #00AA00">B(j0)</span> &lt; <span class="ga" style="color: #00AA00">B(j)</span> =&gt; j0 &lt;&gt; j)) then <span class="gf" style="font-weight: bold">zero</span> else <span class="gn" style="color: #AA5500">n</span>(j)


</span><span class="input-line" id="in51"> yesif 4.</span><span class="output-line" id="out51">[&gt; Line 206: (yesif 4) 
[goal&gt; Goal anonymity is proved 
</span><span class="input-line" id="in52">
Qed.</span><span class="output-line" id="out52">Exiting proof mode.


</span></span>
<h1 id="about-this-tutorial">Example</h1>
<div class="example-left">
  <div class="example-buttons">
    <button type="button" class="command" onclick="goto_down()">-</button>
    <button type="button" class="command" onclick="goto_selected()">=></button>
    <button type="button" class="command" onclick="goto_up()">+</button>
    <button type="button" class="command" style="float: right;">doc</button>
  </div>
  <div class="example-code" style="height: 650px;	border-style: none solid solid solid;"><span id="in-line"></span></div>
</div>
<div class="example-left">
  <div class="example-code" style="height: 300px;	border-style: solid solid double none;"><span>Previously:</span>
<span id="prec-line"></span>
  </div>
  <div class="example-code" style="height: 400px;	border-style: none solid solid none;"><span id="out-line"></span></div>
</div>

<script src="script.js"></script>

</body>

