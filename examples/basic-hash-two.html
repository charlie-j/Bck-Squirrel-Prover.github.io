<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="UTF-8">

  <title>Squirrel Prover - Squirrel Prover</title>
  
  <link rel="stylesheet" href="style.css">
</head>

<body onkeydown="key(event)">
<span style="display: none;"><span class="squirrel-step" id="step0">
<span class="input-line" id="in0">(*<br>   BASIC HASH<br><br>   The Basic Hash protocol as described in [Brus√≤ et al., 2010]<br>   is an RFID protocol involving:<br><br>   - a tag associated to a secret key;<br>   - generic readers having access to a database containing all these keys.<br><br>   The protocol is as follows:<br><br>   T --&gt; R : &lt;nT, h(nT,kT)&gt;<br>   R --&gt; T : ok<br><br>   kT is the key of T, stored in the readers' database.<br>   nT is a session nonce.<br><br>   This file is an introductory example. It does NOT correspond to<br>   how we would normally model Basic Hash in Squirrel. Proof scripts<br>   use a minimum of ingredients and are thus unnecessarily tedious.<br>*)<br><br>(* Declare a hash function h that satisfies PRF, hence EUF. *)<br>hash h.</span>
<span class="output-line" id="out0"></span>
</span>

<span class="squirrel-step" id="step1">
<span class="input-line" id="in1"><br><br>(* Keys for tags T1 and T2. *)<br>name k1 : message.</span>
<span class="output-line" id="out1"></span>
</span>

<span class="squirrel-step" id="step2">
<span class="input-line" id="in2"><br>name k2 : message.</span>
<span class="output-line" id="out2"></span>
</span>

<span class="squirrel-step" id="step3">
<span class="input-line" id="in3"><br><br>(* Session nonces *)<br>name nt  : message.</span>
<span class="output-line" id="out3"></span>
</span>

<span class="squirrel-step" id="step4">
<span class="input-line" id="in4"><br>name nt' : message.</span>
<span class="output-line" id="out4"></span>
</span>

<span class="squirrel-step" id="step5">
<span class="input-line" id="in5"><br><br>(* Please ignore the next lines... *)<br>system null.</span>
<span class="output-line" id="out5">System before processing:<br>  <br>  <span class="pn" style="font-weight:bold; color: #0000AA">null</span><br><br>System after processing:<br>  <br>  <span class="pn" style="font-weight:bold; color: #0000AA">null</span><br><br>System default registered with actions (init).<br></span>
</span>

<span class="squirrel-step" id="step6">
<span class="input-line" id="in6"><br>include Basic.</span>
<span class="output-line" id="out6">Goal eq_sym :<br>  (x = y) = (y = x)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(x = y) = (y = x)<br><br>[&gt; Line 11: by (rewrite ...) <br>[goal&gt; Goal eq_sym is proved <br>Exiting proof mode.<br><br><br>Goal neq_sym :<br>  (x &lt;&gt; y) = (y &lt;&gt; x)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(x &lt;&gt; y) = (y &lt;&gt; x)<br><br>[&gt; Line 14: by (rewrite ...) <br>[goal&gt; Goal neq_sym is proved <br>Exiting proof mode.<br><br><br>Goal eq_refl :<br>  (x = x) = true<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: x:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(x = x) = true<br><br>[&gt; Line 18: by (rewrite ...) <br>[goal&gt; Goal eq_refl is proved <br>Exiting proof mode.<br><br><br>Goal false_true :<br>  (false = true) = false<br>[goal&gt; Focused goal (1/1):<br>System: any<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(false = true) = false<br><br>[&gt; Line 30: by (rewrite ...) <br>[goal&gt; Goal false_true is proved <br>Exiting proof mode.<br><br><br>Goal eq_true :<br>  (b = true) = b<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(b = true) = b<br><br>[&gt; Line 35: by (case b) <br>[goal&gt; Goal eq_true is proved <br>Exiting proof mode.<br><br><br>Goal eq_true2 :<br>  (true = b) = b<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(true = b) = b<br><br>[&gt; Line 39: by (case b) <br>[goal&gt; Goal eq_true2 is proved <br>Exiting proof mode.<br><br><br>Goal not_not :<br>  not(not(b)) = b<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not(not(b)) = b<br><br>[&gt; Line 54: by (case b) <br>[goal&gt; Goal not_not is proved <br>Exiting proof mode.<br><br><br>Goal not_eq :<br>  not(x = y) = (x &lt;&gt; y)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not(x = y) = (x &lt;&gt; y)<br><br>[&gt; Line 60: by (rewrite ...) <br>[goal&gt; Goal not_eq is proved <br>Exiting proof mode.<br><br><br>Goal not_neq :<br>  not(x &lt;&gt; y) = (x = y)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not(x &lt;&gt; y) = (x = y)<br><br>[&gt; Line 66: by (rewrite ...) <br>[goal&gt; Goal not_neq is proved <br>Exiting proof mode.<br><br><br>Goal not_eqfalse :<br>  (b = false) = not(b)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(b = false) = not(b)<br><br>[&gt; Line 72: by (case b) <br>[goal&gt; Goal not_eqfalse is proved <br>Exiting proof mode.<br><br><br>Goal eq_false :<br>  ((x = y) = false) = (x &lt;&gt; y)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>((x = y) = false) = (x &lt;&gt; y)<br><br>[&gt; Line 80: (rewrite ...) <br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>((x = y) = false) = not(x = y)<br><br>[&gt; Line 80: ((case (x = y));(intro _)) <br>[goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br>_: x = y<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(true = false) = not(true)<br><br>[&gt; Line 80: simpl <br>[goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br>_: x = y<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>true<br><br>[&gt; Line 80: auto <br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br>_: not(x = y)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(false = false) = not(false)<br><br>[&gt; Line 81: by (rewrite ...) <br>[goal&gt; Goal eq_false is proved <br>Exiting proof mode.<br><br><br>Goal and_true_r :<br>  (b &amp;&amp; true) = b<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(b &amp;&amp; true) = b<br><br>[&gt; Line 94: by (rewrite ... ...) <br>[goal&gt; Goal and_true_r is proved <br>Exiting proof mode.<br><br><br>Goal and_false_r :<br>  (b &amp;&amp; false) = false<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(b &amp;&amp; false) = false<br><br>[&gt; Line 101: by (rewrite ... ...) <br>[goal&gt; Goal and_false_r is proved <br>Exiting proof mode.<br><br><br>Goal or_false_r :<br>  (b || false) = b<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(b || false) = b<br><br>[&gt; Line 112: by (rewrite ... ...) <br>[goal&gt; Goal or_false_r is proved <br>Exiting proof mode.<br><br><br>Goal or_true_r :<br>  (b || true) = true<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(b || true) = true<br><br>[&gt; Line 119: by (rewrite ... ...) <br>[goal&gt; Goal or_true_r is proved <br>Exiting proof mode.<br><br><br>Goal not_and :<br>  not((a &amp;&amp; b)) = (not(a) || not(b))<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not((a &amp;&amp; b)) = (not(a) || not(b))<br><br>[&gt; Line 128: (rewrite ...) <br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not((a &amp;&amp; b)) &lt;=&gt; not(a) || not(b)<br><br>[&gt; Line 129: (((case a);(case b));(intro //=)) <br>[goal&gt; Goal not_and is proved <br>Exiting proof mode.<br><br><br>Goal not_or :<br>  not((a || b)) = (not(a) &amp;&amp; not(b))<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not((a || b)) = (not(a) &amp;&amp; not(b))<br><br>[&gt; Line 134: (rewrite ...) <br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not((a || b)) &lt;=&gt; not(a) &amp;&amp; not(b)<br><br>[&gt; Line 135: (((case a);(case b));(intro //=)) <br>[goal&gt; Goal not_or is proved <br>Exiting proof mode.<br><br><br>Goal if_true :<br>  b =&gt; if b then x else y = x<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b:bool,x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>b =&gt; if b then x else y = x<br><br>[&gt; Line 144: (intro *) <br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b:bool,x,y:'a<br>H: b<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>if b then x else y = x<br><br>[&gt; Line 145: (case <span>if</span> b <span>then</span> x <span>else</span> y) <br>[goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: 'a<br>Variables: b:bool,x,y:'a<br>H: b<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>b &amp;&amp; if b then x else y = x =&gt; x = x<br><br>[&gt; Line 146: auto <br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b:bool,x,y:'a<br>H: b<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not(b) &amp;&amp; if b then x else y = y =&gt; y = x<br><br>[&gt; Line 147: (intro [HH _]) <br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b:bool,x,y:'a<br>H: b<br>HH: not(b)<br>_: if b then x else y = y<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>y = x<br><br>[&gt; Line 147: by (have ... as ) <br>[goal&gt; Goal if_true is proved <br>Exiting proof mode.<br><br><br>Goal if_true0 :<br>  if true then x else y = x<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>if true then x else y = x<br><br>[&gt; Line 153: by (rewrite ...) <br>[goal&gt; Goal if_true0 is proved <br>Exiting proof mode.<br><br><br>Goal if_false :<br>  not(b) =&gt; if b then x else y = y<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b:bool,x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not(b) =&gt; if b then x else y = y<br><br>[&gt; Line 160: ((intro *);(case <span>if</span> b <span>then</span> x <span>else</span> y)) <br>[goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: 'a<br>Variables: b:bool,x,y:'a<br>H: not(b)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>b &amp;&amp; if b then x else y = x =&gt; x = y<br><br>[&gt; Line 161: (intro [HH _]) <br>[goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: 'a<br>Variables: b:bool,x,y:'a<br>H: not(b)<br>HH: b<br>_: if b then x else y = x<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>x = y<br><br>[&gt; Line 161: by (have ... as ) <br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b:bool,x,y:'a<br>H: not(b)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not(b) &amp;&amp; if b then x else y = y =&gt; y = y<br><br>[&gt; Line 162: auto <br>[goal&gt; Goal if_false is proved <br>Exiting proof mode.<br><br><br>Goal if_false0 :<br>  if false then x else y = y<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>if false then x else y = y<br><br>[&gt; Line 168: by (rewrite ...) <br>[goal&gt; Goal if_false0 is proved <br>Exiting proof mode.<br><br><br>Goal if_then_then :<br>  if b then if b' then x else y else y = if (b &amp;&amp; b') then x else y<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b,b':bool,x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>if b then if b' then x else y else y = if (b &amp;&amp; b') then x else y<br><br>[&gt; Line 175: by ((case b);(case b')) <br>[goal&gt; Goal if_then_then is proved <br>Exiting proof mode.<br><br><br>Goal if_then_implies :<br>  if b then if b' then x else y else z =<br>  if b then if (b =&gt; b') then x else y else z<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b,b':bool,x,y,z:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>if b then if b' then x else y else z =<br>if b then if (b =&gt; b') then x else y else z<br><br>[&gt; Line 182: ((case b);<br>             ((intro H);((case b');((intro H');(simpl;(try auto))))))<br><br>[goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: 'a<br>Variables: b,b':bool,x,y,z:'a<br>H: b<br>H': b'<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>x = if (true =&gt; true) then x else y<br><br>[&gt; Line 183: by (rewrite ...) <br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b,b':bool,x,y,z:'a<br>H: b<br>H': not(b')<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>y = if (true =&gt; false) then x else y<br><br>[&gt; Line 184: (rewrite ...) <br>[goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: 'a<br>Variables: b,b':bool,x,y,z:'a<br>H: b<br>H': not(b')<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not((true =&gt; false))<br><br>[&gt; Line 185: ((intro Habs);by (have ... as )) <br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b,b':bool,x,y,z:'a<br>H: b<br>H': not(b')<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>y = y<br><br>[&gt; Line 186: auto <br>[goal&gt; Goal if_then_implies is proved <br>Exiting proof mode.<br><br><br>Goal if_same :<br>  if b then x else x = x<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b:bool,x:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>if b then x else x = x<br><br>[&gt; Line 192: by (case b) <br>[goal&gt; Goal if_same is proved <br>Exiting proof mode.<br><br><br>Goal if_then :<br>  b = b' =&gt; if b then if b' then x else y else z = if b then x else z<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b,b':bool,x,y,z:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>b = b' =&gt; if b then if b' then x else y else z = if b then x else z<br><br>[&gt; Line 201: by ((intro -&gt;);(case b')) <br>[goal&gt; Goal if_then is proved <br>Exiting proof mode.<br><br><br>Goal if_else :<br>  b = b' =&gt; if b then x else if b' then y else z = if b then x else z<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b,b':bool,x,y,z:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>b = b' =&gt; if b then x else if b' then y else z = if b then x else z<br><br>[&gt; Line 210: by ((intro -&gt;);(case b')) <br>[goal&gt; Goal if_else is proved <br>Exiting proof mode.<br><br><br>Goal if_then_not :<br>  b = not(b') =&gt; if b then if b' then x else y else z = if b then y else z<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b,b':bool,x,y,z:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>b = not(b') =&gt; if b then if b' then x else y else z = if b then y else z<br><br>[&gt; Line 219: by ((intro -&gt;);(case b')) <br>[goal&gt; Goal if_then_not is proved <br>Exiting proof mode.<br><br><br>Goal if_else_not :<br>  b = not(b') =&gt; if b then x else if b' then y else z = if b then x else y<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b,b':bool,x,y,z:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>b = not(b') =&gt; if b then x else if b' then y else z = if b then x else y<br><br>[&gt; Line 228: by ((intro -&gt;);(case b')) <br>[goal&gt; Goal if_else_not is proved <br>Exiting proof mode.<br><br><br>Goal fst_pair :<br>  <span class="gf" style="font-weight: bold">fst</span>(&lt;x,y&gt;) = x<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,y:message<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gf" style="font-weight: bold">fst</span>(&lt;x,y&gt;) = x<br><br>[&gt; Line 236: auto <br>[goal&gt; Goal fst_pair is proved <br>Exiting proof mode.<br><br><br>Goal snd_pair :<br>  <span class="gf" style="font-weight: bold">snd</span>(&lt;x,y&gt;) = y<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,y:message<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gf" style="font-weight: bold">snd</span>(&lt;x,y&gt;) = y<br><br>[&gt; Line 240: auto <br>[goal&gt; Goal snd_pair is proved <br>Exiting proof mode.<br><br><br>Goal iff_refl :<br>  (x &lt;=&gt; x) = true<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(x &lt;=&gt; x) = true<br><br>[&gt; Line 248: by (rewrite ...) <br>[goal&gt; Goal iff_refl is proved <br>Exiting proof mode.<br><br><br>Goal iff_sym :<br>  (x &lt;=&gt; y) = (y &lt;=&gt; x)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,y:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(x &lt;=&gt; y) = (y &lt;=&gt; x)<br><br>[&gt; Line 254: by (rewrite ...) <br>[goal&gt; Goal iff_sym is proved <br>Exiting proof mode.<br><br><br>Goal true_iff_false :<br>  (true &lt;=&gt; false) = false<br>[goal&gt; Focused goal (1/1):<br>System: any<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(true &lt;=&gt; false) = false<br><br>[&gt; Line 259: by (rewrite ...) <br>[goal&gt; Goal true_iff_false is proved <br>Exiting proof mode.<br><br><br>Goal false_iff_true :<br>  (false &lt;=&gt; true) = false<br>[goal&gt; Focused goal (1/1):<br>System: any<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(false &lt;=&gt; true) = false<br><br>[&gt; Line 265: by (rewrite ...) <br>[goal&gt; Goal false_iff_true is proved <br>Exiting proof mode.<br><br><br>Goal exists_false1 :<br>  (exists (a:'a), false) = false<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(exists (a:'a), false) = false<br><br>[&gt; Line 277: by (rewrite ...) <br>[goal&gt; Goal exists_false1 is proved <br>Exiting proof mode.<br><br><br>Goal exists_false2 :<br>  (exists (a:'a,b:'b), false) = false<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a, 'b<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(exists (a:'a,b:'b), false) = false<br><br>[&gt; Line 281: by (rewrite ...) <br>[goal&gt; Goal exists_false2 is proved <br>Exiting proof mode.<br><br><br>Goal exists_false3 :<br>  (exists (a:'a,b:'b,c:'c), false) = false<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a, 'b, 'c<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(exists (a:'a,b:'b,c:'c), false) = false<br><br>[&gt; Line 285: by (rewrite ...) <br>[goal&gt; Goal exists_false3 is proved <br>Exiting proof mode.<br><br><br>Goal exists_false4 :<br>  (exists (a:'a,b:'b,c:'c,d:'d), false) = false<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a, 'b, 'c, 'd<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(exists (a:'a,b:'b,c:'c,d:'d), false) = false<br><br>[&gt; Line 289: by (rewrite ...) <br>[goal&gt; Goal exists_false4 is proved <br>Exiting proof mode.<br><br><br>Goal exists_false5 :<br>  (exists (a:'a,b:'b,c:'c,d:'d,e:'e), false) = false<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a, 'b, 'c, 'd, 'e<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(exists (a:'a,b:'b,c:'c,d:'d,e:'e), false) = false<br><br>[&gt; Line 293: by (rewrite ...) <br>[goal&gt; Goal exists_false5 is proved <br>Exiting proof mode.<br><br><br>Goal exists_false6 :<br>  (exists (a:'a,b:'b,c:'c,d:'d,e:'e,f:'f), false) = false<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a, 'b, 'c, 'd, 'e, 'f<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(exists (a:'a,b:'b,c:'c,d:'d,e:'e,f:'f), false) = false<br><br>[&gt; Line 297: by (rewrite ...) <br>[goal&gt; Goal exists_false6 is proved <br>Exiting proof mode.<br><br><br>Goal forall_true1 :<br>  (forall (a:'a), true) = true<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(forall (a:'a), true) = true<br><br>[&gt; Line 307: auto <br>[goal&gt; Goal forall_true1 is proved <br>Exiting proof mode.<br><br><br>Goal forall_true2 :<br>  (forall (a:'a,b:'b), true) = true<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a, 'b<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(forall (a:'a,b:'b), true) = true<br><br>[&gt; Line 311: auto <br>[goal&gt; Goal forall_true2 is proved <br>Exiting proof mode.<br><br><br>Goal forall_true3 :<br>  (forall (a:'a,b:'b,c:'c), true) = true<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a, 'b, 'c<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(forall (a:'a,b:'b,c:'c), true) = true<br><br>[&gt; Line 315: auto <br>[goal&gt; Goal forall_true3 is proved <br>Exiting proof mode.<br><br><br>Goal forall_true4 :<br>  (forall (a:'a,b:'b,c:'c,d:'d), true) = true<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a, 'b, 'c, 'd<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(forall (a:'a,b:'b,c:'c,d:'d), true) = true<br><br>[&gt; Line 319: auto <br>[goal&gt; Goal forall_true4 is proved <br>Exiting proof mode.<br><br><br>Goal forall_true5 :<br>  (forall (a:'a,b:'b,c:'c,d:'d,e:'e), true) = true<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a, 'b, 'c, 'd, 'e<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(forall (a:'a,b:'b,c:'c,d:'d,e:'e), true) = true<br><br>[&gt; Line 323: auto <br>[goal&gt; Goal forall_true5 is proved <br>Exiting proof mode.<br><br><br>Goal forall_true6 :<br>  (forall (a:'a,b:'b,c:'c,d:'d,e:'e,f:'f), true) = true<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a, 'b, 'c, 'd, 'e, 'f<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(forall (a:'a,b:'b,c:'c,d:'d,e:'e,f:'f), true) = true<br><br>[&gt; Line 327: auto <br>[goal&gt; Goal forall_true6 is proved <br>Exiting proof mode.<br><br><br>[warning&gt; loaded: Basic.sp  &lt;]<br></span>
</span>

<span class="squirrel-step" id="step7">
<span class="input-line" id="in7"><br><br>(* Declaring a goal phi as done next means that we are<br>   going to prove (phi ~ true). Logical connectives in phi<br>   are thus the dotted connectives, i.e. function symbols<br>   representing boolean operations. *)<br>goal authentication :<br>  (* Assume tag T1 has run a session with nonce nt,<br>     and T2 with nonce nt'. *)<br>  (<br>    (* if reader accepts att(..) *)<br>    snd(att(&lt;&lt;nt,h(nt,k1)&gt;,&lt;nt',h(nt',k2)&gt;&gt;))<br>    = h(fst(att(&lt;&lt;nt,h(nt,k1)&gt;,&lt;nt',h(nt',k2)&gt;&gt;)),k1)<br>    ||<br>    snd(att(&lt;&lt;nt,h(nt,k1)&gt;,&lt;nt',h(nt',k2)&gt;&gt;))<br>    = h(fst(att(&lt;&lt;nt,h(nt,k1)&gt;,&lt;nt',h(nt',k2)&gt;&gt;)),k2)<br>  ) =&gt; (<br>    (* then att(..) is an honest input *)<br>    (fst(att(&lt;&lt;nt,h(nt,k1)&gt;,&lt;nt',h(nt',k2)&gt;&gt;)) = nt &amp;&amp;<br>     snd(att(&lt;&lt;nt,h(nt,k1)&gt;,&lt;nt',h(nt',k2)&gt;&gt;)) = h(nt,k1))<br>    ||<br>    (fst(att(&lt;&lt;nt,h(nt,k1)&gt;,&lt;nt',h(nt',k2)&gt;&gt;)) = nt' &amp;&amp;<br>     snd(att(&lt;&lt;nt,h(nt,k1)&gt;,&lt;nt',h(nt',k2)&gt;&gt;)) = h(nt',k2))<br>  ).</span>
<span class="output-line" id="out7">Goal authentication :<br>  <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) =<br>  <span class="gf" style="font-weight: bold">h</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)),<span class="gn" style="color: #AA5500">k1</span>) ||<br>  <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) =<br>  <span class="gf" style="font-weight: bold">h</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)),<span class="gn" style="color: #AA5500">k2</span>) =&gt;<br>  <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt</span> &amp;&amp;<br>  <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>) ||<br>  <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt'</span> &amp;&amp;<br>  <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)<br></span>
</span>

<span class="squirrel-step" id="step8">
<span class="input-line" id="in8"><br>Proof.</span>
<span class="output-line" id="out8">[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) =<br><span class="gf" style="font-weight: bold">h</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)),<span class="gn" style="color: #AA5500">k1</span>) ||<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) =<br><span class="gf" style="font-weight: bold">h</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)),<span class="gn" style="color: #AA5500">k2</span>) =&gt;<br><span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt</span> &amp;&amp;<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>) ||<br><span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt'</span> &amp;&amp;<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)<br><br></span>
</span>

<span class="squirrel-step" id="step9">
<span class="input-line" id="in9"><br>  intro H.</span>
<span class="output-line" id="out9">[&gt; Line 61: (intro H) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>H: <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) =<br>   <span class="gf" style="font-weight: bold">h</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)),<span class="gn" style="color: #AA5500">k1</span>) ||<br>   <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) =<br>   <span class="gf" style="font-weight: bold">h</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)),<span class="gn" style="color: #AA5500">k2</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt</span> &amp;&amp;<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>) ||<br><span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt'</span> &amp;&amp;<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)<br><br></span>
</span>

<span class="squirrel-step" id="step10">
<span class="input-line" id="in10"> (* the inference ---- is as still a dotted implication *)<br>  case H.</span>
<span class="output-line" id="out10">[&gt; Line 62: (case H) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>H: <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) =<br>   <span class="gf" style="font-weight: bold">h</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)),<span class="gn" style="color: #AA5500">k1</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt</span> &amp;&amp;<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>) ||<br><span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt'</span> &amp;&amp;<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)<br><br></span>
</span>

<span class="squirrel-step" id="step11">
<span class="input-line" id="in11"><br>  (* Reader recognizes valid input from T1. *)<br>  + euf H =&gt; _.</span>
<span class="output-line" id="out11">[&gt; Line 64: ((euf H);(intro _)) <br>[goal&gt; Focused goal (1/3):<br>System: left:default/left, right:default/right<br>H: <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) =<br>   <span class="gf" style="font-weight: bold">h</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)),<span class="gn" style="color: #AA5500">k1</span>)<br>_: <span class="gn" style="color: #AA5500">nt</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;))<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt</span> &amp;&amp;<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>) ||<br><span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt'</span> &amp;&amp;<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)<br><br></span>
</span>

<span class="squirrel-step" id="step12">
<span class="input-line" id="in12"><br>    - left.</span>
<span class="output-line" id="out12">[&gt; Line 65: left <br>[goal&gt; Focused goal (1/3):<br>System: left:default/left, right:default/right<br>H: <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) =<br>   <span class="gf" style="font-weight: bold">h</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)),<span class="gn" style="color: #AA5500">k1</span>)<br>_: <span class="gn" style="color: #AA5500">nt</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;))<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt</span> &amp;&amp;<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)<br><br></span>
</span>

<span class="squirrel-step" id="step13">
<span class="input-line" id="in13"> auto.</span>
<span class="output-line" id="out13">[&gt; Line 65: auto <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>H: <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) =<br>   <span class="gf" style="font-weight: bold">h</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)),<span class="gn" style="color: #AA5500">k1</span>)<br>_: <span class="gn" style="color: #AA5500">nt</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;))<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt</span> &amp;&amp;<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>) ||<br><span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt'</span> &amp;&amp;<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)<br><br></span>
</span>

<span class="squirrel-step" id="step14">
<span class="input-line" id="in14"><br>    - left.</span>
<span class="output-line" id="out14">[&gt; Line 66: left <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>H: <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) =<br>   <span class="gf" style="font-weight: bold">h</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)),<span class="gn" style="color: #AA5500">k1</span>)<br>_: <span class="gn" style="color: #AA5500">nt</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;))<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt</span> &amp;&amp;<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)<br><br></span>
</span>

<span class="squirrel-step" id="step15">
<span class="input-line" id="in15"> auto.</span>
<span class="output-line" id="out15">[&gt; Line 66: auto <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>H: <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) =<br>   <span class="gf" style="font-weight: bold">h</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)),<span class="gn" style="color: #AA5500">k2</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt</span> &amp;&amp;<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>) ||<br><span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt'</span> &amp;&amp;<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)<br><br></span>
</span>

<span class="squirrel-step" id="step16">
<span class="input-line" id="in16"><br>  (* Reader recognizes valid input from T2. *)<br>  + euf H =&gt; _.</span>
<span class="output-line" id="out16">[&gt; Line 68: ((euf H);(intro _)) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>H: <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) =<br>   <span class="gf" style="font-weight: bold">h</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)),<span class="gn" style="color: #AA5500">k2</span>)<br>_: <span class="gn" style="color: #AA5500">nt'</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;))<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt</span> &amp;&amp;<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>) ||<br><span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt'</span> &amp;&amp;<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)<br><br></span>
</span>

<span class="squirrel-step" id="step17">
<span class="input-line" id="in17"><br>    - right.</span>
<span class="output-line" id="out17">[&gt; Line 69: right <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>H: <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) =<br>   <span class="gf" style="font-weight: bold">h</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)),<span class="gn" style="color: #AA5500">k2</span>)<br>_: <span class="gn" style="color: #AA5500">nt'</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;))<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt'</span> &amp;&amp;<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)<br><br></span>
</span>

<span class="squirrel-step" id="step18">
<span class="input-line" id="in18"> auto.</span>
<span class="output-line" id="out18">[&gt; Line 69: auto <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>H: <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) =<br>   <span class="gf" style="font-weight: bold">h</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)),<span class="gn" style="color: #AA5500">k2</span>)<br>_: <span class="gn" style="color: #AA5500">nt'</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;))<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt</span> &amp;&amp;<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>) ||<br><span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt'</span> &amp;&amp;<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)<br><br></span>
</span>

<span class="squirrel-step" id="step19">
<span class="input-line" id="in19"><br>    - right.</span>
<span class="output-line" id="out19">[&gt; Line 70: right <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>H: <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) =<br>   <span class="gf" style="font-weight: bold">h</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)),<span class="gn" style="color: #AA5500">k2</span>)<br>_: <span class="gn" style="color: #AA5500">nt'</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;))<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gn" style="color: #AA5500">nt'</span> &amp;&amp;<br><span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">att</span>(&lt;&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;,&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;&gt;)) = <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)<br><br></span>
</span>

<span class="squirrel-step" id="step20">
<span class="input-line" id="in20"> auto.</span>
<span class="output-line" id="out20">[&gt; Line 70: auto <br>[goal&gt; Goal authentication is proved <br></span>
</span>

<span class="squirrel-step" id="step21">
<span class="input-line" id="in21"><br>Qed.</span>
<span class="output-line" id="out21">Exiting proof mode.<br><br><br></span>
</span>

<span class="squirrel-step" id="step22">
<span class="input-line" id="in22"><br><br>(* To prove an equivalence we use a global goal.<br>   The two sides of the equivalence are given at once,<br>   using diff(_,_) when the left and right sides differ. *)<br>global goal privacy (i1,i2,j1,j2:index) :<br>  equiv(&lt;nt,h(nt,k1)&gt;,<br>        diff(&lt;nt',h(nt',k1)&gt;,<br>             &lt;nt',h(nt',k2)&gt;)).</span>
<span class="output-line" id="out22">Goal privacy :<br>  forall i1,i2,j1,j2:index,<br>  equiv(&lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;, diff(&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;, &lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;))<br></span>
</span>

<span class="squirrel-step" id="step23">
<span class="input-line" id="in23"><br>Proof.</span>
<span class="output-line" id="out23">[goal&gt; Focused goal (1/1):<br>Systems: left:default/left, right:default/right (same for equivalences)<br>Variables: i1,i2,j1,j2:index<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: &lt;<span class="gn" style="color: #AA5500">nt</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;<br>1: diff(&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;, &lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;)<br><br><br></span>
</span>

<span class="squirrel-step" id="step24">
<span class="input-line" id="in24"><br>  (* First break the pairs. *)<br>  fa 0.</span>
<span class="output-line" id="out24">[&gt; Line 82: (fa 0) <br>[goal&gt; Focused goal (1/1):<br>Systems: left:default/left, right:default/right (same for equivalences)<br>Variables: i1,i2,j1,j2:index<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: <span class="gn" style="color: #AA5500">nt</span><br>1: <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)<br>2: diff(&lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k1</span>)&gt;, &lt;<span class="gn" style="color: #AA5500">nt'</span>,<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>)&gt;)<br><br><br></span>
</span>

<span class="squirrel-step" id="step25">
<span class="input-line" id="in25"><br>  fa 2.</span>
<span class="output-line" id="out25">[&gt; Line 83: (fa 2) <br>[goal&gt; Focused goal (1/1):<br>Systems: left:default/left, right:default/right (same for equivalences)<br>Variables: i1,i2,j1,j2:index<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: <span class="gn" style="color: #AA5500">nt</span><br>1: <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)<br>2: <span class="gn" style="color: #AA5500">nt'</span><br>3: diff(<span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k1</span>), <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,<span class="gn" style="color: #AA5500">k2</span>))<br><br><br></span>
</span>

<span class="squirrel-step" id="step26">
<span class="input-line" id="in26"><br>  (* Then show that the second hashes look like randomness. *)<br>  prf 3.</span>
<span class="output-line" id="out26">[&gt; Line 85: (prf 3) <br>[goal&gt; Focused goal (1/1):<br>Systems: left:default/left, right:default/right (same for equivalences)<br>Variables: i1,i2,j1,j2:index<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: <span class="gn" style="color: #AA5500">nt</span><br>1: <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)<br>2: <span class="gn" style="color: #AA5500">nt'</span><br>3: if (diff(<span class="gn" style="color: #AA5500">nt'</span> &lt;&gt; <span class="gn" style="color: #AA5500">nt</span>, true) &amp;&amp; true) then <span class="gn" style="color: #AA5500">n_PRF</span> else <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt'</span>,diff(<span class="gn" style="color: #AA5500">k1</span>, <span class="gn" style="color: #AA5500">k2</span>))<br><br><br></span>
</span>

<span class="squirrel-step" id="step27">
<span class="input-line" id="in27"><br>  rewrite if_true.</span>
<span class="output-line" id="out27">[&gt; Line 86: (rewrite ...) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right (same for equivalences)<br>Variables: i1,i2,j1,j2:index<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>diff(<span class="gn" style="color: #AA5500">nt'</span> &lt;&gt; <span class="gn" style="color: #AA5500">nt</span>, true) &amp;&amp; true<br><br></span>
</span>

<span class="squirrel-step" id="step28">
<span class="input-line" id="in28"><br>  project.</span>
<span class="output-line" id="out28">[&gt; Line 87: project <br>[goal&gt; Focused goal (1/3):<br>System: left:default/left<br>        (equivalences: left:default/left, right:default/right)<br>Variables: i1,i2,j1,j2:index<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gn" style="color: #AA5500">nt'</span> &lt;&gt; <span class="gn" style="color: #AA5500">nt</span> &amp;&amp; true<br><br></span>
</span>

<span class="squirrel-step" id="step29">
<span class="input-line" id="in29"><br>  + auto.</span>
<span class="output-line" id="out29">[&gt; Line 88: auto <br>[goal&gt; Focused goal (1/2):<br>System: right:default/right<br>        (equivalences: left:default/left, right:default/right)<br>Variables: i1,i2,j1,j2:index<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>true &amp;&amp; true<br><br></span>
</span>

<span class="squirrel-step" id="step30">
<span class="input-line" id="in30"><br>  + auto.</span>
<span class="output-line" id="out30">[&gt; Line 89: auto <br>[goal&gt; Focused goal (1/1):<br>Systems: left:default/left, right:default/right (same for equivalences)<br>Variables: i1,i2,j1,j2:index<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: <span class="gn" style="color: #AA5500">nt</span><br>1: <span class="gf" style="font-weight: bold">h</span>(<span class="gn" style="color: #AA5500">nt</span>,<span class="gn" style="color: #AA5500">k1</span>)<br>2: <span class="gn" style="color: #AA5500">nt'</span><br>3: <span class="gn" style="color: #AA5500">n_PRF</span><br><br><br></span>
</span>

<span class="squirrel-step" id="step31">
<span class="input-line" id="in31"><br>  (* Conclude by reflexivity -- fresh may also be used. *)<br>  refl.</span>
<span class="output-line" id="out31">[&gt; Line 91: refl <br>[goal&gt; Goal privacy is proved <br></span>
</span>

<span class="squirrel-step" id="step32">
<span class="input-line" id="in32"><br>Qed.</span>
<span class="output-line" id="out32">Exiting proof mode.<br><br><br></span>
</span>

</span>
<div class="page-header">
  <img src="logo-circular.png" class="logo">
  <h1 class="project-tagline">Squirrel Prover</h1>
  <a href="https://squirrel-prover.github.io/examples.html" class="header-button">
    <button type="button" class="header-button">Exit</button>
  </a>
  <button type="button" class="header-button" onclick="help()" id="button-panel">Help</button>
</div>

<div class="help-panel" id="help-panel">
  Press the left and right arrows to do and undo an instruction.
  <br><br>
  Alternatively, you can double-click on an instruction.
  <br><br>
  <span style="color: #8B0000;" onmouseenter="highlightOn('in-zone')" onmouseleave="highlightOff('in-zone')">This zone</span> shows a Squirrel file. You can double-click on a comment to collapse it for better readabilility.
  <br><br>
  <span style="color: #8B0000;" onmouseenter="highlightOn('out-zone')" onmouseleave="highlightOff('out-zone')">This zone</span> shows the output given by Squirrel.
  <br><br>
  <span style="color: #8B0000;" onmouseenter="highlightOn('prec-zone')" onmouseleave="highlightOff('prec-zone')">This zone</span> shows the output of the previous instruction, to help identifying the change caused by the instruction.
</div>

<div class="mainsection" id="main">
  <div class="example-grid">
    <div class="example-col example-col-left" id="in-zone">
      <p class="example-code"><span id="in-line"></span></p>
    </div>
    <div class="example-col example-col-right">
      <div class="example-code example-code-right" style="height: 45%;	border-bottom: 4px double #8B0000;" id="prec-zone"><span>Previously:</span><br><br><span id="prec-line"></span>
      </div>
      <div style="position: relative;">
      <button type="button" class="prec-button" onclick="hidePrec()" id="prec-button" >Hide</button>
      </div>
      <div class="example-code example-code-right" style="height: 55%;" id="out-zone"><span id="out-line"></span>
      </div>
    </div>
  </div>
</div>

<script src="script.js"></script>

</body>

