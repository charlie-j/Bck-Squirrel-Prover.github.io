<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="UTF-8">

  <title>Squirrel Prover - Squirrel Prover</title>
  
  <link rel="stylesheet" href="style.css">
</head>

<body onkeydown="key(event)">
<span style="display: none;"><span class="squirrel-step" id="step0">
<span class="input-line" id="in0">abstract ok : message<br>abstract ko : message<br><br>name skP : message<br>name skS : message<br><br>channel cP<br>channel cS.</span>
<span class="output-line" id="out0"></span>
<span class="com-line" id="com0"><h1 id="signed-ddh">SIGNED DDH</h1>
<p>The signed DDH protocol as described in [G] features two roles, P and S. Each role is associated to a secret key (skP and skS).</p>
<ul>
<li>P -&gt; S : &lt;pk(skP), g^a&gt;</li>
<li>S -&gt; P : &lt;pk(skS),g<sup>b&gt;,sign(&lt;&lt;g</sup>a,g^b&gt;,pk(skP)&gt;,skS)</li>
<li>P -&gt; S : sign(&lt;&lt;g<sup>b,g</sup>a&gt;,pk(skS)&gt;,skP)</li>
</ul>
<p>We consider multiple sessions but two agents only (one agent for the role P and one agent for the role S) and show the strong secrecy of the shared key.</p>
<ul>
<li>In this file <code>signed-ddh-P.sp</code>, we show that the key g<sup>a</sup>b as computed by P is indistinguishable from g^k with k fresh (system secretP).</li>
<li>In another file <code>signed-ddh-S.sp</code>, we show that the key g<sup>a</sup>b as computed by S is indistinguishable from g^k with k fresh (system secretS).</li>
</ul>
<p>[G] ISO/IEC 9798-3:2019, IT Security techniques – Entity authentication – Part 3: Mechanisms using digital signature techniques.</p>
<hr />
<p>We first declare some public constants, the secret keys for roles P and S, the channels used by these two roles.</p>
</span>
</span>

<span class="squirrel-step" id="step1">
<span class="input-line" id="in1">name a : index -&gt; message<br>name b : index -&gt; message.</span>
<span class="output-line" id="out1"></span>
<span class="com-line" id="com1"><p>Names <code>a</code> and <code>b</code> represent the random numbers used by roles P and S. They are indexed so that each new session uses a new random name.</p>
</span>
</span>

<span class="squirrel-step" id="step2">
<span class="input-line" id="in2">name k :  index -&gt; index -&gt; message.</span>
<span class="output-line" id="out2"></span>
<span class="com-line" id="com2"><p>The name <code>k</code> represents the random number used in the strong secrecy property. It has 2 as index arity to model the fact that each interaction between session <code>i</code> of role P and session <code>j</code> of role S uses a new random name.</p>
</span>
</span>

<span class="squirrel-step" id="step3">
<span class="input-line" id="in3">ddh g, (^) where group:message exposants:message.</span>
<span class="output-line" id="out3"></span>
<span class="com-line" id="com3"><p>We declare a DDH context, using <code>g</code> for the generator element and <code>^</code> for the power operator.</p>
</span>
</span>

<span class="squirrel-step" id="step4">
<span class="input-line" id="in4">signature sign,checksign,pk.</span>
<span class="output-line" id="out4"></span>
<span class="com-line" id="com4"><p>We also declare a signature scheme by specifying 3 function symbols.</p>
</span>
</span>

<span class="squirrel-step" id="step5">
<span class="input-line" id="in5">process Pchall(i:index) =<br>  out(cP, &lt;pk(skP),g^a(i)&gt;);<br>  in(cP, x2);<br>  let gS = snd(fst(x2)) in<br>  let pkS = fst(fst(x2)) in<br>  if checksign(snd(x2),pkS) = &lt;&lt;g^a(i),gS&gt;,pk(skP)&gt; &amp;&amp; pkS = pk(skS) then<br>    out(cP,sign(&lt;&lt;gS,g^a(i)&gt;,pkS&gt;,skP));<br>    in(cP, challenge);<br>      try find j such that gS = g^b(j) in<br>        out(cP, diff(g^a(i)^b(j),g^k(i,j)))<br>      else<br>        <br>        out(cP, diff(ok,ko))<br><br>process S(j:index) =<br>  in(cS, x1);<br>  let gP = snd(x1) in<br>  let pkP = fst(x1) in<br>  if pkP = pk(skP) then<br>    out(cS, &lt; &lt;pk(skS),g^b(j)&gt;, sign(&lt;&lt;gP,g^b(j)&gt;,pkP&gt;,skS)&gt;);<br>    in(cS, x3);<br>    if checksign(x3,pkP) = &lt;&lt;g^b(j),gP&gt;,pk(skS)&gt; then<br>      out(cS,ok)<br><br>system [secretP] (!_i Pchall(i) | !_j S(j)).</span>
<span class="output-line" id="out5">Un-processed system:<br>  <br>  (!_i <span class="pn" style="font-weight:bold; color: #0000AA">Pchall</span> i) | (!_j <span class="pn" style="font-weight:bold; color: #0000AA">S</span> j)<br><br>Processed system:<br>  <br>  (!_i<br>     Pchall:<br>     <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cP</span>,pair(pk(skP),(g ^ a(i))));<br>     <span class="pio" style="font-weight: bold">in</span>(<span class="pc">cP</span>,<span class="pv" style="font-weight: bold; color: #AA00AA">x2</span>);<br>     <span class="pk" style="font-weight: bold">let</span> <span class="pv" style="font-weight: bold; color: #AA00AA">gS</span> = snd(fst(x2)) <span class="pk" style="font-weight: bold">in</span><br>     <span class="pk" style="font-weight: bold">let</span> <span class="pv" style="font-weight: bold; color: #AA00AA">pkS</span> = fst(fst(x2)) <span class="pk" style="font-weight: bold">in</span><br>     <span class="pc" style="text-decoration: underline; color: #AA0000">if</span> (checksign(snd(x2),pkS(i)) = pair(pair((g ^ a(i)),gS(i)),pk(skP)) &amp;&amp;<br>         pkS(i) = pk(skS)) <span class="pc" style="text-decoration: underline; color: #AA0000">then</span><br>       Pchall1:<br>       <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cP</span>,sign(pair(pair(gS(i),(g ^ a(i))),pkS(i)),skP));<br>       <span class="pio" style="font-weight: bold">in</span>(<span class="pc">cP</span>,<span class="pv" style="font-weight: bold; color: #AA00AA">challenge</span>);<br>       <span class="pc" style="text-decoration: underline; color: #AA0000">find</span> (j) <span class="pc" style="text-decoration: underline; color: #AA0000">such that</span> gS(i) = (g ^ b(j)) <span class="pc" style="text-decoration: underline; color: #AA0000">in</span><br>         Pchall2: <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cP</span>,<span>diff</span>(((g ^ a(i)) ^ b(j)),(g ^ k(i,j)))); <span class="pn" style="font-weight:bold; color: #0000AA">null</span> <span class="pc" style="text-decoration: underline; color: #AA0000">else</span><br>         Pchall3: <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cP</span>,<span>diff</span>(ok,ko)); <span class="pn" style="font-weight:bold; color: #0000AA">null</span> <span class="pc" style="text-decoration: underline; color: #AA0000">else</span> Pchall4: <span class="pn" style="font-weight:bold; color: #0000AA">null</span>) |<br>  (!_j<br>     <span class="pio" style="font-weight: bold">in</span>(<span class="pc">cS</span>,<span class="pv" style="font-weight: bold; color: #AA00AA">x1</span>);<br>     <span class="pk" style="font-weight: bold">let</span> <span class="pv" style="font-weight: bold; color: #AA00AA">gP</span> = snd(x1) <span class="pk" style="font-weight: bold">in</span><br>     <span class="pk" style="font-weight: bold">let</span> <span class="pv" style="font-weight: bold; color: #AA00AA">pkP</span> = fst(x1) <span class="pk" style="font-weight: bold">in</span><br>     <span class="pc" style="text-decoration: underline; color: #AA0000">if</span> pkP(j) = pk(skP) <span class="pc" style="text-decoration: underline; color: #AA0000">then</span><br>       S:<br>       <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cS</span>,<br>       pair(pair(pk(skS),(g ^ b(j))),<br>             sign(pair(pair(gP(j),(g ^ b(j))),pkP(j)),skS)));<br>       <span class="pio" style="font-weight: bold">in</span>(<span class="pc">cS</span>,<span class="pv" style="font-weight: bold; color: #AA00AA">x3</span>);<br>       <span class="pc" style="text-decoration: underline; color: #AA0000">if</span> checksign(x3,pkP(j)) = pair(pair((g ^ b(j)),gP(j)),pk(skS)) <span class="pc" style="text-decoration: underline; color: #AA0000">then</span><br>         S1: <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cS</span>,ok); <span class="pn" style="font-weight:bold; color: #0000AA">null</span> <span class="pc" style="text-decoration: underline; color: #AA0000">else</span> S2: <span class="pn" style="font-weight:bold; color: #0000AA">null</span> <span class="pc" style="text-decoration: underline; color: #AA0000">else</span> S3: <span class="pn" style="font-weight:bold; color: #0000AA">null</span>)<br><br>System secretP registered with actions (init,Pchall,Pchall1,Pchall2,Pchall3,<br>                                         Pchall4,S,S1,S2,S3).<br></span>
<span class="com-line" id="com5"><p>In the system <code>secretP</code>, we add an output at the end of the role of P. This output is actually a bi-term:</p>
<ul>
<li>the left side of the system outputs the shared key as computed by P,</li>
<li>the right side of the system outputs <code>g^k(i,j)</code> where <code>k(i,j)</code> is fresh.</li>
</ul>
<p>The goal will be to prove that these two sides are indistinguishable.</p>
<p>The <code>try find</code> construct is needed to retrieve the index <code>j</code>, but this else branch should never be reachable. We thus output a bi-term with distinct public constants so that the equivalence for the strong secrecy could not hold if this else branch is reached.</p>
</span>
</span>

<span class="squirrel-step" id="step6">
<span class="input-line" id="in6">goal [secretP] P_charac (i:index):<br>  happens(Pchall1(i)) =&gt;<br>    cond@Pchall1(i) =&gt;<br>      exists (j:index), snd(fst(input@Pchall1(i))) = g^b(j).</span>
<span class="output-line" id="out6">Goal P_charac :<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall1(i)</span>) =&gt;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span> =&gt;<br>  exists (j:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>)) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))<br></span>
<span class="com-line" id="com6"><p>In the proof of strong secrecy for the system <code>secretP</code>, we will use the following property, stating that whenever P accepts a message from S, this message is of the form <code>&lt;&lt;_,x&gt;,_&gt;</code> where <code>x = g^b(j)</code>.</p>
</span>
</span>

<span class="squirrel-step" id="step7">
<span class="input-line" id="in7">Proof.</span>
<span class="output-line" id="out7">[goal&gt; Focused goal (1/1):<br>System: secretP<br>Variables: i:index<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall1(i)</span>) =&gt;<br><span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span> =&gt; exists (j:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>)) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))<br><br></span>
<span class="com-line" id="com7"><p>The high-level idea of the proof is to use the EUF cryptographic axiom: only S can forge a correct signature that will be accepted by P since the secret key is not known by the attacker.</p>
</span>
</span>

<span class="squirrel-step" id="step8">
<span class="input-line" id="in8">  intro Hap Hcond.</span>
<span class="output-line" id="out8">[goal&gt; Focused goal (1/1):<br>System: secretP<br>Variables: i:index<br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>D0: <span class="gm" style="font-weight: bold; color: #AA00AA">pkS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>D1: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall1(i)</span>)<br>Hcond: <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>exists (j:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>)) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))<br><br></span>
<span class="com-line" id="com8"><p>We start by introducing the hypotheses and expanding the macros.</p>
</span>
</span>

<span class="squirrel-step" id="step9">
<span class="input-line" id="in9"><br>  expand cond, pkS(i)@Pchall1(i).</span>
<span class="output-line" id="out9">[goal&gt; Focused goal (1/1):<br>System: secretP<br>Variables: i:index<br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>D1: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall1(i)</span>)<br>Meq: <span class="gf" style="font-weight: bold">checksign</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>),<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))) =<br>     &lt;&lt;<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span>&gt;,<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skP</span>)&gt;<br>Meq0: <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>)) = <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skS</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>exists (j:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>)) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))<br><br></span>
</span>

<span class="squirrel-step" id="step10">
<span class="input-line" id="in10">  rewrite Meq0 in Meq.</span>
<span class="output-line" id="out10">[goal&gt; Focused goal (1/1):<br>System: secretP<br>Variables: i:index<br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>D1: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall1(i)</span>)<br>Meq: <span class="gf" style="font-weight: bold">checksign</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skS</span>)) =<br>     &lt;&lt;<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span>&gt;,<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skP</span>)&gt;<br>Meq0: <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>)) = <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skS</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>exists (j:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>)) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))<br><br></span>
<span class="com-line" id="com10"><p>We then rewrite Meq using the message equality Meq0.</p>
</span>
</span>

<span class="squirrel-step" id="step11">
<span class="input-line" id="in11">  euf Meq.</span>
<span class="output-line" id="out11">[goal&gt; Focused goal (1/1):<br>System: secretP<br>Variables: i,j:index<br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>D1: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>H: <span class="ga" style="color: #00AA00">S(j)</span> &lt;= <span class="ga" style="color: #00AA00">Pchall1(i)</span> || <span class="ga" style="color: #00AA00">S(j)</span> &lt; <span class="ga" style="color: #00AA00">Pchall1(i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall1(i)</span>)<br>Meq: <span class="gf" style="font-weight: bold">checksign</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skS</span>)) =<br>     &lt;&lt;<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span>&gt;,<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skP</span>)&gt;<br>Meq0: <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>)) = <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skS</span>)<br>Meq1: &lt;&lt;<span class="gm" style="font-weight: bold; color: #AA00AA">gP</span>(j)@<span class="ga" style="color: #00AA00">S(j)</span>,<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)&gt;,<span class="gm" style="font-weight: bold; color: #AA00AA">pkP</span>(j)@<span class="ga" style="color: #00AA00">S(j)</span>&gt; =<br>      &lt;&lt;<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span>&gt;,<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skP</span>)&gt;<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>exists (j:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>)) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))<br><br></span>
<span class="com-line" id="com11"><p>We are now able to apply the <code>euf</code> tactic, which will search for occurences of signatures with <code>skS</code>: the only possibility is the output of an action <code>S(j)</code>.</p>
</span>
</span>

<span class="squirrel-step" id="step12">
<span class="input-line" id="in12">  by exists j.</span>
<span class="output-line" id="out12">[goal&gt; Goal P_charac is proved <br></span>
<span class="com-line" id="com12"><p>The conclusion is now trivial from the Meq1 and D1 hypotheses.</p>
</span>
</span>

<span class="squirrel-step" id="step13">
<span class="input-line" id="in13"><br>Qed.</span>
<span class="output-line" id="out13">Exiting proof mode.<br><br><br></span>
</span>

<span class="squirrel-step" id="step14">
<span class="input-line" id="in14">equiv [secretP] strongSecP.</span>
<span class="output-line" id="out14">Goal strongSecP :<br>  forall t:timestamp, <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@t<br></span>
<span class="com-line" id="com14"><p>We now show the strong secrecy of the shared key for the system <code>secretP</code>, expressed by the logic formula <code>forall t:timestamp, frame@t</code> where <code>frame@t</code> is actually a bi-frame. We will prove that the left projection of <code>frame@t</code> (<em>i.e.</em> where the shared key <code>g^a^b</code> is outputted) is indistinguishable from the right projection of <code>frame@t</code> (<em>i.e.</em> where <code>g^k</code> is outputted).</p>
</span>
</span>

<span class="squirrel-step" id="step15">
<span class="input-line" id="in15">Proof.</span>
<span class="output-line" id="out15">[goal&gt; Focused goal (1/1):<br>Systems: secretP<br>Variables: t:timestamp<br>H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)]<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@t<br><br><br></span>
<span class="com-line" id="com15"><p>The proof is done by induction, after having enriched the frame with some additional (bi-)terms. Intuitively, the idea of enriching the frame is to simplify the cases that are contexts built using applications of public function symbols and terms added in the enriched frame. It then remains to prove:</p>
<ul>
<li>the base case, <em>i.e.</em> prove that the enriched bi-frame is indistinguishable;</li>
<li>the case corresponding to the output <code>diff(ok,ko)</code>, <em>i.e.</em> prove that this output is never reached using the previous <code>P_charac</code> property.</li>
</ul>
</span>
</span>

<span class="squirrel-step" id="step16">
<span class="input-line" id="in16">  enrich<br>    skP, skS,<br>    seq(i:index -&gt;g^a(i)),<br>    seq(j:index -&gt;g^b(j)),<br>    seq(i,j:index -&gt;diff(g^a(i)^b(j),g^k(i,j))).</span>
<span class="output-line" id="out16">[goal&gt; Focused goal (1/1):<br>Systems: secretP<br>Variables: t:timestamp<br>H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)]<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))<br>1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br>3: <span class="gn" style="color: #AA5500">skS</span><br>4: <span class="gn" style="color: #AA5500">skP</span><br>5: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@t<br><br><br></span>
<span class="com-line" id="com16"><p>We start by enriching the frame.</p>
</span>
</span>

<span class="squirrel-step" id="step17">
<span class="input-line" id="in17">  induction t; try (by expandall; apply IH).</span>
<span class="output-line" id="out17">[goal&gt; Focused goal (1/2):<br>Systems: secretP<br>H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">init</span>)]<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))<br>1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br>3: <span class="gn" style="color: #AA5500">skS</span><br>4: <span class="gn" style="color: #AA5500">skP</span><br>5: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@<span class="ga" style="color: #00AA00">init</span><br><br><br></span>
<span class="com-line" id="com17"><p>We now apply the <code>induction</code> tactic, which generates several cases, one for each possible value that can be taken by the timestamp <code>t</code>.</p>
<p>For most cases, applying the induction hypothesis <code>IH</code> allows to conclude because <code>frame@t</code> can be built from <code>frame@pred(t)</code> and elements added to the frame by the tactic <code>enrich</code>.</p>
</span>
</span>

<span class="squirrel-step" id="step18">
<span class="input-line" id="in18">  expandall.</span>
<span class="output-line" id="out18">[goal&gt; Focused goal (1/2):<br>Systems: secretP<br>H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">init</span>)]<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))<br>1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br>3: <span class="gn" style="color: #AA5500">skS</span><br>4: <span class="gn" style="color: #AA5500">skP</span><br><br><br></span>
<span class="com-line" id="com18"><p><strong>Case where <code>t = init</code>:</strong><br />
We use here the DDH assumption.</p>
</span>
</span>

<span class="squirrel-step" id="step19">
<span class="input-line" id="in19"><br>  by ddh g,a,b,k.</span>
<span class="output-line" id="out19">[goal&gt; Focused goal (1/1):<br>Systems: secretP<br>Variables: i:index<br>H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)]<br>IH: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j))),<br>    seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))), seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))), <span class="gn" style="color: #AA5500">skS</span>, <span class="gn" style="color: #AA5500">skP</span>,<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))<br>1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br>3: <span class="gn" style="color: #AA5500">skS</span><br>4: <span class="gn" style="color: #AA5500">skP</span><br>5: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@<span class="ga" style="color: #00AA00">Pchall3(i)</span><br><br><br></span>
</span>

<span class="squirrel-step" id="step20">
<span class="input-line" id="in20">  expand frame, exec, output.</span>
<span class="output-line" id="out20">[goal&gt; Focused goal (1/1):<br>Systems: secretP<br>Variables: i:index<br>H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)]<br>IH: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j))),<br>    seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))), seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))), <span class="gn" style="color: #AA5500">skS</span>, <span class="gn" style="color: #AA5500">skP</span>,<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))<br>1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br>3: <span class="gn" style="color: #AA5500">skS</span><br>4: <span class="gn" style="color: #AA5500">skP</span><br>5: &lt;<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>),<br>    &lt;<span class="gf" style="font-weight: bold">of_bool</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>) &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Pchall3(i)</span>),<br>     if (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>) &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Pchall3(i)</span>) then diff(<span class="gf" style="font-weight: bold">ok</span>,<span class="gf" style="font-weight: bold">ko</span>)&gt;&gt;<br><br><br></span>
<span class="com-line" id="com20"><p><strong>Case where <code>t = Pchall3(i)</code>:</strong><br />
We will show that this case is not possible, by showing that the formula <code>exec@pred(Pchall3(i)) &amp;&amp; cond@Pchall3(i)</code> is equivalent to <code>False</code>, relying on the previous property <code>P_charac</code>. *</p>
</span>
</span>

<span class="squirrel-step" id="step21">
<span class="input-line" id="in21"><br>  equivalent exec@pred(Pchall3(i)) &amp;&amp; cond@Pchall3(i), False.</span>
<span class="output-line" id="out21">[goal&gt; Focused goal (1/2):<br>System: secretP<br>Variables: i:index<br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br>H0: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br>H1: <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Pchall3(i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>false<br><br></span>
</span>

<span class="squirrel-step" id="step22">
<span class="input-line" id="in22"><br>    expand cond.</span>
<span class="output-line" id="out22">[goal&gt; Focused goal (1/2):<br>System: secretP<br>Variables: i:index<br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br>H0: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br>H1: forall (j:index), not(<span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>false<br><br></span>
</span>

<span class="squirrel-step" id="step23">
<span class="input-line" id="in23"><br>    executable pred(Pchall3(i)).</span>
<span class="output-line" id="out23">[goal&gt; Focused goal (1/2):<br>System: secretP<br>Variables: i:index<br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br>H0: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br>H1: forall (j:index), not(<span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>H2: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Pchall3(i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>false<br><br></span>
</span>

<span class="squirrel-step" id="step24">
<span class="input-line" id="in24"><br>    depends Pchall1(i), Pchall3(i).</span>
<span class="output-line" id="out24">[goal&gt; Focused goal (1/2):<br>System: secretP<br>Variables: i:index<br>Clt: <span class="ga" style="color: #00AA00">Pchall1(i)</span> &lt; <span class="ga" style="color: #00AA00">Pchall3(i)</span><br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>D0: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br>H0: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br>H1: forall (j:index), not(<span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>H2: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Pchall3(i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>false<br><br></span>
</span>

<span class="squirrel-step" id="step25">
<span class="input-line" id="in25"><br>    use H2 with Pchall1(i).</span>
<span class="output-line" id="out25">[goal&gt; Focused goal (1/2):<br>System: secretP<br>Variables: i:index<br>Clt: <span class="ga" style="color: #00AA00">Pchall1(i)</span> &lt; <span class="ga" style="color: #00AA00">Pchall3(i)</span><br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>D0: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>D1: <span class="gm" style="font-weight: bold; color: #AA00AA">pkS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>D2: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br>H0: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br>H1: forall (j:index), not(<span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>H2: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Pchall3(i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)<br>H3: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>false<br><br></span>
</span>

<span class="squirrel-step" id="step26">
<span class="input-line" id="in26"><br>    expand exec.</span>
<span class="output-line" id="out26">[goal&gt; Focused goal (1/2):<br>System: secretP<br>Variables: i:index<br>Clt: <span class="ga" style="color: #00AA00">Pchall1(i)</span> &lt; <span class="ga" style="color: #00AA00">Pchall3(i)</span><br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>D0: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>D1: <span class="gm" style="font-weight: bold; color: #AA00AA">pkS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>D2: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br>H0: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br>H1: forall (j:index), not(<span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>H2: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Pchall3(i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)<br>H3: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall1(i)</span>)<br>H4: <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>false<br><br></span>
</span>

<span class="squirrel-step" id="step27">
<span class="input-line" id="in27"><br>    use P_charac with i.</span>
<span class="output-line" id="out27">[goal&gt; Focused goal (1/2):<br>System: secretP<br>Variables: i,j:index<br>Clt: <span class="ga" style="color: #00AA00">Pchall1(i)</span> &lt; <span class="ga" style="color: #00AA00">Pchall3(i)</span><br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>D0: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>D1: <span class="gm" style="font-weight: bold; color: #AA00AA">pkS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>D2: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br>H0: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br>H1: forall (j:index), not(<span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>H2: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Pchall3(i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)<br>H3: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall1(i)</span>)<br>H4: <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span><br>Meq: <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>)) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>false<br><br></span>
</span>

<span class="squirrel-step" id="step28">
<span class="input-line" id="in28"><br>    by use H1 with j.</span>
<span class="output-line" id="out28">[goal&gt; Focused goal (1/1):<br>Systems: secretP<br>Variables: i:index<br>H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)]<br>IH: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j))),<br>    seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))), seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))), <span class="gn" style="color: #AA5500">skS</span>, <span class="gn" style="color: #AA5500">skP</span>,<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))<br>1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br>3: <span class="gn" style="color: #AA5500">skS</span><br>4: <span class="gn" style="color: #AA5500">skP</span><br>5: &lt;<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>),&lt;<span class="gf" style="font-weight: bold">of_bool</span>(false),if false then diff(<span class="gf" style="font-weight: bold">ok</span>,<span class="gf" style="font-weight: bold">ko</span>)&gt;&gt;<br><br><br></span>
</span>

<span class="squirrel-step" id="step29">
<span class="input-line" id="in29"><br>  fa 5.</span>
<span class="output-line" id="out29">[goal&gt; Focused goal (1/1):<br>Systems: secretP<br>Variables: i:index<br>H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)]<br>IH: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j))),<br>    seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))), seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))), <span class="gn" style="color: #AA5500">skS</span>, <span class="gn" style="color: #AA5500">skP</span>,<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))<br>1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br>3: <span class="gn" style="color: #AA5500">skS</span><br>4: <span class="gn" style="color: #AA5500">skP</span><br>5: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br>6: &lt;<span class="gf" style="font-weight: bold">of_bool</span>(false),if false then diff(<span class="gf" style="font-weight: bold">ok</span>,<span class="gf" style="font-weight: bold">ko</span>)&gt;<br><br><br></span>
</span>

<span class="squirrel-step" id="step30">
<span class="input-line" id="in30"> fa 6.</span>
<span class="output-line" id="out30">[goal&gt; Focused goal (1/1):<br>Systems: secretP<br>Variables: i:index<br>H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)]<br>IH: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j))),<br>    seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))), seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))), <span class="gn" style="color: #AA5500">skS</span>, <span class="gn" style="color: #AA5500">skP</span>,<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))<br>1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br>3: <span class="gn" style="color: #AA5500">skS</span><br>4: <span class="gn" style="color: #AA5500">skP</span><br>5: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)<br>6: if false then diff(<span class="gf" style="font-weight: bold">ok</span>,<span class="gf" style="font-weight: bold">ko</span>)<br><br><br></span>
</span>

<span class="squirrel-step" id="step31">
<span class="input-line" id="in31">  by noif 6.</span>
<span class="output-line" id="out31">[goal&gt; Goal strongSecP is proved <br></span>
<span class="com-line" id="com31"><p>It now remains to simplify <code>if false then diff(ok,ko)</code>.</p>
</span>
</span>

<span class="squirrel-step" id="step32">
<span class="input-line" id="in32"><br>Qed.</span>
<span class="output-line" id="out32">Exiting proof mode.<br><br><br></span>
</span>

</span>
<div class="page-header">
  <img src="../logo-circular.png" class="logo">
  <h1 class="project-tagline">Squirrel Prover</h1>
  <a href="https://squirrel-prover.github.io/examples.html" class="header-button">
    <button type="button" class="header-button">Exit</button>
  </a>
  <button type="button" class="header-button" onclick="help()" id="button-panel">Help</button>
</div>

<div class="help-panel" id="help-panel">
  Press the left and right arrows to do and undo an instruction.
  <br><br>
  Alternatively, you can double-click or an instruction.
  <br><br>
  <span style="color: #8B0000;" onmouseenter="highlightOn('in-zone')" onmouseleave="highlightOff('in-zone')">This zone</span> show a squirrel file. You can double-click on a commentary to collapse it for better readabilility.
  <br><br>
  <span style="color: #8B0000;" onmouseenter="highlightOn('out-zone')" onmouseleave="highlightOff('out-zone')">This zone</span> show the output given by Squirrel.
  <br><br>
  <span style="color: #8B0000;" onmouseenter="highlightOn('prec-zone')" onmouseleave="highlightOff('prec-zone')">This zone</span> show the output of the previous instruction to explicit the change caused by a tactic.
</div>

<div class="mainsection" id="main">
  <div class="example-grid">
    <div class="example-col example-col-left" id="in-zone">
      <p class="example-code"><span id="in-line"></span></p>
    </div>
    <div class="example-col example-col-right">
      <div class="example-code example-code-right" style="height: 45%;	border-bottom: 4px double #8B0000;" id="prec-zone"><span>Previously:</span><br><br><span id="prec-line"></span>
      </div>
      <div style="position: relative;">
      <button type="button" class="prec-button" onclick="hidePrec()" id="prec-button" >Hide</button>
      </div>
      <div class="example-code example-code-right" style="height: 55%;" id="out-zone"><span id="out-line"></span>
      </div>
    </div>
  </div>
</div>

<script src="script.js"></script>

</body>

