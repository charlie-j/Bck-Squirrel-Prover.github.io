<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="UTF-8">

  <title>Squirrel Prover - Squirrel Prover</title>
  
  <link rel="stylesheet" href="style.css">
</head>

<body>
<span style="display: none;"><span class="input-line" id="in0">(*******************************************************************************
SIGNED DDH

The signed DDH protocol as described in [G] features two roles, P and S.
Each role is associated to a secret key (skP and skS).

P -&gt; S : &lt;pk(skP), g^a&gt;
S -&gt; P : &lt;pk(skS),g^b&gt;,sign(&lt;&lt;g^a,g^b&gt;,pk(skP)&gt;,skS)
P -&gt; S : sign(&lt;&lt;g^b,g^a&gt;,pk(skS)&gt;,skP)

We consider multiple sessions but two agents only (one agent for the role P and
one agent for the role S) and show the strong secrecy of the shared key.

* In this file `signed-ddh-P.sp`, we show that the key g^a^b as computed by P 
  is indistinguishable from g^k with k fresh (system secretP).
* In another file `signed-ddh-S.sp`, we show that the key g^a^b as computed by S 
  is indistinguishable from g^k with k fresh (system secretS).

[G] ISO/IEC 9798-3:2019, IT Security techniques – Entity authentication –
Part 3: Mechanisms using digital signature techniques.
*******************************************************************************)

(**
We first declare some public constants, the secret keys for roles P and S,
the channels used by these two roles.
**)
abstract ok : message
abstract ko : message

name skP : message
name skS : message

channel cP
channel cS

(**
Names `a` and `b` represent the random numbers used by roles P and S.
They are indexed so that each new session uses a new random name.
**)
name a : index -&gt; message
name b : index -&gt; message
(**
The name `k` represents the random number used in the strong secrecy property.
It has 2 as index arity to model the fact that each interaction between
session `i` of role P and session `j` of role S uses a new random name.
**)
name k :  index -&gt; index -&gt; message

(**
We declare a DDH context, using `g` for the generator element and `^` for the
power operator.
**)
ddh g, (^) where group:message exposants:message.</span><span class="output-line" id="out0">true
</span><span class="input-line" id="in1">

(**
We also declare a signature scheme by specifying 3 function symbols.
**)
signature sign,checksign,pk

(**
In the system `secretP`, we add an output at the end of the role of P.
This output is actually a bi-term:
* the left side of the system outputs the shared key as computed by P,
* the right side of the system outputs `g^k(i,j)` where `k(i,j)` is fresh.
The goal will be to prove that these two sides are indistinguishable.
**)
process Pchall(i:index) =
  out(cP, &lt;pk(skP),g^a(i)&gt;);
  in(cP, x2);
  let gS = snd(fst(x2)) in
  let pkS = fst(fst(x2)) in
  if checksign(snd(x2),pkS) = &lt;&lt;g^a(i),gS&gt;,pk(skP)&gt; &amp;&amp; pkS = pk(skS) then
    out(cP,sign(&lt;&lt;gS,g^a(i)&gt;,pkS&gt;,skP));
    in(cP, challenge);
      try find j such that gS = g^b(j) in
        out(cP, diff(g^a(i)^b(j),g^k(i,j)))
      else
        (** The `try find` construct is needed to retrieve the index `j`,
        but this else branch should never be reachable.
        We thus output a bi-term with distinct public constants so that
        the equivalence for the strong secrecy could not hold if this else
        branch is reached. **)
        out(cP, diff(ok,ko))

process S(j:index) =
  in(cS, x1);
  let gP = snd(x1) in
  let pkP = fst(x1) in
  if pkP = pk(skP) then
    out(cS, &lt; &lt;pk(skS),g^b(j)&gt;, sign(&lt;&lt;gP,g^b(j)&gt;,pkP&gt;,skS)&gt;);
    in(cS, x3);
    if checksign(x3,pkP) = &lt;&lt;g^b(j),gP&gt;,pk(skS)&gt; then
      out(cS,ok)

system [secretP] (!_i Pchall(i) | !_j S(j)).</span><span class="output-line" id="out1">Un-processed system:
  
  (!_i <span class="pn" style="font-weight:bold; color: #0000AA">Pchall</span> i) | (!_j <span class="pn" style="font-weight:bold; color: #0000AA">S</span> j)

Processed system:
  
  (!_i
     Pchall:
     <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cP</span>,pair(pk(skP),(g ^ a(i))));
     <span class="pio" style="font-weight: bold">in</span>(<span class="pc">cP</span>,<span class="pv" style="font-weight: bold; color: #AA00AA">x2</span>);
     <span class="pk" style="font-weight: bold">let</span> <span class="pv" style="font-weight: bold; color: #AA00AA">gS</span> = snd(fst(x2)) <span class="pk" style="font-weight: bold">in</span>
     <span class="pk" style="font-weight: bold">let</span> <span class="pv" style="font-weight: bold; color: #AA00AA">pkS</span> = fst(fst(x2)) <span class="pk" style="font-weight: bold">in</span>
     <span class="pc" style="text-decoration: underline; color: #AA0000">if</span> (checksign(snd(x2),pkS(i)) = pair(pair((g ^ a(i)),gS(i)),pk(skP)) &amp;&amp;
         pkS(i) = pk(skS)) <span class="pc" style="text-decoration: underline; color: #AA0000">then</span>
       Pchall1:
       <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cP</span>,sign(pair(pair(gS(i),(g ^ a(i))),pkS(i)),skP));
       <span class="pio" style="font-weight: bold">in</span>(<span class="pc">cP</span>,<span class="pv" style="font-weight: bold; color: #AA00AA">challenge</span>);
       <span class="pc" style="text-decoration: underline; color: #AA0000">find</span> (j) <span class="pc" style="text-decoration: underline; color: #AA0000">such that</span> gS(i) = (g ^ b(j)) <span class="pc" style="text-decoration: underline; color: #AA0000">in</span>
         Pchall2: <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cP</span>,<span>diff</span>(((g ^ a(i)) ^ b(j)),(g ^ k(i,j)))); <span class="pn" style="font-weight:bold; color: #0000AA">null</span> <span class="pc" style="text-decoration: underline; color: #AA0000">else</span>
         Pchall3: <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cP</span>,<span>diff</span>(ok,ko)); <span class="pn" style="font-weight:bold; color: #0000AA">null</span> <span class="pc" style="text-decoration: underline; color: #AA0000">else</span> Pchall4: <span class="pn" style="font-weight:bold; color: #0000AA">null</span>) |
  (!_j
     <span class="pio" style="font-weight: bold">in</span>(<span class="pc">cS</span>,<span class="pv" style="font-weight: bold; color: #AA00AA">x1</span>);
     <span class="pk" style="font-weight: bold">let</span> <span class="pv" style="font-weight: bold; color: #AA00AA">gP</span> = snd(x1) <span class="pk" style="font-weight: bold">in</span>
     <span class="pk" style="font-weight: bold">let</span> <span class="pv" style="font-weight: bold; color: #AA00AA">pkP</span> = fst(x1) <span class="pk" style="font-weight: bold">in</span>
     <span class="pc" style="text-decoration: underline; color: #AA0000">if</span> pkP(j) = pk(skP) <span class="pc" style="text-decoration: underline; color: #AA0000">then</span>
       S:
       <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cS</span>,
       pair(pair(pk(skS),(g ^ b(j))),
             sign(pair(pair(gP(j),(g ^ b(j))),pkP(j)),skS)));
       <span class="pio" style="font-weight: bold">in</span>(<span class="pc">cS</span>,<span class="pv" style="font-weight: bold; color: #AA00AA">x3</span>);
       <span class="pc" style="text-decoration: underline; color: #AA0000">if</span> checksign(x3,pkP(j)) = pair(pair((g ^ b(j)),gP(j)),pk(skS)) <span class="pc" style="text-decoration: underline; color: #AA0000">then</span>
         S1: <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cS</span>,ok); <span class="pn" style="font-weight:bold; color: #0000AA">null</span> <span class="pc" style="text-decoration: underline; color: #AA0000">else</span> S2: <span class="pn" style="font-weight:bold; color: #0000AA">null</span> <span class="pc" style="text-decoration: underline; color: #AA0000">else</span> S3: <span class="pn" style="font-weight:bold; color: #0000AA">null</span>)

System secretP registered with actions (init,Pchall,Pchall1,Pchall2,Pchall3,
                                         Pchall4,S,S1,S2,S3).
</span><span class="input-line" id="in2">

(**
In the proof of strong secrecy for the system `secretP`, we will use 
the following property, stating that whenever P accepts a message from S, 
this message is of the form `&lt;&lt;_,x&gt;,_&gt;` where `x = g^b(j)`.
**)
goal [secretP] P_charac (i:index):
  happens(Pchall1(i)) =&gt; 
    cond@Pchall1(i) =&gt; 
      exists (j:index), snd(fst(input@Pchall1(i))) = g^b(j).</span><span class="output-line" id="out2">Goal P_charac :
  <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall1(i)</span>) =&gt;
  <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span> =&gt;
  exists (j:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>)) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))
</span><span class="input-line" id="in3">
(**
The high-level idea of the proof is to use the EUF cryptographic axiom:
only S can forge a correct signature that will be accepted by P since
the secret key is not known by the attacker.
**)
Proof.</span><span class="output-line" id="out3">[goal&gt; Focused goal (1/1):
System: secretP
Variables: i:index
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall1(i)</span>) =&gt;
<span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span> =&gt; exists (j:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>)) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))

</span><span class="input-line" id="in4">
  (** We start by introducing the hypotheses and expanding the macros. **)
  intro Hap Hcond.</span><span class="output-line" id="out4">[&gt; Line 113: (intro Hap Hcond) 
[goal&gt; Focused goal (1/1):
System: secretP
Variables: i:index
D: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
D0: <span class="gm" style="font-weight: bold; color: #AA00AA">pkS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
D1: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall1(i)</span>)
Hcond: <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
exists (j:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>)) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))

</span><span class="input-line" id="in5">
  expand cond, pkS(i)@Pchall1(i).</span><span class="output-line" id="out5">[&gt; Line 114: (expand cond, pkS(i)@Pchall1(i)) 
[goal&gt; Focused goal (1/1):
System: secretP
Variables: i:index
D: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
D1: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall1(i)</span>)
Meq: <span class="gf" style="font-weight: bold">checksign</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>),<span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))) =
     &lt;&lt;<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span>&gt;,<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skP</span>)&gt;
Meq0: <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>)) = <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skS</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
exists (j:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>)) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))

</span><span class="input-line" id="in6">
  (** We then rewrite Meq using the message equality Meq0. **)
  rewrite Meq0 in Meq.</span><span class="output-line" id="out6">[&gt; Line 116: (rewrite ... in Meq) 
[goal&gt; Focused goal (1/1):
System: secretP
Variables: i:index
D: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
D1: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall1(i)</span>)
Meq: <span class="gf" style="font-weight: bold">checksign</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skS</span>)) =
     &lt;&lt;<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span>&gt;,<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skP</span>)&gt;
Meq0: <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>)) = <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skS</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
exists (j:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>)) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))

</span><span class="input-line" id="in7"> 
  (** We are now able to apply the `euf` tactic, which will search for
  occurences of signatures with `skS`: the only possibility is the output
  of an action `S(j)`.  **)
  euf Meq.</span><span class="output-line" id="out7">[&gt; Line 120: (euf Meq) 
[goal&gt; Focused goal (1/1):
System: secretP
Variables: i,j:index
D: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
D1: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
H: <span class="ga" style="color: #00AA00">S(j)</span> &lt;= <span class="ga" style="color: #00AA00">Pchall1(i)</span> || <span class="ga" style="color: #00AA00">S(j)</span> &lt; <span class="ga" style="color: #00AA00">Pchall1(i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall1(i)</span>)
Meq: <span class="gf" style="font-weight: bold">checksign</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>),<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skS</span>)) =
     &lt;&lt;<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span>&gt;,<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skP</span>)&gt;
Meq0: <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>)) = <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skS</span>)
Meq1: &lt;&lt;<span class="gm" style="font-weight: bold; color: #AA00AA">gP</span>(j)@<span class="ga" style="color: #00AA00">S(j)</span>,<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)&gt;,<span class="gm" style="font-weight: bold; color: #AA00AA">pkP</span>(j)@<span class="ga" style="color: #00AA00">S(j)</span>&gt; =
      &lt;&lt;<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span>&gt;,<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skP</span>)&gt;
<span class="sep" style="font-weight: bold">----------------------------------------</span>
exists (j:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>)) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))

</span><span class="input-line" id="in8">
  (** The conclusion is now trivial from the Meq1 and D1 hypotheses. **)
  by exists j.</span><span class="output-line" id="out8">[&gt; Line 122: by (exists j) 
[goal&gt; Goal P_charac is proved 
</span><span class="input-line" id="in9">
Qed.</span><span class="output-line" id="out9">Exiting proof mode.


</span><span class="input-line" id="in10">

(**
We now show the strong secrecy of the shared key for the system `secretP`,
expressed by the logic formula `forall t:timestamp, frame@t` where `frame@t` 
is actually a bi-frame. We will prove that the left projection of `frame@t` 
(_i.e._ where the shared key `g^a^b` is outputted) is indistinguishable from the 
right projection of `frame@t` (_i.e._ where `g^k` is outputted).
**)
equiv [secretP] strongSecP.</span><span class="output-line" id="out10">Goal strongSecP :
  forall t:timestamp, <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@t
</span><span class="input-line" id="in11">
(**
The proof is done by induction, after having enriched the frame with some
additional (bi-)terms. Intuitively, the idea of enriching the frame is to
simplify the cases that are contexts built using applications of public
function symbols and terms added in the enriched frame.
It then remains to prove:
* the base case, _i.e._ prove that the enriched bi-frame is indistinguishable;
* the case corresponding to the output `diff(ok,ko)`, _i.e._ prove that this
output is never reached using the previous `P_charac` property.
**)
Proof.</span><span class="output-line" id="out11">[goal&gt; Focused goal (1/1):
Systems: secretP
Variables: t:timestamp
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)]
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@t


</span><span class="input-line" id="in12">
  (** We start by enriching the frame. **)
  enrich 
    skP, skS, 
    seq(i:index -&gt;g^a(i)), 
    seq(j:index -&gt;g^b(j)),
    seq(i,j:index -&gt;diff(g^a(i)^b(j),g^k(i,j))).</span><span class="output-line" id="out12">[&gt; Line 149: (enrich skP, skS, <span>seq</span>(i:index-&gt;(g ^ a(i))),
             <span>seq</span>(j:index-&gt;(g ^ b(j))),
             <span>seq</span>(i,j:index-&gt;<span>diff</span>(((g ^ a(i)) ^ b(j)),(g ^ k(i,j)))))

[goal&gt; Focused goal (1/1):
Systems: secretP
Variables: t:timestamp
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)]
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))
1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))
2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))
3: <span class="gn" style="color: #AA5500">skS</span>
4: <span class="gn" style="color: #AA5500">skP</span>
5: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@t


</span><span class="input-line" id="in13">

  (** We now apply the `induction` tactic, which generates several cases,
  one for each possible value that can be taken by the timestamp `t`.
  For most cases, applying the induction hypothesis `IH` allows to conclude
  because `frame@t` can be built from `frame@pred(t)` and elements added to
  the frame by the tactic `enrich`. **)
  induction t; try (by expandall; apply IH).</span><span class="output-line" id="out13">[&gt; Line 156: ((induction t);(try by (expandall;(apply ... )))) 
[goal&gt; Focused goal (1/2):
Systems: secretP
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">init</span>)]
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))
1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))
2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))
3: <span class="gn" style="color: #AA5500">skS</span>
4: <span class="gn" style="color: #AA5500">skP</span>
5: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@<span class="ga" style="color: #00AA00">init</span>


</span><span class="input-line" id="in14">

  (** Case where `t = init`.
  We use here the DDH assumption. **)
  expandall.</span><span class="output-line" id="out14">[&gt; Line 160: expandall 
[goal&gt; Focused goal (1/2):
Systems: secretP
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">init</span>)]
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))
1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))
2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))
3: <span class="gn" style="color: #AA5500">skS</span>
4: <span class="gn" style="color: #AA5500">skP</span>


</span><span class="input-line" id="in15">
  by ddh g,a,b,k.</span><span class="output-line" id="out15">[&gt; Line 161: by (ddh g, a, b, k) 
[goal&gt; Focused goal (1/1):
Systems: secretP
Variables: i:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)]
IH: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j))),
    seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))), seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))), <span class="gn" style="color: #AA5500">skS</span>, <span class="gn" style="color: #AA5500">skP</span>,
    <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))
1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))
2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))
3: <span class="gn" style="color: #AA5500">skS</span>
4: <span class="gn" style="color: #AA5500">skP</span>
5: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@<span class="ga" style="color: #00AA00">Pchall3(i)</span>


</span><span class="input-line" id="in16">

  (** Case where `t = Pchall3(i)`. 
  We will show that this case is not possible, by showing that the formula
  `exec@pred(Pchall3(i)) &amp;&amp; cond@Pchall3(i)` is equivalent to `False`, relying
  on the previous property `P_charac`. **)
  expand frame, exec, output.</span><span class="output-line" id="out16">[&gt; Line 167: (expand frame, exec, output) 
[goal&gt; Focused goal (1/1):
Systems: secretP
Variables: i:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)]
IH: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j))),
    seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))), seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))), <span class="gn" style="color: #AA5500">skS</span>, <span class="gn" style="color: #AA5500">skP</span>,
    <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))
1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))
2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))
3: <span class="gn" style="color: #AA5500">skS</span>
4: <span class="gn" style="color: #AA5500">skP</span>
5: &lt;<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>),
    &lt;<span class="gf" style="font-weight: bold">of_bool</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>) &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Pchall3(i)</span>),
     if (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>) &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Pchall3(i)</span>) then diff(<span class="gf" style="font-weight: bold">ok</span>,<span class="gf" style="font-weight: bold">ko</span>)&gt;&gt;


</span><span class="input-line" id="in17">
  equivalent exec@pred(Pchall3(i)) &amp;&amp; cond@Pchall3(i), False.</span><span class="output-line" id="out17">[&gt; Line 168: (equivalent (exec@<span>pred</span>(Pchall3(i)) &amp;&amp; cond@Pchall3(i)), <span>False</span>) 
[goal&gt; Focused goal (1/2):
System: secretP
Variables: i:index
D: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
H0: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
H1: <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Pchall3(i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
false

</span><span class="input-line" id="in18">
    expand cond.</span><span class="output-line" id="out18">[&gt; Line 169: (expand cond) 
[goal&gt; Focused goal (1/2):
System: secretP
Variables: i:index
D: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
H0: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
H1: forall (j:index), not(<span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))
<span class="sep" style="font-weight: bold">----------------------------------------</span>
false

</span><span class="input-line" id="in19">
    executable pred(Pchall3(i)).</span><span class="output-line" id="out19">[&gt; Line 170: (executable <span>pred</span>(Pchall3(i))) 
[goal&gt; Focused goal (1/2):
System: secretP
Variables: i:index
D: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
H0: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
H1: forall (j:index), not(<span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))
H2: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Pchall3(i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
false

</span><span class="input-line" id="in20">
    depends Pchall1(i), Pchall3(i).</span><span class="output-line" id="out20">[&gt; Line 171: (depends Pchall1(i), Pchall3(i)) 
[goal&gt; Focused goal (1/2):
System: secretP
Variables: i:index
Clt: <span class="ga" style="color: #00AA00">Pchall1(i)</span> &lt; <span class="ga" style="color: #00AA00">Pchall3(i)</span>
D: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
D0: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
H0: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
H1: forall (j:index), not(<span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))
H2: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Pchall3(i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
false

</span><span class="input-line" id="in21">
    use H2 with Pchall1(i).</span><span class="output-line" id="out21">[&gt; Line 172: (assert ... as ) 
[goal&gt; Focused goal (1/2):
System: secretP
Variables: i:index
Clt: <span class="ga" style="color: #00AA00">Pchall1(i)</span> &lt; <span class="ga" style="color: #00AA00">Pchall3(i)</span>
D: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
D0: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
D1: <span class="gm" style="font-weight: bold; color: #AA00AA">pkS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
D2: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
H0: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
H1: forall (j:index), not(<span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))
H2: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Pchall3(i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
H3: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
false

</span><span class="input-line" id="in22">
    expand exec.</span><span class="output-line" id="out22">[&gt; Line 173: (expand exec) 
[goal&gt; Focused goal (1/2):
System: secretP
Variables: i:index
Clt: <span class="ga" style="color: #00AA00">Pchall1(i)</span> &lt; <span class="ga" style="color: #00AA00">Pchall3(i)</span>
D: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
D0: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
D1: <span class="gm" style="font-weight: bold; color: #AA00AA">pkS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
D2: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
H0: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
H1: forall (j:index), not(<span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))
H2: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Pchall3(i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
H3: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall1(i)</span>)
H4: <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
false

</span><span class="input-line" id="in23">
    use P_charac with i.</span><span class="output-line" id="out23">[&gt; Line 174: (assert ... as ) 
[goal&gt; Focused goal (1/2):
System: secretP
Variables: i,j:index
Clt: <span class="ga" style="color: #00AA00">Pchall1(i)</span> &lt; <span class="ga" style="color: #00AA00">Pchall3(i)</span>
D: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
D0: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
D1: <span class="gm" style="font-weight: bold; color: #AA00AA">pkS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
D2: <span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall1(i)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>))
H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
H0: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
H1: forall (j:index), not(<span class="gm" style="font-weight: bold; color: #AA00AA">gS</span>(i)@<span class="ga" style="color: #00AA00">Pchall3(i)</span> = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))
H2: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Pchall3(i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
H3: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Pchall1(i)</span>)
H4: <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>
Meq: <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Pchall1(i)</span>)) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))
<span class="sep" style="font-weight: bold">----------------------------------------</span>
false

</span><span class="input-line" id="in24">
    by use H1 with j.</span><span class="output-line" id="out24">[&gt; Line 175: by (assert ... as ) 
[goal&gt; Focused goal (1/1):
Systems: secretP
Variables: i:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)]
IH: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j))),
    seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))), seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))), <span class="gn" style="color: #AA5500">skS</span>, <span class="gn" style="color: #AA5500">skP</span>,
    <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))
1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))
2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))
3: <span class="gn" style="color: #AA5500">skS</span>
4: <span class="gn" style="color: #AA5500">skP</span>
5: &lt;<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>),&lt;<span class="gf" style="font-weight: bold">of_bool</span>(false),if false then diff(<span class="gf" style="font-weight: bold">ok</span>,<span class="gf" style="font-weight: bold">ko</span>)&gt;&gt;


</span><span class="input-line" id="in25">
  fa 5.</span><span class="output-line" id="out25">[&gt; Line 176: (fa 5) 
[goal&gt; Focused goal (1/1):
Systems: secretP
Variables: i:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)]
IH: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j))),
    seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))), seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))), <span class="gn" style="color: #AA5500">skS</span>, <span class="gn" style="color: #AA5500">skP</span>,
    <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))
1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))
2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))
3: <span class="gn" style="color: #AA5500">skS</span>
4: <span class="gn" style="color: #AA5500">skP</span>
5: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
6: &lt;<span class="gf" style="font-weight: bold">of_bool</span>(false),if false then diff(<span class="gf" style="font-weight: bold">ok</span>,<span class="gf" style="font-weight: bold">ko</span>)&gt;


</span><span class="input-line" id="in26"> fa 6.</span><span class="output-line" id="out26">[&gt; Line 176: (fa 6) 
[goal&gt; Focused goal (1/1):
Systems: secretP
Variables: i:index
H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)]
IH: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j))),
    seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))), seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))), <span class="gn" style="color: #AA5500">skS</span>, <span class="gn" style="color: #AA5500">skP</span>,
    <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))
1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))
2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))
3: <span class="gn" style="color: #AA5500">skS</span>
4: <span class="gn" style="color: #AA5500">skP</span>
5: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Pchall3(i)</span>)
6: if false then diff(<span class="gf" style="font-weight: bold">ok</span>,<span class="gf" style="font-weight: bold">ko</span>)


</span><span class="input-line" id="in27">
  (** It now remains to simplify `if false then diff(ok,ko)`. **)
  by noif 6.</span><span class="output-line" id="out27">[&gt; Line 178: by (noif 6) 
[goal&gt; Goal strongSecP is proved 
</span><span class="input-line" id="in28">
Qed.</span><span class="output-line" id="out28">Exiting proof mode.


</span></span>
<h1 id="about-this-tutorial">Example</h1>
<div class="example-left">
  <div class="example-buttons">
    <button type="button" class="command" onclick="goto_down()">-</button>
    <button type="button" class="command" onclick="goto_selected()">=></button>
    <button type="button" class="command" onclick="goto_up()">+</button>
    <button type="button" class="command" style="float: right;">doc</button>
  </div>
  <div class="example-code" style="height: 650px;	border-style: none solid solid solid;"><span id="in-line"></span></div>
</div>
<div class="example-left">
  <div class="example-code" style="height: 300px;	border-style: solid solid double none;"><span>Previously:</span>
<span id="prec-line"></span>
  </div>
  <div class="example-code" style="height: 400px;	border-style: none solid solid none;"><span id="out-line"></span></div>
</div>

<script src="script.js"></script>

</body>

