<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="UTF-8">

  <title>Squirrel Prover - Squirrel Prover</title>
  
  <link rel="stylesheet" href="style.css">
</head>

<body onkeydown="key(event)">
<span style="display: none;"><span class="squirrel-step" id="step0">
<span class="input-line" id="in0">set timeout=12.</span>
<span class="output-line" id="out0"></span>
<span class="com-line" id="com0"><h1 id="yubikey">YUBIKEY</h1>
<p>The YubiKey is a simple physical authentication device with a unique button. This device, manufactured by Yubico, allows users to securely authenticate to their accounts by issuing a one-time password (OTP).</p>
<p>In its typical configuration, the YubiKey generates a random OTP by encrypting a secret value and a counter. This message is accepted by the server only if it decrypts under the correct key to a valid secret value containing a counter whose value is larger than the last value accepted by the server for that YubiKey.</p>
<p>In this model, we analyze the security of the protocol as described in [1], assuming that the server remains secure.</p>
<p>Yubico assigns a key <code>k</code>, as well as a public and a secret identifier <code>pid, sid</code> to each YubiKey. The counter <code>cpt</code> inside the YubiKey is incremented whenever the YubiKey is plugged in, as well as when an OTP is generated, i.e. when the button of the YubiKey is pressed. This OTP is obtained by encrypting the counter value and the <code>sid</code> of the YubiKey with the key <code>k</code>.</p>
<ul>
<li>YubiKey -&gt; Server : &lt;pid,&lt;nonce,senc(&lt;sid,cpt&gt;,npr,k)&gt;&gt;</li>
</ul>
<p>Here, <code>npr</code> is the encryption randomness. The server accepts this message if it decrypts with a legitimate key <code>k</code>, and leads to a valid secret value <code>sid</code>. Lastly, the counter value obtained through decryption has to be larger than the current value stored in the server database. After this exchange, the server updates its counter with the value just received.</p>
<h4 id="comments">COMMENTS</h4>
<ul>
<li><p>The OTP is an encryption of a triple <code>&lt;sid, cpt, npr&gt;</code>. It is modelled here as a randomized encryption of a pair <code>&lt;sid, cpt&gt;</code>. According to the specification in [1], AES is used.</p></li>
<li><p>In [1], they “over-approximate in the case that the Yubikey increases the session token by allowing the adversary to instantiate the rule for any counter value that is higher than the previous one”. Here, we model the incrementation by 1 of the counter.</p></li>
</ul>
<h4 id="security-properties">SECURITY PROPERTIES</h4>
<p>The 3 security properties as stated in [1].</p>
<ul>
<li>Property 1: absence of replay attacks.</li>
<li>Property 2: injective correspondence.</li>
<li>Property 3: monotonicity.</li>
</ul>
<p>[1] R. Künnemann, "Foundations for analyzing security APIs in the symbolic and computational model’, 2014.</p>
</span>
</span>

<span class="squirrel-step" id="step1">
<span class="input-line" id="in1">abstract startplug  : message<br>abstract endplug    : message<br>abstract startpress : message<br>abstract accept     : message<br>abstract pid        : index -&gt; message<br><br>name sid  : index -&gt; message<br>name nonce: index -&gt; index -&gt; message.</span>
<span class="output-line" id="out1"></span>
<span class="com-line" id="com1"><p>Public constants (<code>abstract</code>) and names used in the protocol.</p>
</span>
</span>

<span class="squirrel-step" id="step2">
<span class="input-line" id="in2">senc enc,dec<br>name k  : index -&gt; message<br>name npr: index -&gt; index -&gt; message.</span>
<span class="output-line" id="out2"></span>
<span class="com-line" id="com2"><p>Symmetric encryption scheme, using the secret key <code>k</code> (with index arity 1 so that each YubiKey is associated to a key) and the random <code>npr</code> (with index arity 2 so that each session of a YubiKey uses a new random name).</p>
</span>
</span>

<span class="squirrel-step" id="step3">
<span class="input-line" id="in3">abstract myzero  : message<br>abstract myone   : message<br>abstract mySucc  : message -&gt; message<br>abstract orderOk : message<br>abstract (~&lt;)    : message -&gt; message -&gt; message.</span>
<span class="output-line" id="out3"></span>
<span class="com-line" id="com3"><p>Public constants and public functions used to model counter values.</p>
</span>
</span>

<span class="squirrel-step" id="step4">
<span class="input-line" id="in4">mutable YCpt(i:index): message = myzero<br>mutable SCpt(i:index): message = myzero.</span>
<span class="output-line" id="out4"></span>
<span class="com-line" id="com4"><p>Mutable cells for the YubiKey and the server, initialized with <code>myzero</code>.</p>
</span>
</span>

<span class="squirrel-step" id="step5">
<span class="input-line" id="in5">channel cT<br>channel cR.</span>
<span class="output-line" id="out5"></span>
<span class="com-line" id="com5"><p>Communication channels used in the protocol.</p>
</span>
</span>

<span class="squirrel-step" id="step6">
<span class="input-line" id="in6">process yubikeyplug(i:index,j:index) =<br>  in(cT, x1);<br>  if x1 = startplug then<br>    YCpt(i) := mySucc(YCpt(i));<br>    out(cT,endplug).</span>
<span class="output-line" id="out6"></span>
<span class="com-line" id="com6"><p>When the key is plugged, its counter is incremented.</p>
</span>
</span>

<span class="squirrel-step" id="step7">
<span class="input-line" id="in7">process yubikeypress(i:index,j:index) =<br>  in(cT,x2);<br>  if x2 = startpress then<br>    let cpt = YCpt(i) in<br>    YCpt(i) := mySucc(YCpt(i));<br>    out(cT,&lt;pid(i),&lt;nonce(i,j),enc(&lt;sid(i),cpt&gt;,npr(i,j),k(i))&gt;&gt;).</span>
<span class="output-line" id="out7"></span>
<span class="com-line" id="com7"><p>When the key is pressed, an OTP is sent with the current value of the counter and the counter is incremented.</p>
</span>
</span>

<span class="squirrel-step" id="step8">
<span class="input-line" id="in8">process server(ii:index) =<br>  in(cR,y1);<br>  try find i such that fst(y1) = pid(i) in<br>    if dec(snd(snd(y1)),k(i)) &lt;&gt; fail<br>        &amp;&amp; SCpt(i) ~&lt; snd(dec(snd(snd(y1)),k(i))) = orderOk<br>    then<br>      SCpt(i) := snd(dec(snd(snd(y1)),k(i)));<br>      out(cR,accept).</span>
<span class="output-line" id="out8"></span>
<span class="com-line" id="com8"><p>When the server receives a message, it checks whether it corresponds to a pid in its database, and checks also that the counter inside the OTP is strictly greater than the counter associated to the token. If so, the value inside the OTP is used to update the database. Now, the counter value associated to this token is this new value.</p>
</span>
</span>

<span class="squirrel-step" id="step9">
<span class="input-line" id="in9">system<br>  ((!_i !_j Plug: yubikeyplug(i,j))<br>    | (!_i !_j Press: yubikeypress(i,j))<br>    | (!_ii S: server(ii))).</span>
<span class="output-line" id="out9">System before processing:<br>  <br>  (!_i !_j Plug: <span class="pn" style="font-weight:bold; color: #0000AA">yubikeyplug</span> i j) |<br>  ((!_i !_j Press: <span class="pn" style="font-weight:bold; color: #0000AA">yubikeypress</span> i j) | (!_ii S: <span class="pn" style="font-weight:bold; color: #0000AA">server</span> ii))<br><br>System after processing:<br>  <br>  (!_i<br>     !_j<br>       <span class="pio" style="font-weight: bold">in</span>(<span class="pc">cT</span>,<span class="pv" style="font-weight: bold; color: #AA00AA">x1</span>);<br>       <span class="pc" style="text-decoration: underline; color: #AA0000">if</span> (x1 = startplug) <span class="pc" style="text-decoration: underline; color: #AA0000">then</span><br>         YCpt(i) <span class="pk" style="font-weight: bold">:=</span> mySucc(YCpt(i)); Plug: <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cT</span>,endplug); <span class="pn" style="font-weight:bold; color: #0000AA">null</span> <span class="pc" style="text-decoration: underline; color: #AA0000">else</span><br>         Plug1: <span class="pn" style="font-weight:bold; color: #0000AA">null</span>) |<br>  ((!_i<br>      !_j<br>        <span class="pio" style="font-weight: bold">in</span>(<span class="pc">cT</span>,<span class="pv" style="font-weight: bold; color: #AA00AA">x2</span>);<br>        <span class="pc" style="text-decoration: underline; color: #AA0000">if</span> (x2 = startpress) <span class="pc" style="text-decoration: underline; color: #AA0000">then</span><br>          <span class="pk" style="font-weight: bold">let</span> <span class="pv" style="font-weight: bold; color: #AA00AA">cpt</span> = YCpt(i) <span class="pk" style="font-weight: bold">in</span><br>          YCpt(i) <span class="pk" style="font-weight: bold">:=</span> mySucc(YCpt(i));<br>          Press:<br>          <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cT</span>,<br>          pair(pid(i),<br>                pair(nonce(i,j),enc(pair(sid(i),cpt(i,j)),npr(i,j),k(i)))));<br>          <span class="pn" style="font-weight:bold; color: #0000AA">null</span> <span class="pc" style="text-decoration: underline; color: #AA0000">else</span> Press1: <span class="pn" style="font-weight:bold; color: #0000AA">null</span>) |<br>   (!_ii<br>      <span class="pio" style="font-weight: bold">in</span>(<span class="pc">cR</span>,<span class="pv" style="font-weight: bold; color: #AA00AA">y1</span>);<br>      <span class="pc" style="text-decoration: underline; color: #AA0000">find</span> (i) <span class="pc" style="text-decoration: underline; color: #AA0000">such that</span> (fst(y1) = pid(i)) <span class="pc" style="text-decoration: underline; color: #AA0000">in</span><br>        <span class="pc" style="text-decoration: underline; color: #AA0000">if</span> ((dec(snd(snd(y1)),k(i)) &lt;&gt; fail) &amp;&amp;<br>            ((SCpt(i) ~&lt; snd(dec(snd(snd(y1)),k(i)))) = orderOk)) <span class="pc" style="text-decoration: underline; color: #AA0000">then</span><br>          SCpt(i) <span class="pk" style="font-weight: bold">:=</span> snd(dec(snd(snd(y1)),k(i))); S: <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cR</span>,accept); <span class="pn" style="font-weight:bold; color: #0000AA">null</span><br>        <span class="pc" style="text-decoration: underline; color: #AA0000">else</span> S1: <span class="pn" style="font-weight:bold; color: #0000AA">null</span> <span class="pc" style="text-decoration: underline; color: #AA0000">else</span> S2: <span class="pn" style="font-weight:bold; color: #0000AA">null</span>))<br><br>System default registered with actions (init,Plug,Plug1,Press,Press1,S,S1,S2).<br></span>
<span class="com-line" id="com9"><p>In the final system, processes can play in parallel an unbounded number of sessions.</p>
</span>
</span>

<span class="squirrel-step" id="step10">
<span class="input-line" id="in10">include Basic.</span>
<span class="output-line" id="out10">Goal eq_sym :<br>  (x = y) = (y = x)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(x = y) = (y = x)<br><br>[&gt; Line 11: by (rewrite ...) <br>[goal&gt; Goal eq_sym is proved <br>Exiting proof mode.<br><br><br>Goal neq_sym :<br>  (x &lt;&gt; y) = (y &lt;&gt; x)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(x &lt;&gt; y) = (y &lt;&gt; x)<br><br>[&gt; Line 14: by (rewrite ...) <br>[goal&gt; Goal neq_sym is proved <br>Exiting proof mode.<br><br><br>Goal eq_refl :<br>  (x = x) = true<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: x:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(x = x) = true<br><br>[&gt; Line 18: by (rewrite ...) <br>[goal&gt; Goal eq_refl is proved <br>Exiting proof mode.<br><br><br>Goal false_true :<br>  (false = true) = false<br>[goal&gt; Focused goal (1/1):<br>System: any<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(false = true) = false<br><br>[&gt; Line 30: by (rewrite ...) <br>[goal&gt; Goal false_true is proved <br>Exiting proof mode.<br><br><br>Goal eq_true :<br>  (b = true) = b<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(b = true) = b<br><br>[&gt; Line 35: by (case b) <br>[goal&gt; Goal eq_true is proved <br>Exiting proof mode.<br><br><br>Goal eq_true2 :<br>  (true = b) = b<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(true = b) = b<br><br>[&gt; Line 39: by (case b) <br>[goal&gt; Goal eq_true2 is proved <br>Exiting proof mode.<br><br><br>Goal not_not :<br>  not(not(b)) = b<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not(not(b)) = b<br><br>[&gt; Line 54: by (case b) <br>[goal&gt; Goal not_not is proved <br>Exiting proof mode.<br><br><br>Goal not_eq :<br>  not(x = y) = (x &lt;&gt; y)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not(x = y) = (x &lt;&gt; y)<br><br>[&gt; Line 60: by (rewrite ...) <br>[goal&gt; Goal not_eq is proved <br>Exiting proof mode.<br><br><br>Goal not_neq :<br>  not(x &lt;&gt; y) = (x = y)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not(x &lt;&gt; y) = (x = y)<br><br>[&gt; Line 66: by (rewrite ...) <br>[goal&gt; Goal not_neq is proved <br>Exiting proof mode.<br><br><br>Goal not_eqfalse :<br>  (b = false) = not(b)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(b = false) = not(b)<br><br>[&gt; Line 72: by (case b) <br>[goal&gt; Goal not_eqfalse is proved <br>Exiting proof mode.<br><br><br>Goal eq_false :<br>  ((x = y) = false) = (x &lt;&gt; y)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>((x = y) = false) = (x &lt;&gt; y)<br><br>[&gt; Line 80: (rewrite ...) <br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>((x = y) = false) = not(x = y)<br><br>[&gt; Line 80: ((case (x = y));(intro _)) <br>[goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br>_: x = y<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(true = false) = not(true)<br><br>[&gt; Line 80: simpl <br>[goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br>_: x = y<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>true<br><br>[&gt; Line 80: auto <br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br>_: not(x = y)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(false = false) = not(false)<br><br>[&gt; Line 81: by (rewrite ...) <br>[goal&gt; Goal eq_false is proved <br>Exiting proof mode.<br><br><br>Goal and_true_r :<br>  (b &amp;&amp; true) = b<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(b &amp;&amp; true) = b<br><br>[&gt; Line 94: by (rewrite ... ...) <br>[goal&gt; Goal and_true_r is proved <br>Exiting proof mode.<br><br><br>Goal and_false_r :<br>  (b &amp;&amp; false) = false<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(b &amp;&amp; false) = false<br><br>[&gt; Line 101: by (rewrite ... ...) <br>[goal&gt; Goal and_false_r is proved <br>Exiting proof mode.<br><br><br>Goal or_false_r :<br>  (b || false) = b<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(b || false) = b<br><br>[&gt; Line 112: by (rewrite ... ...) <br>[goal&gt; Goal or_false_r is proved <br>Exiting proof mode.<br><br><br>Goal or_true_r :<br>  (b || true) = true<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(b || true) = true<br><br>[&gt; Line 119: by (rewrite ... ...) <br>[goal&gt; Goal or_true_r is proved <br>Exiting proof mode.<br><br><br>Goal not_and :<br>  not((a &amp;&amp; b)) = (not(a) || not(b))<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not((a &amp;&amp; b)) = (not(a) || not(b))<br><br>[&gt; Line 128: (rewrite ...) <br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not((a &amp;&amp; b)) &lt;=&gt; not(a) || not(b)<br><br>[&gt; Line 129: (((case a);(case b));(intro //=)) <br>[goal&gt; Goal not_and is proved <br>Exiting proof mode.<br><br><br>Goal not_or :<br>  not((a || b)) = (not(a) &amp;&amp; not(b))<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not((a || b)) = (not(a) &amp;&amp; not(b))<br><br>[&gt; Line 134: (rewrite ...) <br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: a,b:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not((a || b)) &lt;=&gt; not(a) &amp;&amp; not(b)<br><br>[&gt; Line 135: (((case a);(case b));(intro //=)) <br>[goal&gt; Goal not_or is proved <br>Exiting proof mode.<br><br><br>Goal if_true :<br>  b =&gt; if b then x else y = x<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b:bool,x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>b =&gt; if b then x else y = x<br><br>[&gt; Line 144: (intro *) <br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b:bool,x,y:'a<br>H: b<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>if b then x else y = x<br><br>[&gt; Line 145: (case <span>if</span> b <span>then</span> x <span>else</span> y) <br>[goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: 'a<br>Variables: b:bool,x,y:'a<br>H: b<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>b &amp;&amp; if b then x else y = x =&gt; x = x<br><br>[&gt; Line 146: auto <br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b:bool,x,y:'a<br>H: b<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not(b) &amp;&amp; if b then x else y = y =&gt; y = x<br><br>[&gt; Line 147: (intro [HH _]) <br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b:bool,x,y:'a<br>H: b<br>HH: not(b)<br>_: if b then x else y = y<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>y = x<br><br>[&gt; Line 147: by (have ... as ) <br>[goal&gt; Goal if_true is proved <br>Exiting proof mode.<br><br><br>Goal if_true0 :<br>  if true then x else y = x<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>if true then x else y = x<br><br>[&gt; Line 153: by (rewrite ...) <br>[goal&gt; Goal if_true0 is proved <br>Exiting proof mode.<br><br><br>Goal if_false :<br>  not(b) =&gt; if b then x else y = y<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b:bool,x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not(b) =&gt; if b then x else y = y<br><br>[&gt; Line 160: ((intro *);(case <span>if</span> b <span>then</span> x <span>else</span> y)) <br>[goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: 'a<br>Variables: b:bool,x,y:'a<br>H: not(b)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>b &amp;&amp; if b then x else y = x =&gt; x = y<br><br>[&gt; Line 161: (intro [HH _]) <br>[goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: 'a<br>Variables: b:bool,x,y:'a<br>H: not(b)<br>HH: b<br>_: if b then x else y = x<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>x = y<br><br>[&gt; Line 161: by (have ... as ) <br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b:bool,x,y:'a<br>H: not(b)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not(b) &amp;&amp; if b then x else y = y =&gt; y = y<br><br>[&gt; Line 162: auto <br>[goal&gt; Goal if_false is proved <br>Exiting proof mode.<br><br><br>Goal if_false0 :<br>  if false then x else y = y<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>if false then x else y = y<br><br>[&gt; Line 168: by (rewrite ...) <br>[goal&gt; Goal if_false0 is proved <br>Exiting proof mode.<br><br><br>Goal if_then_then :<br>  if b then if b' then x else y else y = if (b &amp;&amp; b') then x else y<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b,b':bool,x,y:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>if b then if b' then x else y else y = if (b &amp;&amp; b') then x else y<br><br>[&gt; Line 175: by ((case b);(case b')) <br>[goal&gt; Goal if_then_then is proved <br>Exiting proof mode.<br><br><br>Goal if_then_implies :<br>  if b then if b' then x else y else z =<br>  if b then if (b =&gt; b') then x else y else z<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b,b':bool,x,y,z:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>if b then if b' then x else y else z =<br>if b then if (b =&gt; b') then x else y else z<br><br>[&gt; Line 182: ((case b);<br>             ((intro H);((case b');((intro H');(simpl;(try auto))))))<br><br>[goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: 'a<br>Variables: b,b':bool,x,y,z:'a<br>H: b<br>H': b'<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>x = if (true =&gt; true) then x else y<br><br>[&gt; Line 183: by (rewrite ...) <br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b,b':bool,x,y,z:'a<br>H: b<br>H': not(b')<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>y = if (true =&gt; false) then x else y<br><br>[&gt; Line 184: (rewrite ...) <br>[goal&gt; Focused goal (1/2):<br>System: any<br>Type variables: 'a<br>Variables: b,b':bool,x,y,z:'a<br>H: b<br>H': not(b')<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>not((true =&gt; false))<br><br>[&gt; Line 185: ((intro Habs);by (have ... as )) <br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b,b':bool,x,y,z:'a<br>H: b<br>H': not(b')<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>y = y<br><br>[&gt; Line 186: auto <br>[goal&gt; Goal if_then_implies is proved <br>Exiting proof mode.<br><br><br>Goal if_same :<br>  if b then x else x = x<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b:bool,x:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>if b then x else x = x<br><br>[&gt; Line 192: by (case b) <br>[goal&gt; Goal if_same is proved <br>Exiting proof mode.<br><br><br>Goal if_then :<br>  b = b' =&gt; if b then if b' then x else y else z = if b then x else z<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b,b':bool,x,y,z:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>b = b' =&gt; if b then if b' then x else y else z = if b then x else z<br><br>[&gt; Line 201: by ((intro -&gt;);(case b')) <br>[goal&gt; Goal if_then is proved <br>Exiting proof mode.<br><br><br>Goal if_else :<br>  b = b' =&gt; if b then x else if b' then y else z = if b then x else z<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b,b':bool,x,y,z:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>b = b' =&gt; if b then x else if b' then y else z = if b then x else z<br><br>[&gt; Line 210: by ((intro -&gt;);(case b')) <br>[goal&gt; Goal if_else is proved <br>Exiting proof mode.<br><br><br>Goal if_then_not :<br>  b = not(b') =&gt; if b then if b' then x else y else z = if b then y else z<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b,b':bool,x,y,z:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>b = not(b') =&gt; if b then if b' then x else y else z = if b then y else z<br><br>[&gt; Line 219: by ((intro -&gt;);(case b')) <br>[goal&gt; Goal if_then_not is proved <br>Exiting proof mode.<br><br><br>Goal if_else_not :<br>  b = not(b') =&gt; if b then x else if b' then y else z = if b then x else y<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br>Variables: b,b':bool,x,y,z:'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>b = not(b') =&gt; if b then x else if b' then y else z = if b then x else y<br><br>[&gt; Line 228: by ((intro -&gt;);(case b')) <br>[goal&gt; Goal if_else_not is proved <br>Exiting proof mode.<br><br><br>Goal fst_pair :<br>  <span class="gf" style="font-weight: bold">fst</span>(&lt;x,y&gt;) = x<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,y:message<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gf" style="font-weight: bold">fst</span>(&lt;x,y&gt;) = x<br><br>[&gt; Line 236: auto <br>[goal&gt; Goal fst_pair is proved <br>Exiting proof mode.<br><br><br>Goal snd_pair :<br>  <span class="gf" style="font-weight: bold">snd</span>(&lt;x,y&gt;) = y<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,y:message<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gf" style="font-weight: bold">snd</span>(&lt;x,y&gt;) = y<br><br>[&gt; Line 240: auto <br>[goal&gt; Goal snd_pair is proved <br>Exiting proof mode.<br><br><br>Goal iff_refl :<br>  (x &lt;=&gt; x) = true<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(x &lt;=&gt; x) = true<br><br>[&gt; Line 248: by (rewrite ...) <br>[goal&gt; Goal iff_refl is proved <br>Exiting proof mode.<br><br><br>Goal iff_sym :<br>  (x &lt;=&gt; y) = (y &lt;=&gt; x)<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Variables: x,y:bool<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(x &lt;=&gt; y) = (y &lt;=&gt; x)<br><br>[&gt; Line 254: by (rewrite ...) <br>[goal&gt; Goal iff_sym is proved <br>Exiting proof mode.<br><br><br>Goal true_iff_false :<br>  (true &lt;=&gt; false) = false<br>[goal&gt; Focused goal (1/1):<br>System: any<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(true &lt;=&gt; false) = false<br><br>[&gt; Line 259: by (rewrite ...) <br>[goal&gt; Goal true_iff_false is proved <br>Exiting proof mode.<br><br><br>Goal false_iff_true :<br>  (false &lt;=&gt; true) = false<br>[goal&gt; Focused goal (1/1):<br>System: any<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(false &lt;=&gt; true) = false<br><br>[&gt; Line 265: by (rewrite ...) <br>[goal&gt; Goal false_iff_true is proved <br>Exiting proof mode.<br><br><br>Goal exists_false1 :<br>  (exists (a:'a), false) = false<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(exists (a:'a), false) = false<br><br>[&gt; Line 277: by (rewrite ...) <br>[goal&gt; Goal exists_false1 is proved <br>Exiting proof mode.<br><br><br>Goal exists_false2 :<br>  (exists (a:'a,b:'b), false) = false<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a, 'b<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(exists (a:'a,b:'b), false) = false<br><br>[&gt; Line 281: by (rewrite ...) <br>[goal&gt; Goal exists_false2 is proved <br>Exiting proof mode.<br><br><br>Goal exists_false3 :<br>  (exists (a:'a,b:'b,c:'c), false) = false<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a, 'b, 'c<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(exists (a:'a,b:'b,c:'c), false) = false<br><br>[&gt; Line 285: by (rewrite ...) <br>[goal&gt; Goal exists_false3 is proved <br>Exiting proof mode.<br><br><br>Goal exists_false4 :<br>  (exists (a:'a,b:'b,c:'c,d:'d), false) = false<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a, 'b, 'c, 'd<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(exists (a:'a,b:'b,c:'c,d:'d), false) = false<br><br>[&gt; Line 289: by (rewrite ...) <br>[goal&gt; Goal exists_false4 is proved <br>Exiting proof mode.<br><br><br>Goal exists_false5 :<br>  (exists (a:'a,b:'b,c:'c,d:'d,e:'e), false) = false<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a, 'b, 'c, 'd, 'e<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(exists (a:'a,b:'b,c:'c,d:'d,e:'e), false) = false<br><br>[&gt; Line 293: by (rewrite ...) <br>[goal&gt; Goal exists_false5 is proved <br>Exiting proof mode.<br><br><br>Goal exists_false6 :<br>  (exists (a:'a,b:'b,c:'c,d:'d,e:'e,f:'f), false) = false<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a, 'b, 'c, 'd, 'e, 'f<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(exists (a:'a,b:'b,c:'c,d:'d,e:'e,f:'f), false) = false<br><br>[&gt; Line 297: by (rewrite ...) <br>[goal&gt; Goal exists_false6 is proved <br>Exiting proof mode.<br><br><br>Goal forall_true1 :<br>  (forall (a:'a), true) = true<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(forall (a:'a), true) = true<br><br>[&gt; Line 307: auto <br>[goal&gt; Goal forall_true1 is proved <br>Exiting proof mode.<br><br><br>Goal forall_true2 :<br>  (forall (a:'a,b:'b), true) = true<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a, 'b<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(forall (a:'a,b:'b), true) = true<br><br>[&gt; Line 311: auto <br>[goal&gt; Goal forall_true2 is proved <br>Exiting proof mode.<br><br><br>Goal forall_true3 :<br>  (forall (a:'a,b:'b,c:'c), true) = true<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a, 'b, 'c<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(forall (a:'a,b:'b,c:'c), true) = true<br><br>[&gt; Line 315: auto <br>[goal&gt; Goal forall_true3 is proved <br>Exiting proof mode.<br><br><br>Goal forall_true4 :<br>  (forall (a:'a,b:'b,c:'c,d:'d), true) = true<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a, 'b, 'c, 'd<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(forall (a:'a,b:'b,c:'c,d:'d), true) = true<br><br>[&gt; Line 319: auto <br>[goal&gt; Goal forall_true4 is proved <br>Exiting proof mode.<br><br><br>Goal forall_true5 :<br>  (forall (a:'a,b:'b,c:'c,d:'d,e:'e), true) = true<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a, 'b, 'c, 'd, 'e<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(forall (a:'a,b:'b,c:'c,d:'d,e:'e), true) = true<br><br>[&gt; Line 323: auto <br>[goal&gt; Goal forall_true5 is proved <br>Exiting proof mode.<br><br><br>Goal forall_true6 :<br>  (forall (a:'a,b:'b,c:'c,d:'d,e:'e,f:'f), true) = true<br>[goal&gt; Focused goal (1/1):<br>System: any<br>Type variables: 'a, 'b, 'c, 'd, 'e, 'f<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(forall (a:'a,b:'b,c:'c,d:'d,e:'e,f:'f), true) = true<br><br>[&gt; Line 327: auto <br>[goal&gt; Goal forall_true6 is proved <br>Exiting proof mode.<br><br><br>[warning&gt; loaded: Basic.sp  &lt;]<br></span>
<span class="com-line" id="com10"><h4 id="libraries">LIBRARIES</h4>
<p>We include here some libraries, useful to help the tool with automated reasoning.</p>
</span>
</span>

<span class="squirrel-step" id="step11">
<span class="input-line" id="in11"><br><br>goal dec_enc (x,y,z:message) : dec(enc(x,z,y),y) = x.</span>
<span class="output-line" id="out11">Goal dec_enc :<br>  <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">enc</span>(x,z,y),y) = x<br></span>
</span>

<span class="squirrel-step" id="step12">
<span class="input-line" id="in12"><br>Proof.</span>
<span class="output-line" id="out12">[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: x,y,z:message<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">enc</span>(x,z,y),y) = x<br><br></span>
</span>

<span class="squirrel-step" id="step13">
<span class="input-line" id="in13"> auto.</span>
<span class="output-line" id="out13">[&gt; Line 140: auto <br>[goal&gt; Goal dec_enc is proved <br></span>
</span>

<span class="squirrel-step" id="step14">
<span class="input-line" id="in14"> Qed.</span>
<span class="output-line" id="out14">Exiting proof mode.<br><br><br></span>
</span>

<span class="squirrel-step" id="step15">
<span class="input-line" id="in15"><br>hint rewrite dec_enc.</span>
<span class="output-line" id="out15"></span>
</span>

<span class="squirrel-step" id="step16">
<span class="input-line" id="in16"><br><br>goal fst_apply (x,y : message) : x = y =&gt; fst(x) = fst(y).</span>
<span class="output-line" id="out16">Goal fst_apply :<br>  x = y =&gt; <span class="gf" style="font-weight: bold">fst</span>(x) = <span class="gf" style="font-weight: bold">fst</span>(y)<br></span>
</span>

<span class="squirrel-step" id="step17">
<span class="input-line" id="in17"><br>Proof.</span>
<span class="output-line" id="out17">[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: x,y:message<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>x = y =&gt; <span class="gf" style="font-weight: bold">fst</span>(x) = <span class="gf" style="font-weight: bold">fst</span>(y)<br><br></span>
</span>

<span class="squirrel-step" id="step18">
<span class="input-line" id="in18"> auto.</span>
<span class="output-line" id="out18">[&gt; Line 144: auto <br>[goal&gt; Goal fst_apply is proved <br></span>
</span>

<span class="squirrel-step" id="step19">
<span class="input-line" id="in19"> Qed.</span>
<span class="output-line" id="out19">Exiting proof mode.<br><br><br></span>
</span>

<span class="squirrel-step" id="step20">
<span class="input-line" id="in20"><br><br>goal snd_apply (x,y : message) : x = y =&gt; snd(x) = snd(y).</span>
<span class="output-line" id="out20">Goal snd_apply :<br>  x = y =&gt; <span class="gf" style="font-weight: bold">snd</span>(x) = <span class="gf" style="font-weight: bold">snd</span>(y)<br></span>
</span>

<span class="squirrel-step" id="step21">
<span class="input-line" id="in21"><br>Proof.</span>
<span class="output-line" id="out21">[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: x,y:message<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>x = y =&gt; <span class="gf" style="font-weight: bold">snd</span>(x) = <span class="gf" style="font-weight: bold">snd</span>(y)<br><br></span>
</span>

<span class="squirrel-step" id="step22">
<span class="input-line" id="in22"> auto.</span>
<span class="output-line" id="out22">[&gt; Line 147: auto <br>[goal&gt; Goal snd_apply is proved <br></span>
</span>

<span class="squirrel-step" id="step23">
<span class="input-line" id="in23"> Qed.</span>
<span class="output-line" id="out23">Exiting proof mode.<br><br><br></span>
</span>

<span class="squirrel-step" id="step24">
<span class="input-line" id="in24"><br><br>goal dec_apply (x,y,x1,y1 : message) :<br> x = y =&gt; x1 = y1 =&gt; dec(x,x1) = dec(y,y1).</span>
<span class="output-line" id="out24">Goal dec_apply :<br>  x = y =&gt; x1 = y1 =&gt; <span class="gf" style="font-weight: bold">dec</span>(x,x1) = <span class="gf" style="font-weight: bold">dec</span>(y,y1)<br></span>
</span>

<span class="squirrel-step" id="step25">
<span class="input-line" id="in25"><br>Proof.</span>
<span class="output-line" id="out25">[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: x,x1,y,y1:message<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>x = y =&gt; x1 = y1 =&gt; <span class="gf" style="font-weight: bold">dec</span>(x,x1) = <span class="gf" style="font-weight: bold">dec</span>(y,y1)<br><br></span>
</span>

<span class="squirrel-step" id="step26">
<span class="input-line" id="in26"> auto.</span>
<span class="output-line" id="out26">[&gt; Line 151: auto <br>[goal&gt; Goal dec_apply is proved <br></span>
</span>

<span class="squirrel-step" id="step27">
<span class="input-line" id="in27"> Qed.</span>
<span class="output-line" id="out27">Exiting proof mode.<br><br><br></span>
</span>

<span class="squirrel-step" id="step28">
<span class="input-line" id="in28">axiom orderTrans (n1,n2,n3:message):<br>  n1 ~&lt; n2 = orderOk =&gt; n2 ~&lt; n3 = orderOk =&gt; n1 ~&lt; n3 = orderOk.</span>
<span class="output-line" id="out28"></span>
<span class="com-line" id="com28"><h4 id="axioms">AXIOMS</h4>
<p>The following axioms are used to reason on counter values.</p>
</span>
</span>

<span class="squirrel-step" id="step29">
<span class="input-line" id="in29"><br><br>axiom orderStrict (n1,n2:message):<br>  n1 = n2 =&gt; n1 ~&lt; n2 &lt;&gt; orderOk.</span>
<span class="output-line" id="out29"></span>
</span>

<span class="squirrel-step" id="step30">
<span class="input-line" id="in30"><br><br>axiom orderSucc (n1,n2:message):<br>  n1 = n2 =&gt; n1 ~&lt; mySucc(n2) = orderOk.</span>
<span class="output-line" id="out30"></span>
</span>

<span class="squirrel-step" id="step31">
<span class="input-line" id="in31">goal counterIncreaseStrictly (ii,i:index):<br>  happens(S(ii,i)) =&gt;<br>    cond@S(ii,i) =&gt;<br>      SCpt(i)@pred(S(ii,i)) ~&lt; SCpt(i)@S(ii,i) = orderOk.</span>
<span class="output-line" id="out31">Goal counterIncreaseStrictly :<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) =&gt;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br></span>
<span class="com-line" id="com31"><h4 id="helping-lemmas">HELPING LEMMAS</h4>
<p>We now prove some properties on the counter on the server side, used later in the proofs of the security properties.</p>
<hr />
<p>The counter <code>SCpt(i)</code> strictly increases at each action <code>S</code> performed by the server with tag <code>i</code>.</p>
</span>
</span>

<span class="squirrel-step" id="step32">
<span class="input-line" id="in32">Proof.</span>
<span class="output-line" id="out32">[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii:index<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) =&gt;<br><span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br><br></span>
<span class="com-line" id="com32"><p>The proof is automatically done by Squirrel.</p>
</span>
</span>

<span class="squirrel-step" id="step33">
<span class="input-line" id="in33"> auto.</span>
<span class="output-line" id="out33">[&gt; Line 180: auto <br>[goal&gt; Goal counterIncreaseStrictly is proved <br></span>
</span>

<span class="squirrel-step" id="step34">
<span class="input-line" id="in34"> Qed.</span>
<span class="output-line" id="out34">Exiting proof mode.<br><br><br></span>
</span>

<span class="squirrel-step" id="step35">
<span class="input-line" id="in35">goal counterIncrease (t:timestamp, i : index) :<br>  happens(t) =&gt;<br>    (t &gt; init &amp;&amp; exec@t) =&gt;<br>      (SCpt(i)@pred(t) ~&lt; SCpt(i)@t = orderOk) ||<br>       SCpt(i)@t = SCpt(i)@pred(t).</span>
<span class="output-line" id="out35">Goal counterIncrease :<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t) =&gt;<br>  t &gt; <span class="ga" style="color: #00AA00">init</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t =&gt;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t)<br></span>
<span class="com-line" id="com35"><p>The counter <code>SCpt(i)</code> increases (not strictly) between <code>pred(t)</code> and <code>t</code>.</p>
</span>
</span>

<span class="squirrel-step" id="step36">
<span class="input-line" id="in36"><br>Proof.</span>
<span class="output-line" id="out36">[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i:index,t:timestamp<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t) =&gt;<br>t &gt; <span class="ga" style="color: #00AA00">init</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t =&gt;<br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t)<br><br></span>
</span>

<span class="squirrel-step" id="step37">
<span class="input-line" id="in37">  intro Hap [Ht Hexec].</span>
<span class="output-line" id="out37">[&gt; Line 195: (intro Hap [Ht Hexec]) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i:index,t:timestamp<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Ht: t &gt; <span class="ga" style="color: #00AA00">init</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t)<br><br></span>
<span class="com-line" id="com37"><p>After having introduced the hypotheses, we perform a case analysis on all possible values that the timestamp <code>t</code> can take. Most cases are trivial and automatically handled by Squirrel (<code>=&gt; //</code>) because most actions do not update <code>SCpt(i)</code> so we automatically have that <code>SCpt(i)@t = SCpt(i)@pred(t)</code>.</p>
</span>
</span>

<span class="squirrel-step" id="step38">
<span class="input-line" id="in38"><br>  case t =&gt; //.</span>
<span class="output-line" id="out38">[&gt; Line 196: ((case t);(intro //)) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i:index,t:timestamp<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Ht: t &gt; <span class="ga" style="color: #00AA00">init</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(exists (ii,i0:index), t = <span class="ga" style="color: #00AA00">S(ii,i0)</span>) =&gt;<br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t)<br><br></span>
</span>

<span class="squirrel-step" id="step39">
<span class="input-line" id="in39">  intro [ii i0 _].</span>
<span class="output-line" id="out39">[&gt; Line 202: (intro [ii i0 _]) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,i0,ii:index,t:timestamp<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Ht: t &gt; <span class="ga" style="color: #00AA00">init</span><br>_: t = <span class="ga" style="color: #00AA00">S(ii,i0)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t)<br><br></span>
<span class="com-line" id="com39"><p>Case where t = S(ii,i0): This is the interesting case, where <code>t</code> is an action that updates the mutable cell <code>SCpt(i0)</code>. We distinguish two cases: <code>i = i0</code> and <code>i &lt;&gt; i0</code>.</p>
</span>
</span>

<span class="squirrel-step" id="step40">
<span class="input-line" id="in40"><br>  case (i = i0) =&gt; _.</span>
<span class="output-line" id="out40">[&gt; Line 203: ((case (i = i0));(intro _)) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: i,ii:index,t:timestamp<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Ht: t &gt; <span class="ga" style="color: #00AA00">init</span><br>_: t = <span class="ga" style="color: #00AA00">S(ii,i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t)<br><br></span>
</span>

<span class="squirrel-step" id="step41">
<span class="input-line" id="in41">    + by left.</span>
<span class="output-line" id="out41">[&gt; Line 207: by left <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,i0,ii:index,t:timestamp<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Ht: t &gt; <span class="ga" style="color: #00AA00">init</span><br>_: not(i = i0)<br>_: t = <span class="ga" style="color: #00AA00">S(ii,i0)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t)<br><br></span>
<span class="com-line" id="com41"><p>The case <code>i = i0</code> corresponds to the left disjunct, which is a direct consequence of the condition of the action <code>SCpt(i)</code>. This is done automatically by Squirrel.</p>
</span>
</span>

<span class="squirrel-step" id="step42">
<span class="input-line" id="in42">    + right.</span>
<span class="output-line" id="out42">[&gt; Line 213: right <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,i0,ii:index,t:timestamp<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Ht: t &gt; <span class="ga" style="color: #00AA00">init</span><br>_: not(i = i0)<br>_: t = <span class="ga" style="color: #00AA00">S(ii,i0)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t)<br><br></span>
<span class="com-line" id="com42"><p>The case <code>i &lt;&gt; i0</code> corresponds to the right disjunct. When expanding the macro <code>SCpt(i)@t</code>, we notice that it is an <code>if _ then _ else _</code> term with a condition that is always false. This can be simplified using the <code>rewrite</code> tactic with lemma <code>if_false</code> (which is included in the <code>Basic</code> library.</p>
</span>
</span>

<span class="squirrel-step" id="step43">
<span class="input-line" id="in43"><br>      expand SCpt(i)@t.</span>
<span class="output-line" id="out43">[&gt; Line 214: (expand SCpt(i)@t) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,i0,ii:index,t:timestamp<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Ht: t &gt; <span class="ga" style="color: #00AA00">init</span><br>_: t = <span class="ga" style="color: #00AA00">S(ii,i0)</span><br>_: not(i = i0)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>if (i = i0) then <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@t)),<span class="gn" style="color: #AA5500">k</span>(i0))) else <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t) =<br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t)<br><br></span>
</span>

<span class="squirrel-step" id="step44">
<span class="input-line" id="in44"> by rewrite if_false.</span>
<span class="output-line" id="out44">[&gt; Line 214: by (rewrite ...) <br>[goal&gt; Goal counterIncrease is proved <br></span>
</span>

<span class="squirrel-step" id="step45">
<span class="input-line" id="in45">Qed.</span>
<span class="output-line" id="out45">Exiting proof mode.<br><br><br></span>
<span class="com-line" id="com45"><p>The two previous tactics can be merged into a single one: by rewrite /SCpt if_false.</p>
</span>
</span>

<span class="squirrel-step" id="step46">
<span class="input-line" id="in46">goal counterIncreaseBis:<br>  forall (t:timestamp), forall (t':timestamp), forall (i:index),<br>    happens(t) =&gt;<br>      exec@t &amp;&amp; t' &lt; t =&gt;<br>        (SCpt(i)@t' ~&lt; SCpt(i)@t = orderOk || SCpt(i)@t = SCpt(i)@t').</span>
<span class="output-line" id="out46">Goal counterIncreaseBis :<br>  forall (t,t':timestamp,i:index),<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t) =&gt;<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t &amp;&amp; t' &lt; t =&gt;<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br></span>
<span class="com-line" id="com46"><p>The counter <code>SCpt(i)</code> increases (not strictly) between <code>t'</code> and <code>t</code> when <code>t' &lt; t</code>.</p>
</span>
</span>

<span class="squirrel-step" id="step47">
<span class="input-line" id="in47">Proof.</span>
<span class="output-line" id="out47">[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>forall (t,t':timestamp,i:index),<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t) =&gt;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t &amp;&amp; t' &lt; t =&gt;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><br></span>
<span class="com-line" id="com47"><p>This proof is done by induction, relying on the previous <code>counterIncrease</code> lemma to prove the induction step.</p>
</span>
</span>

<span class="squirrel-step" id="step48">
<span class="input-line" id="in48"><br>  induction.</span>
<span class="output-line" id="out48">[&gt; Line 229: induction <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>forall (t:timestamp),<br>  (forall (t0,t':timestamp,i:index),<br>     t0 &lt; t =&gt;<br>     <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;<br>     <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0 =&gt;<br>     <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t') =&gt;<br>  forall (t':timestamp,i:index),<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t) =&gt;<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t &amp;&amp; t' &lt; t =&gt;<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><br></span>
</span>

<span class="squirrel-step" id="step49">
<span class="input-line" id="in49"><br>  intro t IH0 t' i Hap [Hexec Ht'].</span>
<span class="output-line" id="out49">[&gt; Line 230: (intro t IH0 t' i Hap [Hexec Ht']) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i:index,t,t':timestamp<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Ht': t' &lt; t<br>IH0: forall (t0,t':timestamp,i:index),<br>       t0 &lt; t =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0 =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><br></span>
</span>

<span class="squirrel-step" id="step50">
<span class="input-line" id="in50">  assert (t' = pred(t) || t' &lt; pred(t)) as H0;<br>    1: constraints.</span>
<span class="output-line" id="out50">[&gt; Line 235: ((have ((t' = pred(t)) || (t' &lt; pred(t))), H0); 1: constraints) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i:index,t,t':timestamp<br>H0: t' = <span class="gf" style="font-weight: bold">pred</span>(t) || t' &lt; <span class="gf" style="font-weight: bold">pred</span>(t)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Ht': t' &lt; t<br>IH0: forall (t0,t':timestamp,i:index),<br>       t0 &lt; t =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0 =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><br></span>
<span class="com-line" id="com50"><p>We introduce a case disjunction <code>t'</code>. Since we already have that <code>t' &lt; t</code> then the <code>constraints</code> tactic allows to close the goal showing that <code>(t' = pred(t) || t' &lt; pred(t))</code> is indeed satisfied.</p>
</span>
</span>

<span class="squirrel-step" id="step51">
<span class="input-line" id="in51"><br>  case H0.</span>
<span class="output-line" id="out51">[&gt; Line 236: (case H0) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: i:index,t,t':timestamp<br>H0: t' = <span class="gf" style="font-weight: bold">pred</span>(t)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Ht': t' &lt; t<br>IH0: forall (t0,t':timestamp,i:index),<br>       t0 &lt; t =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0 =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><br></span>
</span>

<span class="squirrel-step" id="step52">
<span class="input-line" id="in52">  + rewrite !H0.</span>
<span class="output-line" id="out52">[&gt; Line 243: (rewrite ...) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: i:index,t,t':timestamp<br>H0: t' = <span class="gf" style="font-weight: bold">pred</span>(t)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Ht': t' &lt; t<br>IH0: forall (t0,t':timestamp,i:index),<br>       t0 &lt; t =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0 =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t)<br><br></span>
<span class="com-line" id="com52"><p><strong>Case t’ = pred(t).</strong> We first rewrite the conclusion using the equality in H0. The <code>!</code> mark is here to indicate that the rewriting must be done as much as possible and at least once. Then, it is a direct consequence of the <code>counterIncrease</code> lemma.</p>
</span>
</span>

<span class="squirrel-step" id="step53">
<span class="input-line" id="in53"><br>    by apply counterIncrease.</span>
<span class="output-line" id="out53">[&gt; Line 244: by (apply ... ) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i:index,t,t':timestamp<br>H0: t' &lt; <span class="gf" style="font-weight: bold">pred</span>(t)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Ht': t' &lt; t<br>IH0: forall (t0,t':timestamp,i:index),<br>       t0 &lt; t =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0 =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><br></span>
</span>

<span class="squirrel-step" id="step54">
<span class="input-line" id="in54">  + use IH0 with pred(t),t',i as H1 =&gt; //.</span>
<span class="output-line" id="out54">[&gt; Line 253: ((have ... as H1);(intro //)) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: i:index,t,t':timestamp<br>H0: t' &lt; <span class="gf" style="font-weight: bold">pred</span>(t)<br>H1: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t) = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Ht': t' &lt; t<br>IH0: forall (t0,t':timestamp,i:index),<br>       t0 &lt; t =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0 =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><br></span>
<span class="com-line" id="com54"><p><strong>Case t’ &lt; pred(t).</strong> We first apply the induction hypothesis with <code>t' &lt; pred(t)</code> to obtain a relation between <code>SCpt(i)@t'</code> and <code>SCpt(i)@pred(t)</code>. We then use the <code>counterIncrease</code> lemma, this time to obtain a relation between <code>SCpt(i)@pred(t)</code> and <code>SCpt(i)@t</code>. We will then be able to conclude by transitivity.</p>
</span>
</span>

<span class="squirrel-step" id="step55">
<span class="input-line" id="in55"><br>      - use counterIncrease with t,i as H3 =&gt; //.</span>
<span class="output-line" id="out55">[&gt; Line 254: ((have ... as H3);(intro //)) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: i:index,t,t':timestamp<br>H0: t' &lt; <span class="gf" style="font-weight: bold">pred</span>(t)<br>H1: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t) = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br>H3: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Ht': t' &lt; t<br>IH0: forall (t0,t':timestamp,i:index),<br>       t0 &lt; t =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0 =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><br></span>
</span>

<span class="squirrel-step" id="step56">
<span class="input-line" id="in56"><br>        case H1 =&gt; //.</span>
<span class="output-line" id="out56">[&gt; Line 255: ((case H1);(intro //)) <br>[goal&gt; Focused goal (1/3):<br>System: left:default/left, right:default/right<br>Variables: i:index,t,t':timestamp<br>H0: t' &lt; <span class="gf" style="font-weight: bold">pred</span>(t)<br>H1: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t) = <span class="gf" style="font-weight: bold">orderOk</span><br>H3: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Ht': t' &lt; t<br>IH0: forall (t0,t':timestamp,i:index),<br>       t0 &lt; t =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0 =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><br></span>
</span>

<span class="squirrel-step" id="step57">
<span class="input-line" id="in57"><br>        * (* case H1 - 1/2 *)<br>          case H3 =&gt; //.</span>
<span class="output-line" id="out57">[&gt; Line 257: ((case H3);(intro //)) <br>[goal&gt; Focused goal (1/3):<br>System: left:default/left, right:default/right<br>Variables: i:index,t,t':timestamp<br>H0: t' &lt; <span class="gf" style="font-weight: bold">pred</span>(t)<br>H1: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t) = <span class="gf" style="font-weight: bold">orderOk</span><br>H3: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Ht': t' &lt; t<br>IH0: forall (t0,t':timestamp,i:index),<br>       t0 &lt; t =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0 =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><br></span>
</span>

<span class="squirrel-step" id="step58">
<span class="input-line" id="in58"><br>          by left; apply orderTrans _ (SCpt(i)@pred(t)) _.</span>
<span class="output-line" id="out58">[&gt; Line 258: by (left;(apply ... )) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: i:index,t,t':timestamp<br>H0: t' &lt; <span class="gf" style="font-weight: bold">pred</span>(t)<br>H1: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t) = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br>H3: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(t)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Ht': t' &lt; t<br>IH0: forall (t0,t':timestamp,i:index),<br>       t0 &lt; t =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0 =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><br></span>
</span>

<span class="squirrel-step" id="step59">
<span class="input-line" id="in59"><br>        * (* case H1 - 2/2 *)<br>          by case H3; [1: left | 2 : right].</span>
<span class="output-line" id="out59">[&gt; Line 260: by ((case H3); [1: left|2: right]) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i:index,t,t':timestamp<br>H0: t' &lt; <span class="gf" style="font-weight: bold">pred</span>(t)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Ht': t' &lt; t<br>IH0: forall (t0,t':timestamp,i:index),<br>       t0 &lt; t =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0 =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(t) &amp;&amp; t' &lt; <span class="gf" style="font-weight: bold">pred</span>(t)<br><br></span>
</span>

<span class="squirrel-step" id="step60">
<span class="input-line" id="in60">     - simpl.</span>
<span class="output-line" id="out60">[&gt; Line 263: simpl <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i:index,t,t':timestamp<br>H0: t' &lt; <span class="gf" style="font-weight: bold">pred</span>(t)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Ht': t' &lt; t<br>IH0: forall (t0,t':timestamp,i:index),<br>       t0 &lt; t =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0 =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(t)<br><br></span>
<span class="com-line" id="com60"><p>It remains to show that the premises of the induction hypothesis IH0 were satisfied, relying on the fact that <code>exec@t =&gt; exec@pred(t)</code>.</p>
</span>
</span>

<span class="squirrel-step" id="step61">
<span class="input-line" id="in61"><br>       executable t =&gt; // H1.</span>
<span class="output-line" id="out61">[&gt; Line 264: ((executable t);(intro // H1)) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i:index,t,t':timestamp<br>H0: t' &lt; <span class="gf" style="font-weight: bold">pred</span>(t)<br>H1: forall (t0:timestamp), t0 &lt;= t =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Ht': t' &lt; t<br>IH0: forall (t0,t':timestamp,i:index),<br>       t0 &lt; t =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0 =&gt;<br>       <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(t)<br><br></span>
</span>

<span class="squirrel-step" id="step62">
<span class="input-line" id="in62"><br>       by apply H1.</span>
<span class="output-line" id="out62">[&gt; Line 265: by (apply ... ) <br>[goal&gt; Goal counterIncreaseBis is proved <br></span>
</span>

<span class="squirrel-step" id="step63">
<span class="input-line" id="in63"><br>Qed.</span>
<span class="output-line" id="out63">Exiting proof mode.<br><br><br></span>
</span>

<span class="squirrel-step" id="step64">
<span class="input-line" id="in64">goal noreplayInv (ii, ii1, i:index):<br>  happens(S(ii1,i),S(ii,i)) =&gt;<br>  exec@S(ii1,i) &amp;&amp; S(ii,i) &lt; S(ii1,i) =&gt;<br>  SCpt(i)@S(ii,i) ~&lt; SCpt(i)@S(ii1,i) = orderOk.</span>
<span class="output-line" id="out64">Goal noreplayInv :<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br></span>
<span class="com-line" id="com64"><h4 id="security-properties">SECURITY PROPERTIES</h4>
<p>We now state and prove the 3 following security properties:</p>
<ul>
<li>Property 1: absence of replay attacks.</li>
<li>Property 2: injective correspondence.</li>
<li>Property 3: monotonicity.</li>
</ul>
<hr />
<h4 id="property-1-absence-of-replay-attacks">Property 1: absence of replay attacks</h4>
<p>This property states that the server never accepts for the same YubiKey the same counter twice, <em>i.e.</em> if the trace is executable up until <code>S(ii1,i)</code>, then there cannot exist a previous action <code>S(ii,i)</code> in the trace such that <code>ii &lt;&gt; ii1</code> and <code>SCpt(i)@S(ii,i) = SCpt(i)@S(ii1,i)</code>.</p>
<p>Note that proving this property does not rely on any assumption on cryptographic primitives: it relies only on reasonings about counter values.</p>
<p>We start by proving an invariant (<code>noreplayInv</code>) that will be useful in the main proof. This intermediate lemma states that whenever the server accepts for a given YubiKey (represented by the index <code>i</code>), the counter value must have increased compared to the last time the server accepted for this YubiKey.</p>
</span>
</span>

<span class="squirrel-step" id="step65">
<span class="input-line" id="in65">Proof.</span>
<span class="output-line" id="out65">[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii1:index<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;<br><span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt;<br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br><br></span>
<span class="com-line" id="com65"><p>The proof relies on the previous helping lemmas reasoning on counter values.</p>
</span>
</span>

<span class="squirrel-step" id="step66">
<span class="input-line" id="in66"><br>  intro Hap [Hexec Ht].</span>
<span class="output-line" id="out66">[&gt; Line 304: (intro Hap [Hexec Ht]) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii1:index<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br><br></span>
</span>

<span class="squirrel-step" id="step67">
<span class="input-line" id="in67"><br>  assert (S(ii,i) = pred(S(ii1,i)) || S(ii,i) &lt; pred(S(ii1,i))) as H1;<br>    1: constraints.</span>
<span class="output-line" id="out67">[&gt; Line 306: ((have<br>              ((S(ii,i) = pred(S(ii1,i))) || (S(ii,i) &lt; pred(S(ii1,i)))), H1);<br>             1: constraints)<br><br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii1:index<br>H1: <span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) || <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br><br></span>
</span>

<span class="squirrel-step" id="step68">
<span class="input-line" id="in68"><br>  case H1.</span>
<span class="output-line" id="out68">[&gt; Line 307: (case H1) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii1:index<br>H1: <span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br><br></span>
</span>

<span class="squirrel-step" id="step69">
<span class="input-line" id="in69"><br>    + (* Case S(ii,i) = pred(S(ii1,i)).</span>
<span class="output-line" id="out69">[&gt; Line 309: by (have ... as M0) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii1:index<br>H1: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br><br></span>
</span>

<span class="squirrel-step" id="step70">
<span class="input-line" id="in70"> *)<br>      by use counterIncreaseStrictly with ii1, i as M0.</span>
<span class="output-line" id="out70">[&gt; Line 312: ((have ... as H2);(intro //)) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii1:index<br>H1: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>H2: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span> ||<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br><br></span>
</span>

<span class="squirrel-step" id="step71">
<span class="input-line" id="in71"><br><br>    + (* Case S(ii,i) &lt; pred(S(ii1,i)).</span>
<span class="output-line" id="out71">[&gt; Line 313: ((case H2);(intro //)) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii1:index<br>H1: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>H2: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br><br></span>
</span>

<span class="squirrel-step" id="step72">
<span class="input-line" id="in72"> *)<br>      use counterIncreaseBis with pred(S(ii1,i)),S(ii,i),i as H2 =&gt; //.</span>
<span class="output-line" id="out72">[&gt; Line 314: by (apply ... ) <br>[goal&gt; Goal noreplayInv is proved <br></span>
</span>

<span class="squirrel-step" id="step73">
<span class="input-line" id="in73"><br>      case H2 =&gt; //.</span>
<span class="output-line" id="out73">Exiting proof mode.<br><br><br></span>
</span>

<span class="squirrel-step" id="step74">
<span class="input-line" id="in74"><br>      by apply orderTrans _ (SCpt(i)@pred(S(ii1,i))) _.</span>
<span class="output-line" id="out74">Goal noreplay :<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt;= <span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt;<br>  ii = ii1<br></span>
</span>

<span class="squirrel-step" id="step75">
<span class="input-line" id="in75"><br>Qed.</span>
<span class="output-line" id="out75">[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii1:index<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;<br><span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt;= <span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt;<br>ii = ii1<br><br></span>
</span>

<span class="squirrel-step" id="step76">
<span class="input-line" id="in76"><br><br>goal noreplay (ii, ii1, i:index):<br>  happens(S(ii1,i)) =&gt;<br>    exec@S(ii1,i) &amp;&amp; S(ii,i) &lt;= S(ii1,i) &amp;&amp; SCpt(i)@S(ii,i) = SCpt(i)@S(ii1,i) =&gt;<br>      ii = ii1.</span>
<span class="output-line" id="out76">[&gt; Line 322: (intro Hap [Hexec Ht Meq]) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii1:index<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt;= <span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii = ii1<br><br></span>
</span>

<span class="squirrel-step" id="step77">
<span class="input-line" id="in77"><br>Proof.</span>
<span class="output-line" id="out77">[&gt; Line 324: ((have ((S(ii,i) = S(ii1,i)) || (S(ii,i) &lt; S(ii1,i))), H1);<br>             1: constraints)<br><br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii1:index<br>H1: <span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="ga" style="color: #00AA00">S(ii1,i)</span> || <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt;= <span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii = ii1<br><br></span>
</span>

<span class="squirrel-step" id="step78">
<span class="input-line" id="in78"><br>  intro Hap [Hexec Ht Meq].</span>
<span class="output-line" id="out78">[&gt; Line 329: ((case H1);(intro //)) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii1:index<br>H1: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt;= <span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii = ii1<br><br></span>
</span>

<span class="squirrel-step" id="step79">
<span class="input-line" id="in79"><br>  assert (S(ii,i) = S(ii1,i) || S(ii,i) &lt; S(ii1,i)) as H1;<br>    1: constraints.</span>
<span class="output-line" id="out79">[&gt; Line 330: ((have ... as M1);(intro //)) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii1:index<br>H1: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt;= <span class="ga" style="color: #00AA00">S(ii1,i)</span><br>M1: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii = ii1<br><br></span>
</span>

<span class="squirrel-step" id="step80">
<span class="input-line" id="in80">  case H1 =&gt; //.</span>
<span class="output-line" id="out80">[&gt; Line 331: by (apply ...  in Meq) <br>[goal&gt; Goal noreplay is proved <br></span>
<span class="com-line" id="com80"><p>The case where <code>S(ii,i) = S(ii1,i)</code> is trivial and automatically handled by Squirrel. For the case where <code>S(ii,i) &lt; S(ii1,i)</code>, we use the invariant to show that there is a contradiction with the hypothesis Meq.</p>
</span>
</span>

<span class="squirrel-step" id="step81">
<span class="input-line" id="in81"><br>  use noreplayInv with ii, ii1, i as M1 =&gt; //.</span>
<span class="output-line" id="out81">Exiting proof mode.<br><br><br></span>
</span>

<span class="squirrel-step" id="step82">
<span class="input-line" id="in82"><br>  by apply orderStrict in Meq.</span>
<span class="output-line" id="out82">Goal injective_correspondence :<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) =&gt;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt;<br>  exists (j:index),<br>    <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br>    forall (ii1:index),<br>      <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;<br>      <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii<br></span>
</span>

<span class="squirrel-step" id="step83">
<span class="input-line" id="in83"><br>Qed.</span>
<span class="output-line" id="out83">[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii:index<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) =&gt;<br><span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt;<br>exists (j:index),<br>  <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br>  forall (ii1:index),<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii<br><br></span>
</span>

<span class="squirrel-step" id="step84">
<span class="input-line" id="in84">goal injective_correspondence (ii,i:index):<br>  happens(S(ii,i)) =&gt;<br>  exec@S(ii,i) =&gt;<br>  exists (j:index),<br>    Press(i,j) &lt; S(ii,i) &amp;&amp; cpt(i,j)@Press(i,j) = SCpt(i)@S(ii,i) &amp;&amp; <br>    forall (ii1:index), <br>      happens(S(ii1,i)) =&gt; <br>      exec@S(ii1,i) =&gt;<br>      cpt(i,j)@Press(i,j) = SCpt(i)@S(ii1,i) =&gt; <br>      ii1 = ii.</span>
<span class="output-line" id="out84">[&gt; Line 364: (intro Hap Hexec) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii:index<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>exists (j:index),<br>  <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br>  forall (ii1:index),<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii<br><br></span>
<span class="com-line" id="com84"><h4 id="property-2-injective-correspondence">Property 2: injective correspondence</h4>
<p>This property states that a successful login for the YubiKey <code>pid(i)</code> (<em>i.e.</em> the execution of action <code>S(ii,i)</code>) must have been preceded by a button press on this YubiKey for the same counter value (<code>P(i,j)</code> with <code>cpt(i,j)@Press(i,j) = SCpt(i)@S(ii,i)</code>), and this counter value is not involved in another successful login.</p>
<p>Proving this property requires to reason on counter values, but also requires the use of the INT-CTXT cryptographic assumption.</p>
</span>
</span>

<span class="squirrel-step" id="step85">
<span class="input-line" id="in85">Proof.</span>
<span class="output-line" id="out85">[&gt; Line 365: ((executable S(ii,i));(intro //)) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii:index<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>(forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t) =&gt;<br>exists (j:index),<br>  <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br>  forall (ii1:index),<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii<br><br></span>
<span class="com-line" id="com85"><p>The high-level idea of this proof is to use the INT-CTXT assumption: if the message received by the server is a valid ciphertext, then it must be equal to an encryption that took place before.</p>
<p>Since the action <code>Press(i,j)</code> is the only one that outputs an encryption, we thus have the existence of such an action before in the trace. Then, the unicity is proved using lemmas on counter values.</p>
</span>
</span>

<span class="squirrel-step" id="step86">
<span class="input-line" id="in86"><br>  intro Hap Hexec.</span>
<span class="output-line" id="out86">[&gt; Line 366: (intro Hexec') <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii:index<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>exists (j:index),<br>  <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br>  forall (ii1:index),<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii<br><br></span>
</span>

<span class="squirrel-step" id="step87">
<span class="input-line" id="in87"><br>  executable S(ii,i) =&gt; //.</span>
<span class="output-line" id="out87">[&gt; Line 367: (rewrite ... ... in Hexec) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii:index<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) &amp;&amp;<br>       (<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span> &amp;&amp;<br>        <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>        <span class="gf" style="font-weight: bold">orderOk</span>) &amp;&amp;<br>       <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>exists (j:index),<br>  <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br>  forall (ii1:index),<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii<br><br></span>
</span>

<span class="squirrel-step" id="step88">
<span class="input-line" id="in88"><br>  intro Hexec'.</span>
<span class="output-line" id="out88">[&gt; Line 368: (destruct Hexec, [Hexecpred [Mneq Hcpt] Hpid]) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii:index<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>exists (j:index),<br>  <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br>  forall (ii1:index),<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii<br><br></span>
</span>

<span class="squirrel-step" id="step89">
<span class="input-line" id="in89"> <br>  rewrite /exec /cond in Hexec.</span>
<span class="output-line" id="out89">[&gt; Line 371: ((intctxt Mneq);(intro //)) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,j:index<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt;<br><span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)) =&gt;<br>i = i =&gt;<br>exists (j:index),<br>  <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br>  forall (ii1:index),<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii<br><br></span>
</span>

<span class="squirrel-step" id="step90">
<span class="input-line" id="in90"><br>  destruct Hexec as [Hexecpred [Mneq Hcpt] Hpid].</span>
<span class="output-line" id="out90">[&gt; Line 372: (intro Ht M1 *) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,j:index<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>exists (j:index),<br>  <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br>  forall (ii1:index),<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii<br><br></span>
</span>

<span class="squirrel-step" id="step91">
<span class="input-line" id="in91">  intctxt Mneq =&gt; //.</span>
<span class="output-line" id="out91">[&gt; Line 373: (exists j) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,j:index<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br><span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br>forall (ii1:index),<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii<br><br></span>
<span class="com-line" id="com91"><p>We apply the INT-CTXT assumption, which directly gives the existence of an action <code>Press(i,j)</code> that happens before <code>S(ii,i)</code>.</p>
</span>
</span>

<span class="squirrel-step" id="step92">
<span class="input-line" id="in92"><br>  intro Ht M1 *.</span>
<span class="output-line" id="out92">[&gt; Line 378: simpl <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,j:index<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;<br>forall (ii1:index),<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii<br><br></span>
</span>

<span class="squirrel-step" id="step93">
<span class="input-line" id="in93"><br>  exists j.</span>
<span class="output-line" id="out93">[&gt; Line 379: (split; 1: auto) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,j:index<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>forall (ii1:index),<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii<br><br></span>
</span>

<span class="squirrel-step" id="step94">
<span class="input-line" id="in94">  simpl.</span>
<span class="output-line" id="out94">[&gt; Line 384: (intro ii' Hap' Hexec1 Eq) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
<span class="com-line" id="com94"><p>The two first conjucts of the conclusion are automatically proved by Squirrel (the equality of counter values is a consequence of M1 once we have expanded the macros <code>cpt</code> and <code>SCpt</code>.</p>
</span>
</span>

<span class="squirrel-step" id="step95">
<span class="input-line" id="in95"> <br>  split; 1: auto.</span>
<span class="output-line" id="out95">[&gt; Line 385: ((have (SCpt(i)@S(ii,i) = SCpt(i)@S(ii',i)));(intro //)) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step96">
<span class="input-line" id="in96">  intro ii' Hap' Hexec1 Eq.</span>
<span class="output-line" id="out96">[&gt; Line 390: ((have<br>              ((S(ii,i) = S(ii',i)) ||<br>               ((S(ii,i) &lt; S(ii',i)) || (S(ii,i) &gt; S(ii',i)))));<br>             (intro //))<br><br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="ga" style="color: #00AA00">S(ii',i)</span> || <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span> || <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
<span class="com-line" id="com96"><p>It now remains to show that the counter value <code>cpt(i,j)@Press(i,j)</code> is not involved in another successful login. We first show if this second successful login <code>S(ii',i)</code> had happened, then we must have <code>SCpt(i)@S(ii,i) = SCpt(i)@S(ii',i)</code>.</p>
</span>
</span>

<span class="squirrel-step" id="step97">
<span class="input-line" id="in97"><br>  assert (SCpt(i)@S(ii,i) = SCpt(i)@S(ii',i)) =&gt; //.</span>
<span class="output-line" id="out97">[&gt; Line 391: ((case H);(intro //)) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step98">
<span class="input-line" id="in98">  assert (S(ii,i) = S(ii',i) || S(ii,i) &lt; S(ii',i) || S(ii,i) &gt; S(ii',i)) =&gt; //.</span>
<span class="output-line" id="out98">[&gt; Line 394: ((have<br>              ((S(ii,i) = pred(S(ii',i))) || (S(ii,i) &lt; pred(S(ii',i)))));<br>             (intro //))<br><br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H0: <span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>) || <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
<span class="com-line" id="com98"><p>The proof now relies only on lemmas about counter values to show that we cannot have <code>SCpt(i)@S(ii,i) = SCpt(i)@S(ii',i)</code> and <code>S(ii,i) &lt;&gt; S(ii',i)</code>. We therefore a case disjunction (the first case corresponds to what we want to prove, and we will show that the 2 other cases are impossible).</p>
</span>
</span>

<span class="squirrel-step" id="step99">
<span class="input-line" id="in99"><br>  case H =&gt; //.</span>
<span class="output-line" id="out99">[&gt; Line 395: ((case H0);(intro //)) <br>[goal&gt; Focused goal (1/3):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H0: <span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step100">
<span class="input-line" id="in100"><br><br>    + (* 1st case: S(ii,i) &lt; S(ii',i) *)<br>      assert (S(ii,i) = pred(S(ii',i)) || S(ii,i) &lt; pred(S(ii',i))) =&gt; //.</span>
<span class="output-line" id="out100">[&gt; Line 398: ((have ... as );(intro //)) <br>[goal&gt; Focused goal (1/3):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H0: <span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Meq0: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step101">
<span class="input-line" id="in101"><br>      case H0 =&gt; //.</span>
<span class="output-line" id="out101">[&gt; Line 399: ((subst S(ii,i), pred(S(ii',i)));(intro //)) <br>[goal&gt; Focused goal (1/3):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>) &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>))<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)) ~&lt;<br>      <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>))),<span class="gn" style="color: #AA5500">k</span>(i))) = <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>) =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>))<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) =<br>    <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>) = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Meq0: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>))),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step102">
<span class="input-line" id="in102"><br><br>        - (* S(ii,i) = pred(S(ii',i) &lt; S(ii',i) *)<br>          use counterIncreaseStrictly with ii',i =&gt; //.</span>
<span class="output-line" id="out102">[&gt; Line 400: (by (have ... as );(intro //)) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H0: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step103">
<span class="input-line" id="in103"><br>          subst  S(ii,i), pred(S(ii',i)) =&gt; //.</span>
<span class="output-line" id="out103">[&gt; Line 403: ((have ... as );(intro //)) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H0: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Meq0: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step104">
<span class="input-line" id="in104"><br>          by use orderStrict with SCpt(i)@pred(S(ii',i)), SCpt(i)@S(ii',i) =&gt; //.</span>
<span class="output-line" id="out104">[&gt; Line 404: ((have ... as );(intro //)) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H0: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>H1: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span> ||<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>) = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Meq0: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step105">
<span class="input-line" id="in105"><br><br>        - (* S(ii,i) &lt; pred(S(ii',i))  &lt; S(ii',i) *)<br>          use counterIncreaseStrictly with ii',i =&gt; //.</span>
<span class="output-line" id="out105">[&gt; Line 405: (case H1) <br>[goal&gt; Focused goal (1/3):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H0: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>H1: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Meq0: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step106">
<span class="input-line" id="in106"><br>          use counterIncreaseBis with pred(S(ii',i)), S(ii,i), i =&gt; //.</span>
<span class="output-line" id="out106">[&gt; Line 406: ((have ... as );(intro //)) <br>[goal&gt; Focused goal (1/3):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H0: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>H1: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Meq0: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Meq1: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step107">
<span class="input-line" id="in107"><br>          case H1.</span>
<span class="output-line" id="out107">[&gt; Line 407: (by (have ... as );(intro //)) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H0: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>H1: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>) = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Meq0: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step108">
<span class="input-line" id="in108"><br>            * use orderTrans with SCpt(i)@S(ii,i), SCpt(i)@pred(S(ii',i)), SCpt(i)@S(ii',i) =&gt; //.</span>
<span class="output-line" id="out108">[&gt; Line 408: (subst SCpt(i)@pred(S(ii',i)), SCpt(i)@S(ii,i)) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H0: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Meq0: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step109">
<span class="input-line" id="in109"><br>              by use orderStrict with SCpt(i)@S(ii,i), SCpt(i)@S(ii',i) =&gt; //.</span>
<span class="output-line" id="out109">[&gt; Line 409: (by (have ... as );(intro //)) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step110">
<span class="input-line" id="in110"><br>            * subst SCpt(i)@pred(S(ii',i)), SCpt(i)@S(ii,i).</span>
<span class="output-line" id="out110">[&gt; Line 412: ((have<br>              ((pred(S(ii,i)) = S(ii',i)) || (pred(S(ii,i)) &gt; S(ii',i))));<br>             (intro //))<br><br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H0: <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="ga" style="color: #00AA00">S(ii',i)</span> || <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step111">
<span class="input-line" id="in111"><br>              by use orderStrict with SCpt(i)@S(ii,i), SCpt(i)@S(ii',i) =&gt; //.</span>
<span class="output-line" id="out111">[&gt; Line 413: ((case H0);(intro //)) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H0: <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step112">
<span class="input-line" id="in112"><br><br>    + (* 2nd case: S(ii,i) &gt; S(ii',i) *)<br>      assert (pred(S(ii,i)) = S(ii',i) || pred(S(ii,i)) &gt; S(ii',i)) =&gt; //.</span>
<span class="output-line" id="out112">[&gt; Line 416: ((have ... as );(intro //)) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H0: <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Meq0: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step113">
<span class="input-line" id="in113"><br>      case H0 =&gt; //.</span>
<span class="output-line" id="out113">[&gt; Line 417: (subst S(ii',i), pred(S(ii,i))) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Meq0: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step114">
<span class="input-line" id="in114"><br><br>        - (* S(ii,i) &gt; pred(S(ii,i)) = S(ii',i) *)<br>          use counterIncreaseStrictly with ii,i =&gt; //.</span>
<span class="output-line" id="out114">[&gt; Line 418: (by (have ... as );(intro //)) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H0: <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step115">
<span class="input-line" id="in115"><br>          subst S(ii',i), pred(S(ii,i)).</span>
<span class="output-line" id="out115">[&gt; Line 421: ((have ... as );(intro //)) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H0: <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Meq0: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step116">
<span class="input-line" id="in116"><br>          by use orderStrict with SCpt(i)@pred(S(ii,i)), SCpt(i)@S(ii,i) =&gt; //.</span>
<span class="output-line" id="out116">[&gt; Line 422: ((have ... as );(intro //)) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H0: <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H1: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span> ||<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Meq0: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step117">
<span class="input-line" id="in117"><br><br>        - (* S(ii,i) &gt; pred(S(ii,i)) &gt;  S(ii',i) *)<br>          use counterIncreaseStrictly with ii,i =&gt; //.</span>
<span class="output-line" id="out117">[&gt; Line 423: (case H1) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H0: <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H1: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Meq0: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step118">
<span class="input-line" id="in118"><br>          use counterIncreaseBis with pred(S(ii,i)), S(ii',i), i =&gt; //.</span>
<span class="output-line" id="out118">[&gt; Line 424: ((have ... as );(intro //)) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H0: <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H1: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Meq0: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Meq1: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step119">
<span class="input-line" id="in119"><br>          case H1.</span>
<span class="output-line" id="out119">[&gt; Line 425: (by (have ... as );(intro //)) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H0: <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H1: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) =<br>      <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Meq0: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step120">
<span class="input-line" id="in120"><br>            * use orderTrans with SCpt(i)@S(ii',i), SCpt(i)@pred(S(ii,i)), SCpt(i)@S(ii,i) =&gt; //.</span>
<span class="output-line" id="out120">[&gt; Line 426: (subst SCpt(i)@pred(S(ii,i)), SCpt(i)@S(ii',i)) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii',j:index<br>Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>H0: <span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)<br>Hcpt: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i))) = <span class="gf" style="font-weight: bold">orderOk</span><br>Hexec': forall (t:timestamp), t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t<br>Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="gf" style="font-weight: bold">pred</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)<br>Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)<br>Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span><br>M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span><br>Meq0: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>ii' = ii<br><br></span>
</span>

<span class="squirrel-step" id="step121">
<span class="input-line" id="in121"><br>              by use orderStrict with SCpt(i)@S(ii',i), SCpt(i)@S(ii,i) =&gt; //.</span>
<span class="output-line" id="out121">[&gt; Line 427: (by (have ... as );(intro //)) <br>[goal&gt; Goal injective_correspondence is proved <br></span>
</span>

<span class="squirrel-step" id="step122">
<span class="input-line" id="in122"><br>            * subst SCpt(i)@pred(S(ii,i)), SCpt(i)@S(ii',i).</span>
<span class="output-line" id="out122">Exiting proof mode.<br><br><br></span>
</span>

<span class="squirrel-step" id="step123">
<span class="input-line" id="in123"><br>              by use orderStrict with SCpt(i)@S(ii',i), SCpt(i)@S(ii,i) =&gt; //.</span>
<span class="output-line" id="out123">Goal monotonicity :<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span> =&gt;<br>  <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br></span>
</span>

<span class="squirrel-step" id="step124">
<span class="input-line" id="in124"><br>Qed.</span>
<span class="output-line" id="out124">[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii1:index<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;<br><span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp;<br><span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span> =&gt;<br><span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br><br></span>
</span>

<span class="squirrel-step" id="step125">
<span class="input-line" id="in125">goal monotonicity (ii, ii1, i:index):<br>  happens(S(ii1,i),S(ii,i)) =&gt;<br>    exec@S(ii1,i) &amp;&amp; exec@S(ii,i)<br>      &amp;&amp; SCpt(i)@S(ii,i) ~&lt; SCpt(i)@S(ii1,i) = orderOk =&gt;<br>        S(ii,i) &lt; S(ii1,i).</span>
<span class="output-line" id="out125">[&gt; Line 445: (intro Hap [Hexec H]) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii1:index<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br><br></span>
<span class="com-line" id="com125"><h4 id="property-3-monotonicity">Property 3: monotonicity</h4>
<p>This property states that the counter values associated to successful logins are monotonically increasing in time.</p>
<p>Note that proving this property does not rely on any assumption on cryptographic primitives: it relies only on reasonings about counter values.</p>
</span>
</span>

<span class="squirrel-step" id="step126">
<span class="input-line" id="in126"><br>Proof.</span>
<span class="output-line" id="out126">[&gt; Line 451: ((have<br>              ((S(ii,i) = S(ii1,i)) ||<br>               ((S(ii,i) &lt; S(ii1,i)) || (S(ii,i) &gt; S(ii1,i)))),<br>              Ht);<br>             1: constraints)<br><br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii1:index<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="ga" style="color: #00AA00">S(ii1,i)</span> || <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span> || <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br><br></span>
</span>

<span class="squirrel-step" id="step127">
<span class="input-line" id="in127"><br>  intro Hap [Hexec H].</span>
<span class="output-line" id="out127">[&gt; Line 452: (case Ht) <br>[goal&gt; Focused goal (1/3):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii1:index<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="ga" style="color: #00AA00">S(ii1,i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br><br></span>
</span>

<span class="squirrel-step" id="step128">
<span class="input-line" id="in128">  assert<br>    (S(ii,i) = S(ii1,i) || S(ii,i) &lt; S(ii1,i) || S(ii,i) &gt; S(ii1,i)) as Ht;<br>  1: constraints.</span>
<span class="output-line" id="out128">[&gt; Line 455: by (have ... as ) <br>[goal&gt; Focused goal (1/2):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii1:index<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br><br></span>
<span class="com-line" id="com128"><p>We introduce a case disjunction, and we will show that the cases <code>S(ii,i) = S(ii1,i)</code> and <code>S(ii,i) &gt; S(ii1,i)</code> are not possible, relying on previous lemmas and axioms on counter values.</p>
</span>
</span>

<span class="squirrel-step" id="step129">
<span class="input-line" id="in129"><br>  case Ht.</span>
<span class="output-line" id="out129">[&gt; Line 458: assumption <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii1:index<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br><br></span>
</span>

<span class="squirrel-step" id="step130">
<span class="input-line" id="in130"><br><br>  + (* case S(ii,i) = S(ii1,i) *)<br>    by use orderStrict with SCpt(i)@S(ii,i),SCpt(i)@S(ii,i).</span>
<span class="output-line" id="out130">[&gt; Line 461: ((have ... as Meq);(intro //)) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii1:index<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br><br></span>
</span>

<span class="squirrel-step" id="step131">
<span class="input-line" id="in131"><br><br>  + (* case S(ii,i) &lt; S(ii1,i) *)<br>    assumption.</span>
<span class="output-line" id="out131">[&gt; Line 462: ((have ... as );(intro //)) <br>[goal&gt; Focused goal (1/1):<br>System: left:default/left, right:default/right<br>Variables: i,ii,ii1:index<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br>Meq0: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gf" style="font-weight: bold">orderOk</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span><br><br></span>
</span>

<span class="squirrel-step" id="step132">
<span class="input-line" id="in132"><br><br>  + (* case S(ii,i) &gt; S(ii1,i) *)<br>    use noreplayInv with ii1, ii, i as Meq =&gt; //.</span>
<span class="output-line" id="out132">[&gt; Line 463: by (have ... as ) <br>[goal&gt; Goal monotonicity is proved <br></span>
</span>

<span class="squirrel-step" id="step133">
<span class="input-line" id="in133"><br>    use orderTrans with SCpt(i)@S(ii,i),SCpt(i)@S(ii1,i), SCpt(i)@S(ii,i) =&gt; //.</span>
<span class="output-line" id="out133">Exiting proof mode.<br><br><br></span>
</span>

</span>
<div class="page-header">
  <img src="logo-circular.png" class="logo">
  <h1 class="project-tagline">Squirrel Prover</h1>
  <a href="https://squirrel-prover.github.io/examples.html" class="header-button">
    <button type="button" class="header-button">Exit</button>
  </a>
  <button type="button" class="header-button" onclick="help()" id="button-panel">Help</button>
</div>

<div class="help-panel" id="help-panel">
  Press the left and right arrows to do and undo an instruction.
  <br><br>
  Alternatively, you can double-click on an instruction.
  <br><br>
  <span style="color: #8B0000;" onmouseenter="highlightOn('in-zone')" onmouseleave="highlightOff('in-zone')">This zone</span> shows a Squirrel file. You can double-click on a comment to collapse it for better readabilility.
  <br><br>
  <span style="color: #8B0000;" onmouseenter="highlightOn('out-zone')" onmouseleave="highlightOff('out-zone')">This zone</span> shows the output given by Squirrel.
  <br><br>
  <span style="color: #8B0000;" onmouseenter="highlightOn('prec-zone')" onmouseleave="highlightOff('prec-zone')">This zone</span> shows the output of the previous instruction, to help identifying the change caused by the instruction.
</div>

<div class="mainsection" id="main">
  <div class="example-grid">
    <div class="example-col example-col-left" id="in-zone">
      <p class="example-code"><span id="in-line"></span></p>
    </div>
    <div class="example-col example-col-right">
      <div class="example-code example-code-right" style="height: 45%;	border-bottom: 4px double #8B0000;" id="prec-zone"><span>Previously:</span><br><br><span id="prec-line"></span>
      </div>
      <div style="position: relative;">
      <button type="button" class="prec-button" onclick="hidePrec()" id="prec-button" >Hide</button>
      </div>
      <div class="example-code example-code-right" style="height: 55%;" id="out-zone"><span id="out-line"></span>
      </div>
    </div>
  </div>
</div>

<script src="script.js"></script>

</body>

