<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="UTF-8">

  <title>Squirrel Prover - Squirrel Prover</title>
  
  <link rel="stylesheet" href="style.css">
</head>

<body>
<span style="display: none;"><span class="input-line" id="in0">(*******************************************************************************
YUBIKEY

The YubiKey is a simple physical authentication device with a unique button. 
This device, manufactured by Yubico, allows users to securely authenticate to 
their accounts by issuing a one-time password (OTP). 
In its typical configuration, the YubiKey generates a random OTP by encrypting 
a secret value and a counter. 
This message is accepted by the server only if it decrypts under the correct 
key to a valid secret value containing a counter whose value is larger than the 
last value accepted by the server for that YubiKey.

In this model, we analyze the security of the protocol as described in [1],
assuming that the server remains secure.

Yubico assigns a key `k`, as well as a public and a secret identifier `pid, sid` 
to each YubiKey. The counter `cpt` inside the YubiKey is incremented whenever the 
YubiKey is plugged in, as well as when an OTP is generated, i.e. when the button 
of the YubiKey is pressed. This OTP is obtained by encrypting the counter value 
and the `sid` of the YubiKey with the key `k`.

YubiKey -&gt; Server : &lt;pid,&lt;nonce,senc(&lt;sid,cpt&gt;,npr,k)&gt;&gt;

Here, `npr` is the encryption randomness. The server accepts this message if it 
decrypts with a legitimate key `k`, and leads to a valid secret value `sid`. 
Lastly, the counter value obtained through decryption has to be larger than the 
current value stored in the server database. After this exchange, the server
updates its counter with the value just received.

COMMENTS

* The OTP is an encryption of a triple `&lt;sid, cpt, npr&gt;`.
It is modelled here as a randomized encryption of a pair `&lt;sid, cpt&gt;`.
According to the specification in [1], AES is used.

* In [1], they &quot;over-approximate in the case that the Yubikey increases the
session token by allowing the adversary to instantiate the rule for any counter
value that is higher than the previous one&quot;.
Here, we model the incrementation by 1 of the counter.

SECURITY PROPERTIES 
The 3 security properties as stated in [1].
* Property 1: absence of replay attacks.
* Property 2: injective correspondence.
* Property 3: monotonicity.

[1] R. Künnemann, &quot;Foundations for analyzing security APIs in the symbolic and
computational model’, 2014.
*******************************************************************************)

set autoIntro = false.</span><span class="output-line" id="out0">true
</span><span class="input-line" id="in1">

(** Public constants (`abstract`) and names used in the protocol. **)
abstract startplug: message
abstract endplug: message
abstract startpress: message
abstract accept:message
abstract pid : index -&gt; message
name sid: index -&gt; message
name nonce: index-&gt;index-&gt;message.</span><span class="output-line" id="out1"></span><span class="input-line" id="in2">

(** 
Symmetric encryption scheme, using the secret key `k` (with index arity 1 
so that each YubiKey is associated to a key) and the random `npr` (with index
arity 2 so that each session of a YubiKey uses a new random name).
**)
senc enc,dec
name k: index -&gt; message
name npr: index-&gt;index-&gt;message.</span><span class="output-line" id="out2"></span><span class="input-line" id="in3">

(**
Public constants and public functions used to model counter values.
**)
abstract myzero: message
abstract myone: message
abstract mySucc : message-&gt;message
abstract orderOk : message
abstract (~&lt;) : message-&gt;message-&gt;message.</span><span class="output-line" id="out3"></span><span class="input-line" id="in4">

(**
Mutable cells for the YubiKey and the server, initialized with `myzero`.
**)
mutable YCpt(i:index): message = myzero
mutable SCpt(i:index): message = myzero.</span><span class="output-line" id="out4"></span><span class="input-line" id="in5">

(** Communication channels used in the protocol. **)
channel cT
channel cR.</span><span class="output-line" id="out5"></span><span class="input-line" id="in6">

(** When the key is plugged, its counter is incremented. **)
process yubikeyplug(i:index,j:index) =
  in(cT, x1);
  if x1 = startplug then 
    YCpt(i) := mySucc(YCpt(i)); 
    out(cT,endplug).</span><span class="output-line" id="out6"></span><span class="input-line" id="in7">

(** When the key is pressed, an OTP is sent with the current value of the 
counter and the counter is incremented. **)
process yubikeypress(i:index,j:index) =
  in(cT,x2);
  if x2 = startpress then
    let cpt = YCpt(i) in
    YCpt(i) := mySucc(YCpt(i));
    out(cT,&lt;pid(i),&lt;nonce(i,j),enc(&lt;sid(i),cpt&gt;,npr(i,j),k(i))&gt;&gt;).</span><span class="output-line" id="out7"></span><span class="input-line" id="in8">

(** When the server receives a message, it checks whether it corresponds 
to a pid in its database, and checks also that the counter inside the OTP
is strictly greater than the counter associated to the token. 
If so, the value inside the OTP is used to update the database.
Now, the counter value associated to this token is this new value. **)
process server(ii:index) =
  in(cR,y1);
  try find i such that fst(y1) = pid(i) in
    if dec(snd(snd(y1)),k(i)) &lt;&gt; fail 
        &amp;&amp; SCpt(i) ~&lt; snd(dec(snd(snd(y1)),k(i))) = orderOk 
    then
      SCpt(i) := snd(dec(snd(snd(y1)),k(i)));
      out(cR,accept).</span><span class="output-line" id="out8"></span><span class="input-line" id="in9">

(** In the final system, processes can play in parallel an unbounded number
of sessions. **)
system 
  ((!_i !_j Plug: yubikeyplug(i,j)) 
    | (!_i !_j Press: yubikeypress(i,j)) 
    | (!_ii S: server(ii))).</span><span class="output-line" id="out9">Un-processed system:
  
  (!_i !_j Plug: <span class="pn" style="font-weight:bold; color: #0000AA">yubikeyplug</span> i j) |
  ((!_i !_j Press: <span class="pn" style="font-weight:bold; color: #0000AA">yubikeypress</span> i j) | (!_ii S: <span class="pn" style="font-weight:bold; color: #0000AA">server</span> ii))

Processed system:
  
  (!_i
     !_j
       <span class="pio" style="font-weight: bold">in</span>(<span class="pc">cT</span>,<span class="pv" style="font-weight: bold; color: #AA00AA">x1</span>);
       <span class="pc" style="text-decoration: underline; color: #AA0000">if</span> x1 = startplug <span class="pc" style="text-decoration: underline; color: #AA0000">then</span>
         YCpt(i) <span class="pk" style="font-weight: bold">:=</span> mySucc(YCpt(i)); Plug: <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cT</span>,endplug); <span class="pn" style="font-weight:bold; color: #0000AA">null</span> <span class="pc" style="text-decoration: underline; color: #AA0000">else</span>
         Plug1: <span class="pn" style="font-weight:bold; color: #0000AA">null</span>) |
  ((!_i
      !_j
        <span class="pio" style="font-weight: bold">in</span>(<span class="pc">cT</span>,<span class="pv" style="font-weight: bold; color: #AA00AA">x2</span>);
        <span class="pc" style="text-decoration: underline; color: #AA0000">if</span> x2 = startpress <span class="pc" style="text-decoration: underline; color: #AA0000">then</span>
          <span class="pk" style="font-weight: bold">let</span> <span class="pv" style="font-weight: bold; color: #AA00AA">cpt</span> = YCpt(i) <span class="pk" style="font-weight: bold">in</span>
          YCpt(i) <span class="pk" style="font-weight: bold">:=</span> mySucc(YCpt(i));
          Press:
          <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cT</span>,
          pair(pid(i),
                pair(nonce(i,j),enc(pair(sid(i),cpt(i,j)),npr(i,j),k(i)))));
          <span class="pn" style="font-weight:bold; color: #0000AA">null</span> <span class="pc" style="text-decoration: underline; color: #AA0000">else</span> Press1: <span class="pn" style="font-weight:bold; color: #0000AA">null</span>) |
   (!_ii
      <span class="pio" style="font-weight: bold">in</span>(<span class="pc">cR</span>,<span class="pv" style="font-weight: bold; color: #AA00AA">y1</span>);
      <span class="pc" style="text-decoration: underline; color: #AA0000">find</span> (i) <span class="pc" style="text-decoration: underline; color: #AA0000">such that</span> fst(y1) = pid(i) <span class="pc" style="text-decoration: underline; color: #AA0000">in</span>
        <span class="pc" style="text-decoration: underline; color: #AA0000">if</span> (dec(snd(snd(y1)),k(i)) &lt;&gt; fail &amp;&amp;
            (SCpt(i) ~&lt; snd(dec(snd(snd(y1)),k(i)))) = orderOk) <span class="pc" style="text-decoration: underline; color: #AA0000">then</span>
          SCpt(i) <span class="pk" style="font-weight: bold">:=</span> snd(dec(snd(snd(y1)),k(i))); S: <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cR</span>,accept); <span class="pn" style="font-weight:bold; color: #0000AA">null</span>
        <span class="pc" style="text-decoration: underline; color: #AA0000">else</span> S1: <span class="pn" style="font-weight:bold; color: #0000AA">null</span> <span class="pc" style="text-decoration: underline; color: #AA0000">else</span> S2: <span class="pn" style="font-weight:bold; color: #0000AA">null</span>))

System default registered with actions (init,Plug,Plug1,Press,Press1,S,S1,S2).
</span><span class="input-line" id="in10">


(** LIBRARIES 
We include here some libraries, useful to help the tool with automated
reasoning. **)

include Basic.</span><span class="output-line" id="out10">Goal eq_sym :
  x = y =&gt; y = x
[goal&gt; Focused goal (1/1):
System: default
Type variables: 'a
Variables: x,y:'a
<span class="sep" style="font-weight: bold">----------------------------------------</span>
x = y =&gt; y = x

[&gt; Line 10: auto 
[goal&gt; Goal eq_sym is proved 
Exiting proof mode.


Goal eq_refl :
  x = x = true
[goal&gt; Focused goal (1/1):
System: default
Type variables: 'a
Variables: x:'a
<span class="sep" style="font-weight: bold">----------------------------------------</span>
x = x = true

[&gt; Line 16: by (rewrite ...) 
[goal&gt; Goal eq_refl is proved 
Exiting proof mode.


Goal eq_refl_i :
  x = x = true
[goal&gt; Focused goal (1/1):
System: default
Variables: x:index
<span class="sep" style="font-weight: bold">----------------------------------------</span>
x = x = true

[&gt; Line 23: by (rewrite ...) 
[goal&gt; Goal eq_refl_i is proved 
Exiting proof mode.


Goal eq_refl_t :
  x = x = true
[goal&gt; Focused goal (1/1):
System: default
Variables: x:timestamp
<span class="sep" style="font-weight: bold">----------------------------------------</span>
x = x = true

[&gt; Line 30: by (rewrite ...) 
[goal&gt; Goal eq_refl_t is proved 
Exiting proof mode.


Goal false_true :
  false = true = false
[goal&gt; Focused goal (1/1):
System: default
<span class="sep" style="font-weight: bold">----------------------------------------</span>
false = true = false

[&gt; Line 44: (assert <span>forall</span> (x,y:boolean), x = y = y = x, H) 
[goal&gt; Focused goal (1/2):
System: default
<span class="sep" style="font-weight: bold">----------------------------------------</span>
forall (x,y:bool), x = y = y = x

[&gt; Line 45: (intro _ _) 
[goal&gt; Focused goal (1/2):
System: default
Variables: x,y:bool
<span class="sep" style="font-weight: bold">----------------------------------------</span>
x = y = y = x

[&gt; Line 46: by (rewrite ...) 
[goal&gt; Focused goal (1/1):
System: default
H: forall (x,y:bool), x = y = y = x
<span class="sep" style="font-weight: bold">----------------------------------------</span>
false = true = false

[&gt; Line 47: (rewrite ...) 
[goal&gt; Focused goal (1/1):
System: default
H: forall (x,y:bool), x = y = y = x
<span class="sep" style="font-weight: bold">----------------------------------------</span>
true = false = false

[&gt; Line 48: auto 
[goal&gt; Goal false_true is proved 
Exiting proof mode.


Goal not_not :
  not(not(b)) = b
[goal&gt; Focused goal (1/1):
System: default
Variables: b:bool
<span class="sep" style="font-weight: bold">----------------------------------------</span>
not(not(b)) = b

[&gt; Line 64: by (case b) 
[goal&gt; Goal not_not is proved 
Exiting proof mode.


Goal not_eq :
  not(x = y) = x &lt;&gt; y
[goal&gt; Focused goal (1/1):
System: default
Type variables: 'a
Variables: x,y:'a
<span class="sep" style="font-weight: bold">----------------------------------------</span>
not(x = y) = x &lt;&gt; y

[&gt; Line 70: by (rewrite ...) 
[goal&gt; Goal not_eq is proved 
Exiting proof mode.


Goal not_eq_i :
  not(x = y) = x &lt;&gt; y
[goal&gt; Focused goal (1/1):
System: default
Variables: x,y:index
<span class="sep" style="font-weight: bold">----------------------------------------</span>
not(x = y) = x &lt;&gt; y

[&gt; Line 77: by (rewrite ...) 
[goal&gt; Goal not_eq_i is proved 
Exiting proof mode.


Goal not_eq_t :
  not(x = y) = x &lt;&gt; y
[goal&gt; Focused goal (1/1):
System: default
Variables: x,y:timestamp
<span class="sep" style="font-weight: bold">----------------------------------------</span>
not(x = y) = x &lt;&gt; y

[&gt; Line 84: by (rewrite ...) 
[goal&gt; Goal not_eq_t is proved 
Exiting proof mode.


Goal not_neq :
  not(x &lt;&gt; y) = x = y
[goal&gt; Focused goal (1/1):
System: default
Type variables: 'a
Variables: x,y:'a
<span class="sep" style="font-weight: bold">----------------------------------------</span>
not(x &lt;&gt; y) = x = y

[&gt; Line 90: by (rewrite ...) 
[goal&gt; Goal not_neq is proved 
Exiting proof mode.


Goal not_neq_i :
  not(x &lt;&gt; y) = x = y
[goal&gt; Focused goal (1/1):
System: default
Variables: x,y:index
<span class="sep" style="font-weight: bold">----------------------------------------</span>
not(x &lt;&gt; y) = x = y

[&gt; Line 97: by (rewrite ...) 
[goal&gt; Goal not_neq_i is proved 
Exiting proof mode.


Goal not_neq_t :
  not(x &lt;&gt; y) = x = y
[goal&gt; Focused goal (1/1):
System: default
Variables: x,y:timestamp
<span class="sep" style="font-weight: bold">----------------------------------------</span>
not(x &lt;&gt; y) = x = y

[&gt; Line 104: by (rewrite ...) 
[goal&gt; Goal not_neq_t is proved 
Exiting proof mode.


Goal eq_false :
  x = y = false = x &lt;&gt; y
[goal&gt; Focused goal (1/1):
System: default
Type variables: 'a
Variables: x,y:'a
<span class="sep" style="font-weight: bold">----------------------------------------</span>
x = y = false = x &lt;&gt; y

[&gt; Line 113: (rewrite ...) 
[goal&gt; Focused goal (1/1):
System: default
Type variables: 'a
Variables: x,y:'a
<span class="sep" style="font-weight: bold">----------------------------------------</span>
x = y = false = not(x = y)

[&gt; Line 113: ((case x = y);(intro _)) 
[goal&gt; Focused goal (1/2):
System: default
Type variables: 'a
Variables: x,y:'a
_: x = y
<span class="sep" style="font-weight: bold">----------------------------------------</span>
true = false = not(true)

[&gt; Line 113: simpl 
[goal&gt; Focused goal (1/2):
System: default
Type variables: 'a
Variables: x,y:'a
_: x = y
<span class="sep" style="font-weight: bold">----------------------------------------</span>
true

[&gt; Line 113: auto 
[goal&gt; Focused goal (1/1):
System: default
Type variables: 'a
Variables: x,y:'a
_: not(x = y)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
false = false = not(false)

[&gt; Line 114: by (rewrite ...) 
[goal&gt; Goal eq_false is proved 
Exiting proof mode.


Goal eq_false_i :
  x = y = false = x &lt;&gt; y
[goal&gt; Focused goal (1/1):
System: default
Variables: x,y:index
<span class="sep" style="font-weight: bold">----------------------------------------</span>
x = y = false = x &lt;&gt; y

[&gt; Line 121: (rewrite ...) 
[goal&gt; Focused goal (1/1):
System: default
Variables: x,y:index
<span class="sep" style="font-weight: bold">----------------------------------------</span>
x = y = false = not(x = y)

[&gt; Line 121: ((case x = y);(intro _)) 
[goal&gt; Focused goal (1/2):
System: default
Variables: x:index
<span class="sep" style="font-weight: bold">----------------------------------------</span>
true = false = not(true)

[&gt; Line 121: simpl 
[goal&gt; Focused goal (1/2):
System: default
Variables: x:index
<span class="sep" style="font-weight: bold">----------------------------------------</span>
true

[&gt; Line 121: auto 
[goal&gt; Focused goal (1/1):
System: default
Variables: x,y:index
_: not(x = y)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
false = false = not(false)

[&gt; Line 122: by (rewrite ...) 
[goal&gt; Goal eq_false_i is proved 
Exiting proof mode.


Goal eq_false_t :
  x = y = false = x &lt;&gt; y
[goal&gt; Focused goal (1/1):
System: default
Variables: x,y:timestamp
<span class="sep" style="font-weight: bold">----------------------------------------</span>
x = y = false = x &lt;&gt; y

[&gt; Line 129: (rewrite ...) 
[goal&gt; Focused goal (1/1):
System: default
Variables: x,y:timestamp
<span class="sep" style="font-weight: bold">----------------------------------------</span>
x = y = false = not(x = y)

[&gt; Line 129: ((case x = y);(intro _)) 
[goal&gt; Focused goal (1/2):
System: default
Variables: x:timestamp
<span class="sep" style="font-weight: bold">----------------------------------------</span>
true = false = not(true)

[&gt; Line 129: simpl 
[goal&gt; Focused goal (1/2):
System: default
Variables: x:timestamp
<span class="sep" style="font-weight: bold">----------------------------------------</span>
true

[&gt; Line 129: auto 
[goal&gt; Focused goal (1/1):
System: default
Variables: x,y:timestamp
_: not(x = y)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
false = false = not(false)

[&gt; Line 130: by (rewrite ...) 
[goal&gt; Goal eq_false_t is proved 
Exiting proof mode.


Goal and_true_r :
  (b &amp;&amp; true) = b
[goal&gt; Focused goal (1/1):
System: default
Variables: b:bool
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(b &amp;&amp; true) = b

[&gt; Line 143: by (rewrite ... ...) 
[goal&gt; Goal and_true_r is proved 
Exiting proof mode.


Goal and_false_r :
  (b &amp;&amp; false) = false
[goal&gt; Focused goal (1/1):
System: default
Variables: b:bool
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(b &amp;&amp; false) = false

[&gt; Line 150: by (rewrite ... ...) 
[goal&gt; Goal and_false_r is proved 
Exiting proof mode.


Goal or_false_r :
  (b || false) = b
[goal&gt; Focused goal (1/1):
System: default
Variables: b:bool
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(b || false) = b

[&gt; Line 161: by (rewrite ... ...) 
[goal&gt; Goal or_false_r is proved 
Exiting proof mode.


Goal or_true_r :
  (b || true) = true
[goal&gt; Focused goal (1/1):
System: default
Variables: b:bool
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(b || true) = true

[&gt; Line 168: by (rewrite ... ...) 
[goal&gt; Goal or_true_r is proved 
Exiting proof mode.


Goal not_and :
  not((a &amp;&amp; b)) = (not(a) || not(b))
[goal&gt; Focused goal (1/1):
System: default
Variables: a,b:bool
<span class="sep" style="font-weight: bold">----------------------------------------</span>
not((a &amp;&amp; b)) = (not(a) || not(b))

[&gt; Line 177: (rewrite ...) 
[goal&gt; Focused goal (1/1):
System: default
Variables: a,b:bool
<span class="sep" style="font-weight: bold">----------------------------------------</span>
not((a &amp;&amp; b))
&lt;=&gt;
(not(a) || not(b))]

[&gt; Line 178: (((case a);(case b));(intro //=)) 
[goal&gt; Goal not_and is proved 
Exiting proof mode.


Goal not_or :
  not((a || b)) = (not(a) &amp;&amp; not(b))
[goal&gt; Focused goal (1/1):
System: default
Variables: a,b:bool
<span class="sep" style="font-weight: bold">----------------------------------------</span>
not((a || b)) = (not(a) &amp;&amp; not(b))

[&gt; Line 183: (rewrite ...) 
[goal&gt; Focused goal (1/1):
System: default
Variables: a,b:bool
<span class="sep" style="font-weight: bold">----------------------------------------</span>
not((a || b))
&lt;=&gt;
(not(a) &amp;&amp; not(b))]

[&gt; Line 184: (((case a);(case b));(intro //=)) 
[goal&gt; Goal not_or is proved 
Exiting proof mode.


Goal if_true :
  b =&gt; (if b then x else y) = x
[goal&gt; Focused goal (1/1):
System: default
Type variables: 'a
Variables: b:bool,x,y:'a
<span class="sep" style="font-weight: bold">----------------------------------------</span>
b =&gt; (if b then x else y) = x

[&gt; Line 193: by ((intro *);yesif) 
[goal&gt; Goal if_true is proved 
Exiting proof mode.


Goal if_true0 :
  (if true then x else y) = x
[goal&gt; Focused goal (1/1):
System: default
Type variables: 'a
Variables: x,y:'a
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(if true then x else y) = x

[&gt; Line 199: by (rewrite ...) 
[goal&gt; Goal if_true0 is proved 
Exiting proof mode.


Goal if_false :
  not(b) =&gt; (if b then x else y) = y
[goal&gt; Focused goal (1/1):
System: default
Type variables: 'a
Variables: b:bool,x,y:'a
<span class="sep" style="font-weight: bold">----------------------------------------</span>
not(b) =&gt; (if b then x else y) = y

[&gt; Line 206: by ((intro *);noif) 
[goal&gt; Goal if_false is proved 
Exiting proof mode.


Goal if_false0 :
  (if false then x else y) = y
[goal&gt; Focused goal (1/1):
System: default
Type variables: 'a
Variables: x,y:'a
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(if false then x else y) = y

[&gt; Line 212: by (rewrite ...) 
[goal&gt; Goal if_false0 is proved 
Exiting proof mode.


Goal if_then_then :
  (if b then if b' then x else y else y) = if (b &amp;&amp; b') then x else y
[goal&gt; Focused goal (1/1):
System: default
Type variables: 'a
Variables: b,b':bool,x,y:'a
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(if b then if b' then x else y else y) = if (b &amp;&amp; b') then x else y

[&gt; Line 219: by ((case b);(case b')) 
[goal&gt; Goal if_then_then is proved 
Exiting proof mode.


Goal if_same :
  (if b then x else x) = x
[goal&gt; Focused goal (1/1):
System: default
Type variables: 'a
Variables: b:bool,x:'a
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(if b then x else x) = x

[&gt; Line 225: by (case b) 
[goal&gt; Goal if_same is proved 
Exiting proof mode.


Goal if_then :
  b = b' =&gt; (if b then if b' then x else y else z) = if b then x else z
[goal&gt; Focused goal (1/1):
System: default
Type variables: 'a
Variables: b,b':bool,x,y,z:'a
<span class="sep" style="font-weight: bold">----------------------------------------</span>
b = b' =&gt; (if b then if b' then x else y else z) = if b then x else z

[&gt; Line 234: by ((intro -&gt;);(case b')) 
[goal&gt; Goal if_then is proved 
Exiting proof mode.


Goal if_else :
  b = b' =&gt; (if b then x else if b' then y else z) = if b then x else z
[goal&gt; Focused goal (1/1):
System: default
Type variables: 'a
Variables: b,b':bool,x,y,z:'a
<span class="sep" style="font-weight: bold">----------------------------------------</span>
b = b' =&gt; (if b then x else if b' then y else z) = if b then x else z

[&gt; Line 243: by ((intro -&gt;);(case b')) 
[goal&gt; Goal if_else is proved 
Exiting proof mode.


Goal if_then_not :
  b = not(b') =&gt; (if b then if b' then x else y else z) = if b then y else z
[goal&gt; Focused goal (1/1):
System: default
Type variables: 'a
Variables: b,b':bool,x,y,z:'a
<span class="sep" style="font-weight: bold">----------------------------------------</span>
b = not(b') =&gt; (if b then if b' then x else y else z) = if b then y else z

[&gt; Line 252: by ((intro -&gt;);(case b')) 
[goal&gt; Goal if_then_not is proved 
Exiting proof mode.


Goal if_else_not :
  b = not(b') =&gt; (if b then x else if b' then y else z) = if b then x else y
[goal&gt; Focused goal (1/1):
System: default
Type variables: 'a
Variables: b,b':bool,x,y,z:'a
<span class="sep" style="font-weight: bold">----------------------------------------</span>
b = not(b') =&gt; (if b then x else if b' then y else z) = if b then x else y

[&gt; Line 261: by ((intro -&gt;);(case b')) 
[goal&gt; Goal if_else_not is proved 
Exiting proof mode.


Goal fst_pair :
  <span class="gf" style="font-weight: bold">fst</span>(&lt;x,y&gt;) = x
[goal&gt; Focused goal (1/1):
System: default
Variables: x,y:message
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="gf" style="font-weight: bold">fst</span>(&lt;x,y&gt;) = x

[&gt; Line 269: auto 
[goal&gt; Goal fst_pair is proved 
Exiting proof mode.


Goal snd_pair :
  <span class="gf" style="font-weight: bold">snd</span>(&lt;x,y&gt;) = y
[goal&gt; Focused goal (1/1):
System: default
Variables: x,y:message
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="gf" style="font-weight: bold">snd</span>(&lt;x,y&gt;) = y

[&gt; Line 273: auto 
[goal&gt; Goal snd_pair is proved 
Exiting proof mode.


Goal diff_eq :
  x = y =&gt; diff(x,y) = x
[goal&gt; Focused goal (1/1):
System: default
Type variables: 'a
Variables: x,y:'a
<span class="sep" style="font-weight: bold">----------------------------------------</span>
x = y =&gt; diff(x,y) = x

[&gt; Line 280: by project 
[goal&gt; Goal diff_eq is proved 
Exiting proof mode.


Goal diff_diff_l :
  diff(diff(x,y),z) = diff(x,z)
[goal&gt; Focused goal (1/1):
System: default
Type variables: 'a
Variables: x,y,z:'a
<span class="sep" style="font-weight: bold">----------------------------------------</span>
diff(diff(x,y),z) = diff(x,z)

[&gt; Line 284: by project 
[goal&gt; Goal diff_diff_l is proved 
Exiting proof mode.


Goal diff_diff_r :
  diff(x,diff(y,z)) = diff(x,z)
[goal&gt; Focused goal (1/1):
System: default
Type variables: 'a
Variables: x,y,z:'a
<span class="sep" style="font-weight: bold">----------------------------------------</span>
diff(x,diff(y,z)) = diff(x,z)

[&gt; Line 288: by project 
[goal&gt; Goal diff_diff_r is proved 
Exiting proof mode.


Goal len_diff :
  <span class="gf" style="font-weight: bold">len</span>(diff(x,y)) = diff(<span class="gf" style="font-weight: bold">len</span>(x),<span class="gf" style="font-weight: bold">len</span>(y))
[goal&gt; Focused goal (1/1):
System: default
Variables: x,y:message
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="gf" style="font-weight: bold">len</span>(diff(x,y)) = diff(<span class="gf" style="font-weight: bold">len</span>(x),<span class="gf" style="font-weight: bold">len</span>(y))

[&gt; Line 292: by project 
[goal&gt; Goal len_diff is proved 
Exiting proof mode.


[warning&gt; loaded: Basic.sp  &lt;]
</span><span class="input-line" id="in11">

goal dec_enc (x,y,z:message) : dec(enc(x,z,y),y) = x.</span><span class="output-line" id="out11">Goal dec_enc :
  <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">enc</span>(x,z,y),y) = x
</span><span class="input-line" id="in12">
Proof.</span><span class="output-line" id="out12">[goal&gt; Focused goal (1/1):
System: default
Variables: x,y,z:message
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">enc</span>(x,z,y),y) = x

</span><span class="input-line" id="in13"> auto.</span><span class="output-line" id="out13">[&gt; Line 135: auto 
[goal&gt; Goal dec_enc is proved 
</span><span class="input-line" id="in14"> Qed.</span><span class="output-line" id="out14">Exiting proof mode.


</span><span class="input-line" id="in15">
hint rewrite dec_enc.</span><span class="output-line" id="out15"></span><span class="input-line" id="in16">

goal fst_apply (x,y : message) : x = y =&gt; fst(x) = fst(y).</span><span class="output-line" id="out16">Goal fst_apply :
  x = y =&gt; <span class="gf" style="font-weight: bold">fst</span>(x) = <span class="gf" style="font-weight: bold">fst</span>(y)
</span><span class="input-line" id="in17">
Proof.</span><span class="output-line" id="out17">[goal&gt; Focused goal (1/1):
System: default
Variables: x,y:message
<span class="sep" style="font-weight: bold">----------------------------------------</span>
x = y =&gt; <span class="gf" style="font-weight: bold">fst</span>(x) = <span class="gf" style="font-weight: bold">fst</span>(y)

</span><span class="input-line" id="in18"> auto.</span><span class="output-line" id="out18">[&gt; Line 139: auto 
[goal&gt; Goal fst_apply is proved 
</span><span class="input-line" id="in19"> Qed.</span><span class="output-line" id="out19">Exiting proof mode.


</span><span class="input-line" id="in20">

goal snd_apply (x,y : message) : x = y =&gt; snd(x) = snd(y).</span><span class="output-line" id="out20">Goal snd_apply :
  x = y =&gt; <span class="gf" style="font-weight: bold">snd</span>(x) = <span class="gf" style="font-weight: bold">snd</span>(y)
</span><span class="input-line" id="in21">
Proof.</span><span class="output-line" id="out21">[goal&gt; Focused goal (1/1):
System: default
Variables: x,y:message
<span class="sep" style="font-weight: bold">----------------------------------------</span>
x = y =&gt; <span class="gf" style="font-weight: bold">snd</span>(x) = <span class="gf" style="font-weight: bold">snd</span>(y)

</span><span class="input-line" id="in22"> auto.</span><span class="output-line" id="out22">[&gt; Line 142: auto 
[goal&gt; Goal snd_apply is proved 
</span><span class="input-line" id="in23"> Qed.</span><span class="output-line" id="out23">Exiting proof mode.


</span><span class="input-line" id="in24">

goal dec_apply (x,y,x1,y1 : message) : 
 x = y =&gt; x1 = y1 =&gt; dec(x,x1) = dec(y,y1).</span><span class="output-line" id="out24">Goal dec_apply :
  x = y =&gt; x1 = y1 =&gt; <span class="gf" style="font-weight: bold">dec</span>(x,x1) = <span class="gf" style="font-weight: bold">dec</span>(y,y1)
</span><span class="input-line" id="in25">
Proof.</span><span class="output-line" id="out25">[goal&gt; Focused goal (1/1):
System: default
Variables: x,x1,y,y1:message
<span class="sep" style="font-weight: bold">----------------------------------------</span>
x = y =&gt; x1 = y1 =&gt; <span class="gf" style="font-weight: bold">dec</span>(x,x1) = <span class="gf" style="font-weight: bold">dec</span>(y,y1)

</span><span class="input-line" id="in26"> auto.</span><span class="output-line" id="out26">[&gt; Line 146: auto 
[goal&gt; Goal dec_apply is proved 
</span><span class="input-line" id="in27"> Qed.</span><span class="output-line" id="out27">Exiting proof mode.


</span><span class="input-line" id="in28">

(** AXIOMS 
The following axioms are used to reason on counter values. **)

axiom orderTrans (n1,n2,n3:message):
  n1 ~&lt; n2 = orderOk =&gt; n2 ~&lt; n3 = orderOk =&gt; n1 ~&lt; n3 = orderOk.</span><span class="output-line" id="out28"></span><span class="input-line" id="in29">

axiom orderStrict (n1,n2:message):
  n1 = n2 =&gt; n1 ~&lt; n2 &lt;&gt; orderOk.</span><span class="output-line" id="out29"></span><span class="input-line" id="in30">
  
axiom orderSucc (n1,n2:message):
  n1 = n2 =&gt; n1 ~&lt; mySucc(n2) = orderOk.</span><span class="output-line" id="out30"></span><span class="input-line" id="in31">

(** HELPING LEMMAS 
We now prove some properties on the counter on the server side, used later
in the proofs of the security properties. **)

(** The counter `SCpt(i)` strictly increases at each action `S` performed 
by the server with tag `i`. **)
goal counterIncreaseStrictly (ii,i:index):
  happens(S(ii,i)) =&gt;
    cond@S(ii,i) =&gt; 
      SCpt(i)@pred(S(ii,i)) ~&lt; SCpt(i)@S(ii,i) = orderOk.</span><span class="output-line" id="out31">Goal counterIncreaseStrictly :
  <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) =&gt;
  <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
</span><span class="input-line" id="in32">
(** The proof is automatically done by Squirrel. **)
Proof.</span><span class="output-line" id="out32">[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii:index
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) =&gt;
<span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>

</span><span class="input-line" id="in33"> auto.</span><span class="output-line" id="out33">[&gt; Line 171: auto 
[goal&gt; Goal counterIncreaseStrictly is proved 
</span><span class="input-line" id="in34"> Qed.</span><span class="output-line" id="out34">Exiting proof mode.


</span><span class="input-line" id="in35">

(** The counter `SCpt(i)` increases (not strictly) between `pred(t)`
and `t`. **)
goal counterIncrease (t:timestamp, i : index) :
  happens(t) =&gt;
    (t &gt; init &amp;&amp; exec@t) =&gt;
      (SCpt(i)@pred(t) ~&lt; SCpt(i)@t = orderOk) ||
        (SCpt(i)@t = SCpt(i)@pred(t)).</span><span class="output-line" id="out35">Goal counterIncrease :
  <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t) =&gt;
  (t &gt; <span class="ga" style="color: #00AA00">init</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t) =&gt;
  ((<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t))
</span><span class="input-line" id="in36">
Proof.</span><span class="output-line" id="out36">[goal&gt; Focused goal (1/1):
System: default
Variables: i:index,t:timestamp
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t) =&gt;
(t &gt; <span class="ga" style="color: #00AA00">init</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t) =&gt;
((<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t))

</span><span class="input-line" id="in37">
  (** After having introduced the hypotheses, we perform a case analysis
  on all possible values that the timestamp `t` can take.
  Most cases are trivial and automatically handled by Squirrel (`=&gt; //`)
  because most actions do not update `SCpt(i)` so we automatically have
  that `SCpt(i)@t = SCpt(i)@pred(t)`. **)
  intro Hap [Ht Hexec].</span><span class="output-line" id="out37">[&gt; Line 186: (intro Hap [Ht Hexec]) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i:index,t:timestamp
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t
Ht: t &gt; <span class="ga" style="color: #00AA00">init</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t)

</span><span class="input-line" id="in38">
  case t =&gt; //.</span><span class="output-line" id="out38">[&gt; Line 187: ((case t);(intro //)) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i:index,t:timestamp
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t
Ht: t &gt; <span class="ga" style="color: #00AA00">init</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(exists (ii,i0:index), t = <span class="ga" style="color: #00AA00">S(ii,i0)</span>) =&gt;
((<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t))

</span><span class="input-line" id="in39">

  (** Case where t = S(ii,i0).
  This is the interesting case, where `t` is an action that updates the
  mutable cell `SCpt(i0)`. 
  We distinguish two cases: `i = i0` and `i &lt;&gt; i0`. **)
  intro [ii i0 _].</span><span class="output-line" id="out39">[&gt; Line 193: (intro [ii i0 _]) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,i0,ii:index,t:timestamp
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t
Ht: t &gt; <span class="ga" style="color: #00AA00">init</span>
_: t = <span class="ga" style="color: #00AA00">S(ii,i0)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t)

</span><span class="input-line" id="in40">
  case (i = i0) =&gt; _.</span><span class="output-line" id="out40">[&gt; Line 194: ((case i = i0);(intro _)) 
[goal&gt; Focused goal (1/2):
System: default
Variables: i,ii:index,t:timestamp
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t
Ht: t &gt; <span class="ga" style="color: #00AA00">init</span>
_: t = <span class="ga" style="color: #00AA00">S(ii,i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t)

</span><span class="input-line" id="in41">
    (** The case `i = i0` corresponds to the left disjunct, which is a 
    direct consequence of the condition of the action `SCpt(i)`.
    This is done automatically by Squirrel. **)
    by left.</span><span class="output-line" id="out41">[&gt; Line 198: by left 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,i0,ii:index,t:timestamp
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t
Ht: t &gt; <span class="ga" style="color: #00AA00">init</span>
_: not(i = i0)
_: t = <span class="ga" style="color: #00AA00">S(ii,i0)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t)

</span><span class="input-line" id="in42">
    (** The case `i &lt;&gt; i0` corresponds to the right disjunct. When expanding
    the macro `SCpt(i)@t`, we notice that it is an `if _ then _ else _` term
    with a condition that is always false. This can be simplified using the
    `rewrite` tactic with lemma `if_false` (which is included in the `Basic`
    library. **)
    right.</span><span class="output-line" id="out42">[&gt; Line 204: right 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,i0,ii:index,t:timestamp
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t
Ht: t &gt; <span class="ga" style="color: #00AA00">init</span>
_: not(i = i0)
_: t = <span class="ga" style="color: #00AA00">S(ii,i0)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t)

</span><span class="input-line" id="in43">
    expand SCpt(i)@t.</span><span class="output-line" id="out43">[&gt; Line 205: (expand SCpt(i)@t) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,i0,ii:index,t:timestamp
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t
Ht: t &gt; <span class="ga" style="color: #00AA00">init</span>
_: t = <span class="ga" style="color: #00AA00">S(ii,i0)</span>
_: not(i = i0)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(if i = i0 then <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@t)),<span class="gn" style="color: #AA5500">k</span>(i0))) else <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t)) =
<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t)

</span><span class="input-line" id="in44"> by rewrite if_false.</span><span class="output-line" id="out44">[&gt; Line 205: by (rewrite ...) 
[goal&gt; Goal counterIncrease is proved 
</span><span class="input-line" id="in45">
    (** The two previous tactics can be merged into a single one:
    by rewrite /SCpt if_false. **)
Qed.</span><span class="output-line" id="out45">Exiting proof mode.


</span><span class="input-line" id="in46">

(** The counter `SCpt(i)` increases (not strictly) between `t'` and `t` 
when `t' &lt; t`. **)
goal counterIncreaseBis:
  forall (t:timestamp), forall (t':timestamp), forall (i:index),
    happens(t) =&gt;
      exec@t &amp;&amp; t' &lt; t =&gt;
        (SCpt(i)@t' ~&lt; SCpt(i)@t = orderOk || SCpt(i)@t = SCpt(i)@t').</span><span class="output-line" id="out46">Goal counterIncreaseBis :
  forall (t,t':timestamp,i:index),
    (<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t) =&gt;
     (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t &amp;&amp; t' &lt; t) =&gt;
     ((<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'))
</span><span class="input-line" id="in47">
(** This proof is done by induction, relying on the previous `counterIncrease`
lemma to prove the induction step. **)
Proof.</span><span class="output-line" id="out47">[goal&gt; Focused goal (1/1):
System: default
<span class="sep" style="font-weight: bold">----------------------------------------</span>
forall (t,t':timestamp,i:index),
  (<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t) =&gt;
   (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t &amp;&amp; t' &lt; t) =&gt;
   ((<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'))

</span><span class="input-line" id="in48">
  induction.</span><span class="output-line" id="out48">[&gt; Line 220: induction 
[goal&gt; Focused goal (1/1):
System: default
<span class="sep" style="font-weight: bold">----------------------------------------</span>
forall (t:timestamp),
  ((forall (t0,t':timestamp,i:index),
      (t0 &lt; t =&gt;
       <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;
       (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0) =&gt;
       ((<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'))) =&gt;
   forall (t':timestamp,i:index),
     (<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t) =&gt;
      (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t &amp;&amp; t' &lt; t) =&gt;
      ((<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t')))

</span><span class="input-line" id="in49">
  intro t IH0 t' i Hap [Hexec Ht'].</span><span class="output-line" id="out49">[&gt; Line 221: (intro t IH0 t' i Hap [Hexec Ht']) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i:index,t,t':timestamp
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t
Ht': t' &lt; t
IH0: forall (t0,t':timestamp,i:index),
       (t0 &lt; t =&gt;
        <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;
        (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0) =&gt;
        ((<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'))
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'

</span><span class="input-line" id="in50">
  (** We introduce a case disjunction `t'`. Since we already have that
  `t' &lt; t` then the `constraints` tactic allows to close the goal showing
  that `(t' = pred(t) || t' &lt; pred(t))` is indeed satisfied. **)
  assert (t' = pred(t) || t' &lt; pred(t)) as H0;
    1: constraints.</span><span class="output-line" id="out50">[&gt; Line 226: ((assert (t' = <span>pred</span>(t) || t' &lt; <span>pred</span>(t)), H0); 1: constraints) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i:index,t,t':timestamp
H0: t' = pred(t) || t' &lt; pred(t)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t
Ht': t' &lt; t
IH0: forall (t0,t':timestamp,i:index),
       (t0 &lt; t =&gt;
        <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;
        (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0) =&gt;
        ((<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'))
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'

</span><span class="input-line" id="in51"> 
  case H0.</span><span class="output-line" id="out51">[&gt; Line 227: (case H0) 
[goal&gt; Focused goal (1/2):
System: default
Variables: i:index,t,t':timestamp
H0: t' = pred(t)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t
Ht': t' &lt; t
IH0: forall (t0,t':timestamp,i:index),
       (t0 &lt; t =&gt;
        <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;
        (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0) =&gt;
        ((<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'))
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'

</span><span class="input-line" id="in52">

  (** Case `t' = pred(t)`.
  We first rewrite the conclusion using the equality in H0. The `!` mark is
  here to indicate that the rewriting must be done as much as possible and
  at least once.
  Then, it is a direct consequence of the `counterIncrease` lemma. **)
  rewrite !H0.</span><span class="output-line" id="out52">[&gt; Line 234: (rewrite ...) 
[goal&gt; Focused goal (1/2):
System: default
Variables: i:index,t,t':timestamp
H0: t' = pred(t)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t
Ht': t' &lt; t
IH0: forall (t0,t':timestamp,i:index),
       (t0 &lt; t =&gt;
        <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;
        (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0) =&gt;
        ((<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'))
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t)

</span><span class="input-line" id="in53">
  by apply counterIncrease.</span><span class="output-line" id="out53">[&gt; Line 235: by (apply ... ) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i:index,t,t':timestamp
H0: t' &lt; pred(t)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t
Ht': t' &lt; t
IH0: forall (t0,t':timestamp,i:index),
       (t0 &lt; t =&gt;
        <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;
        (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0) =&gt;
        ((<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'))
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'

</span><span class="input-line" id="in54">

  (** Case t' &lt; pred(t). 
  We first apply the induction hypothesis with `t' &lt; pred(t)` to obtain a
  relation between `SCpt(i)@t'` and `SCpt(i)@pred(t)`.
  We then use the `counterIncrease` lemma, this time to obtain a relation 
  between `SCpt(i)@pred(t)` and `SCpt(i)@t`.
  We will then be able to conclude by transitivity.
  **)
  use IH0 with pred(t),t',i as H1 =&gt; //.</span><span class="output-line" id="out54">[&gt; Line 244: ((assert ... as H1);(intro //)) 
[goal&gt; Focused goal (1/2):
System: default
Variables: i:index,t,t':timestamp
H0: t' &lt; pred(t)
H1: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t)) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t) = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t
Ht': t' &lt; t
IH0: forall (t0,t':timestamp,i:index),
       (t0 &lt; t =&gt;
        <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;
        (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0) =&gt;
        ((<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'))
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'

</span><span class="input-line" id="in55">
  use counterIncrease with t,i as H3 =&gt; //.</span><span class="output-line" id="out55">[&gt; Line 245: ((assert ... as H3);(intro //)) 
[goal&gt; Focused goal (1/2):
System: default
Variables: i:index,t,t':timestamp
H0: t' &lt; pred(t)
H1: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t)) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t) = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'
H3: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t
Ht': t' &lt; t
IH0: forall (t0,t':timestamp,i:index),
       (t0 &lt; t =&gt;
        <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;
        (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0) =&gt;
        ((<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'))
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'

</span><span class="input-line" id="in56">
  case H1 =&gt; //.</span><span class="output-line" id="out56">[&gt; Line 246: ((case H1);(intro //)) 
[goal&gt; Focused goal (1/3):
System: default
Variables: i:index,t,t':timestamp
H0: t' &lt; pred(t)
H1: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t)) = <span class="gf" style="font-weight: bold">orderOk</span>
H3: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t
Ht': t' &lt; t
IH0: forall (t0,t':timestamp,i:index),
       (t0 &lt; t =&gt;
        <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;
        (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0) =&gt;
        ((<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'))
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'

</span><span class="input-line" id="in57">
    (* case H1 - 1/2 *)
    case H3 =&gt; //.</span><span class="output-line" id="out57">[&gt; Line 248: ((case H3);(intro //)) 
[goal&gt; Focused goal (1/3):
System: default
Variables: i:index,t,t':timestamp
H0: t' &lt; pred(t)
H1: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t)) = <span class="gf" style="font-weight: bold">orderOk</span>
H3: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t
Ht': t' &lt; t
IH0: forall (t0,t':timestamp,i:index),
       (t0 &lt; t =&gt;
        <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;
        (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0) =&gt;
        ((<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'))
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'

</span><span class="input-line" id="in58">
    by left; apply orderTrans _ (SCpt(i)@pred(t)) _.</span><span class="output-line" id="out58">[&gt; Line 249: by (left;(apply ... )) 
[goal&gt; Focused goal (1/2):
System: default
Variables: i:index,t,t':timestamp
H0: t' &lt; pred(t)
H1: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t) = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'
H3: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(t)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t
Ht': t' &lt; t
IH0: forall (t0,t':timestamp,i:index),
       (t0 &lt; t =&gt;
        <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;
        (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0) =&gt;
        ((<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'))
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'

</span><span class="input-line" id="in59">
    (* case H1 - 2/2 *)
    by case H3; [1: left | 2 : right].</span><span class="output-line" id="out59">[&gt; Line 251: by ((case H3); [1: left|2: right]) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i:index,t,t':timestamp
H0: t' &lt; pred(t)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t
Ht': t' &lt; t
IH0: forall (t0,t':timestamp,i:index),
       (t0 &lt; t =&gt;
        <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;
        (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0) =&gt;
        ((<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'))
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(t) &amp;&amp; t' &lt; pred(t)

</span><span class="input-line" id="in60">
  (** It remains to show that the premises of the induction hypothesis IH0
  were satisfied, relying on the fact that `exec@t =&gt; exec@pred(t)`. **)
  simpl.</span><span class="output-line" id="out60">[&gt; Line 254: simpl 
[goal&gt; Focused goal (1/1):
System: default
Variables: i:index,t,t':timestamp
H0: t' &lt; pred(t)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t
Ht': t' &lt; t
IH0: forall (t0,t':timestamp,i:index),
       (t0 &lt; t =&gt;
        <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;
        (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0) =&gt;
        ((<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'))
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(t)

</span><span class="input-line" id="in61">
  executable t =&gt; // H1.</span><span class="output-line" id="out61">[&gt; Line 255: ((executable t);(intro // H1)) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i:index,t,t':timestamp
H0: t' &lt; pred(t)
H1: forall (t0:timestamp), (t0 &lt;= t =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t
Ht': t' &lt; t
IH0: forall (t0,t':timestamp,i:index),
       (t0 &lt; t =&gt;
        <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t0) =&gt;
        (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t0 &amp;&amp; t' &lt; t0) =&gt;
        ((<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t' ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0) = <span class="gf" style="font-weight: bold">orderOk</span> || <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t0 = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@t'))
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(t)

</span><span class="input-line" id="in62"> 
  by apply H1.</span><span class="output-line" id="out62">[&gt; Line 256: by (apply ... ) 
[goal&gt; Goal counterIncreaseBis is proved 
</span><span class="input-line" id="in63">
Qed.</span><span class="output-line" id="out63">Exiting proof mode.


</span><span class="input-line" id="in64">

(** SECURITY PROPERTIES
We now state and prove the 3 following security properties:
* Property 1: absence of replay attacks.
* Property 2: injective correspondence.
* Property 3: monotonicity.
**)

(** Property 1: absence of replay attacks.
This property states that the server never accepts for the same YubiKey the
same counter twice, _i.e._ if the trace is executable up until `S(ii1,i)`,
then there cannot exist a previous action `S(ii,i)` in the trace such that
`ii &lt;&gt; ii1` and `SCpt(i)@S(ii,i) = SCpt(i)@S(ii1,i)`.
Note that proving this property does not rely on any assumption on cryptographic
primitives: it relies only on reasonings about counter values.
**)

(** 
We start by proving an invariant (`noreplayInv`) that will be useful in the
main proof.
This intermediate lemma states that whenever the server accepts for a given
YubiKey (represented by the index `i`), the counter value must have increased
compared to the last time the server accepted for this YubiKey.
**)
goal noreplayInv (ii, ii1, i:index):
  happens(S(ii1,i),S(ii,i)) =&gt;
    exec@S(ii1,i) &amp;&amp; S(ii,i) &lt; S(ii1,i) =&gt; 
      SCpt(i)@S(ii,i) ~&lt; SCpt(i)@S(ii1,i) = orderOk.</span><span class="output-line" id="out64">Goal noreplayInv :
  <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
  (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
  (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
</span><span class="input-line" id="in65">
(** The proof relies on the previous helping lemmas reasoning on counter
values. **)
Proof.</span><span class="output-line" id="out65">[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii1:index
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
(<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>

</span><span class="input-line" id="in66">
  intro Hap [Hexec Ht].</span><span class="output-line" id="out66">[&gt; Line 289: (intro Hap [Hexec Ht]) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii1:index
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span>
Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>

</span><span class="input-line" id="in67">
  assert (S(ii,i) = pred(S(ii1,i)) || S(ii,i) &lt; pred(S(ii1,i))) as H1;
    1: constraints.</span><span class="output-line" id="out67">[&gt; Line 291: ((assert (S(ii,i) = <span>pred</span>(S(ii1,i)) || S(ii,i) &lt; <span>pred</span>(S(ii1,i))),
              H1);
             1: constraints)

[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii1:index
H1: <span class="ga" style="color: #00AA00">S(ii,i)</span> = pred(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) || <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; pred(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span>
Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>

</span><span class="input-line" id="in68">
  case H1.</span><span class="output-line" id="out68">[&gt; Line 292: (case H1) 
[goal&gt; Focused goal (1/2):
System: default
Variables: i,ii,ii1:index
H1: <span class="ga" style="color: #00AA00">S(ii,i)</span> = pred(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span>
Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>

</span><span class="input-line" id="in69">
    (* Case S(ii,i) = pred(S(ii1,i)). *)
    use counterIncreaseStrictly with ii1, i as M0 =&gt; //.</span><span class="output-line" id="out69">[&gt; Line 294: ((assert ... as M0);(intro //)) 
[goal&gt; Focused goal (1/2):
System: default
Variables: i,ii,ii1:index
H1: <span class="ga" style="color: #00AA00">S(ii,i)</span> = pred(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span>
Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>
M0: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>

</span><span class="input-line" id="in70">
    congruence.</span><span class="output-line" id="out70">[&gt; Line 295: congruence 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii1:index
H1: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; pred(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span>
Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>

</span><span class="input-line" id="in71">
    (* Case S(ii,i) &lt; pred(S(ii1,i)). *)
    use counterIncreaseBis with pred(S(ii1,i)),S(ii,i),i as H2 =&gt; //.</span><span class="output-line" id="out71">[&gt; Line 297: ((assert ... as H2);(intro //)) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii1:index
H1: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; pred(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)
H2: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)) = <span class="gf" style="font-weight: bold">orderOk</span> ||
    <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span>
Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>

</span><span class="input-line" id="in72">
    case H2 =&gt; //.</span><span class="output-line" id="out72">[&gt; Line 298: ((case H2);(intro //)) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii1:index
H1: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; pred(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)
H2: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)) = <span class="gf" style="font-weight: bold">orderOk</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span>
Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>

</span><span class="input-line" id="in73">
    by apply orderTrans _ (SCpt(i)@pred(S(ii1,i))) _.</span><span class="output-line" id="out73">[&gt; Line 299: by (apply ... ) 
[goal&gt; Goal noreplayInv is proved 
</span><span class="input-line" id="in74">
Qed.</span><span class="output-line" id="out74">Exiting proof mode.


</span><span class="input-line" id="in75">

goal noreplay (ii, ii1, i:index):
  happens(S(ii1,i)) =&gt;
    exec@S(ii1,i) &amp;&amp; S(ii,i) &lt;= S(ii1,i) &amp;&amp; SCpt(i)@S(ii,i) = SCpt(i)@S(ii1,i) =&gt; 
      ii = ii1.</span><span class="output-line" id="out75">Goal noreplay :
  <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
  (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt;= <span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
  ii = ii1
</span><span class="input-line" id="in76">
Proof.</span><span class="output-line" id="out76">[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii1:index
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
(<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt;= <span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
ii = ii1

</span><span class="input-line" id="in77">
  intro Hap [Hexec Ht Meq].</span><span class="output-line" id="out77">[&gt; Line 307: (intro Hap [Hexec Ht Meq]) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii1:index
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span>
Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt;= <span class="ga" style="color: #00AA00">S(ii1,i)</span>
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii = ii1

</span><span class="input-line" id="in78">
  assert (S(ii,i) = S(ii1,i) || S(ii,i) &lt; S(ii1,i)) as H1;
    1: constraints.</span><span class="output-line" id="out78">[&gt; Line 309: ((assert (S(ii,i) = S(ii1,i) || S(ii,i) &lt; S(ii1,i)), H1);
             1: constraints)

[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii1:index
H1: <span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="ga" style="color: #00AA00">S(ii1,i)</span> || <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span>
Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt;= <span class="ga" style="color: #00AA00">S(ii1,i)</span>
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii = ii1

</span><span class="input-line" id="in79">
  (** The case where `S(ii,i) = S(ii1,i)` is trivial and automatically 
  handled by Squirrel.
  For the case where `S(ii,i) &lt; S(ii1,i)`, we use the invariant to show that
  there is a contradiction with the hypothesis Meq. **)
  case H1 =&gt; //.</span><span class="output-line" id="out79">[&gt; Line 314: ((case H1);(intro //)) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii1:index
H1: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span>
Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt;= <span class="ga" style="color: #00AA00">S(ii1,i)</span>
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii = ii1

</span><span class="input-line" id="in80">
  use noreplayInv with ii, ii1, i as M1 =&gt; //.</span><span class="output-line" id="out80">[&gt; Line 315: ((assert ... as M1);(intro //)) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii1:index
H1: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span>
Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt;= <span class="ga" style="color: #00AA00">S(ii1,i)</span>
M1: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii = ii1

</span><span class="input-line" id="in81"> 
  by apply orderStrict in Meq.</span><span class="output-line" id="out81">[&gt; Line 316: by (apply ...  in Meq) 
[goal&gt; Goal noreplay is proved 
</span><span class="input-line" id="in82">
Qed.</span><span class="output-line" id="out82">Exiting proof mode.


</span><span class="input-line" id="in83">


(** Property 2: injective correspondence.
This property states that a successful login for the YubiKey `pid(i)` 
(_i.e._ the execution of action `S(ii,i)`) must have been preceded by 
a button press on this YubiKey for the same counter value (`P(i,j)` with
`cpt(i,j)@Press(i,j) = SCpt(i)@S(ii,i)`), and this counter value is not 
involved in another successful login.
Proving this property requires to reason on counter values, but also requires
the use of the INT-CTXT cryptographic assumption.
**)
goal injective_correspondence (ii,i:index):
  happens(S(ii,i)) =&gt;
    exec@S(ii,i) =&gt;
      exists (j:index), 
        Press(i,j) &lt; S(ii,i) &amp;&amp; cpt(i,j)@Press(i,j) = SCpt(i)@S(ii,i)
        &amp;&amp; forall (ii1:index), happens(S(ii1,i)) =&gt; exec@S(ii1,i) =&gt;
             cpt(i,j)@Press(i,j) = SCpt(i)@S(ii1,i) =&gt; ii1 = ii.</span><span class="output-line" id="out83">Goal injective_correspondence :
  <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) =&gt;
  <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt;
  exists (j:index),
    (<span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;
     forall (ii1:index),
       (<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
        <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii))
</span><span class="input-line" id="in84">
(** The high-level idea of this proof is to use the INT-CTXT assumption:
if the message received by the server is a valid ciphertext, then it must
be equal to an encryption that took place before.
Since the action `Press(i,j)` is the only one that outputs an encryption,
we thus have the existence of such an action before in the trace.
Then, the unicity is proved using lemmas on counter values.
**)
Proof.</span><span class="output-line" id="out84">[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii:index
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>) =&gt;
<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt;
exists (j:index),
  (<span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;
   forall (ii1:index),
     (<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
      <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii))

</span><span class="input-line" id="in85">
  intro Hap Hexec.</span><span class="output-line" id="out85">[&gt; Line 344: (intro Hap Hexec) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii:index
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
exists (j:index),
  (<span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;
   forall (ii1:index),
     (<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
      <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii))

</span><span class="input-line" id="in86">
  executable S(ii,i) =&gt; //.</span><span class="output-line" id="out86">[&gt; Line 345: ((executable S(ii,i));(intro //)) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii:index
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
(forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)) =&gt;
exists (j:index),
  (<span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;
   forall (ii1:index),
     (<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
      <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii))

</span><span class="input-line" id="in87">
  intro Hexec'.</span><span class="output-line" id="out87">[&gt; Line 346: (intro Hexec') 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii:index
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
exists (j:index),
  (<span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;
   forall (ii1:index),
     (<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
      <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii))

</span><span class="input-line" id="in88">
  expand exec, cond.</span><span class="output-line" id="out88">[&gt; Line 347: (expand exec, cond) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii:index
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) &amp;&amp;
       (<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span> &amp;&amp;
        (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
        <span class="gf" style="font-weight: bold">orderOk</span> &amp;&amp; <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i))
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
<span class="sep" style="font-weight: bold">----------------------------------------</span>
exists (j:index),
  (<span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;
   forall (ii1:index),
     (<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
      <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii))

</span><span class="input-line" id="in89">
  destruct Hexec as [Hexecpred [Mneq Hcpt Hpid]].</span><span class="output-line" id="out89">[&gt; Line 348: (destruct Hexec, [Hexecpred [Mneq Hcpt Hpid]]) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii:index
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
exists (j:index),
  (<span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;
   forall (ii1:index),
     (<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
      <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii))

</span><span class="input-line" id="in90">
  (** We apply the INT-CTXT assumption, which directly gives the existence
  of an action `Press(i,j)` that happens before `S(ii,i)`. **)
  intctxt Mneq =&gt; //.</span><span class="output-line" id="out90">[&gt; Line 351: ((intctxt Mneq);(intro //)) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,j:index
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt;
<span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)) =&gt;
i = i =&gt;
exists (j:index),
  (<span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;
   forall (ii1:index),
     (<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
      <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii))

</span><span class="input-line" id="in91">
  intro Ht M1 *.</span><span class="output-line" id="out91">[&gt; Line 352: (intro Ht M1 *) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,j:index
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
exists (j:index),
  (<span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;
   forall (ii1:index),
     (<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
      <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii))

</span><span class="input-line" id="in92">
  exists j.</span><span class="output-line" id="out92">[&gt; Line 353: (exists j) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,j:index
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;
forall (ii1:index),
  (<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
   <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii)

</span><span class="input-line" id="in93">
  (** The two first conjucts of the conclusion are automatically proved
  by Squirrel (the equality of counter values is a consequence of M1 once
  we have expanded the macros `cpt` and `SCpt`. **)
  split =&gt; //.</span><span class="output-line" id="out93">[&gt; Line 357: (split;(intro //)) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,j:index
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
forall (ii1:index),
  (<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
   <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> =&gt; ii1 = ii)

</span><span class="input-line" id="in94">
  (** It now remains to show that the counter value `cpt(i,j)@Press(i,j)` is
  not involved in another successful login.
  We first show if this second successful login `S(ii',i)` had happened, then
  we must have `SCpt(i)@S(ii,i) = SCpt(i)@S(ii',i)`. **)
  intro ii' Hap' Hexec1 Eq.</span><span class="output-line" id="out94">[&gt; Line 362: (intro ii' Hap' Hexec1 Eq) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in95">
  assert (SCpt(i)@S(ii,i) = SCpt(i)@S(ii',i)) =&gt; //.</span><span class="output-line" id="out95">[&gt; Line 363: ((assert SCpt(i)@S(ii,i) = SCpt(i)@S(ii',i));(intro //)) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in96">
  (** The proof now relies only on lemmas about counter values to show that
  we cannot have `SCpt(i)@S(ii,i) = SCpt(i)@S(ii',i)` and `S(ii,i) &lt;&gt; S(ii',i)`.
  We therefore a case disjunction (the first case corresponds to what we want
  to prove, and we will show that the 2 other cases are impossible). **)
  assert (S(ii,i) = S(ii',i) || S(ii,i) &lt; S(ii',i) || S(ii,i) &gt; S(ii',i)) =&gt; //.</span><span class="output-line" id="out96">[&gt; Line 368: ((assert
              ((S(ii,i) = S(ii',i) || S(ii,i) &lt; S(ii',i)) ||
               S(ii,i) &gt; S(ii',i)));
             (intro //))

[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="ga" style="color: #00AA00">S(ii',i)</span> || <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span> || <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in97">
  case H =&gt; //.</span><span class="output-line" id="out97">[&gt; Line 369: ((case H);(intro //)) 
[goal&gt; Focused goal (1/2):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in98">

    (* 1st case: S(ii,i) &lt; S(ii',i) *)
    assert (S(ii,i) = pred(S(ii',i)) || S(ii,i) &lt; pred(S(ii',i))) =&gt; //.</span><span class="output-line" id="out98">[&gt; Line 372: ((assert (S(ii,i) = <span>pred</span>(S(ii',i)) || S(ii,i) &lt; <span>pred</span>(S(ii',i))));
             (intro //))

[goal&gt; Focused goal (1/2):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H0: <span class="ga" style="color: #00AA00">S(ii,i)</span> = pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>) || <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in99">
    case H0 =&gt; //.</span><span class="output-line" id="out99">[&gt; Line 373: ((case H0);(intro //)) 
[goal&gt; Focused goal (1/3):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H0: <span class="ga" style="color: #00AA00">S(ii,i)</span> = pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in100">

      (* S(ii,i) = pred(S(ii',i) &lt; S(ii',i) *)
      use counterIncreaseStrictly with ii',i =&gt; //.</span><span class="output-line" id="out100">[&gt; Line 376: ((assert ... as );(intro //)) 
[goal&gt; Focused goal (1/3):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H0: <span class="ga" style="color: #00AA00">S(ii,i)</span> = pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Meq0: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in101">
      subst  S(ii,i), pred(S(ii',i)) =&gt; //.</span><span class="output-line" id="out101">[&gt; Line 377: ((subst S(ii,i), <span>pred</span>(S(ii',i)));(intro //)) 
[goal&gt; Focused goal (1/3):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>) &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>))
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>)) ~&lt;
       <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>))),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>) =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>))
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>)) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) =
    <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>)))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>) = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Meq0: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>))),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in102">
      by use orderStrict with SCpt(i)@pred(S(ii',i)), SCpt(i)@S(ii',i) =&gt; //.</span><span class="output-line" id="out102">[&gt; Line 378: (by (assert ... as );(intro //)) 
[goal&gt; Focused goal (1/2):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H0: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in103">

      (* S(ii,i) &lt; pred(S(ii',i))  &lt; S(ii',i) *)
      use counterIncreaseStrictly with ii',i =&gt; //.</span><span class="output-line" id="out103">[&gt; Line 381: ((assert ... as );(intro //)) 
[goal&gt; Focused goal (1/2):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H0: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Meq0: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in104">
      use counterIncreaseBis with pred(S(ii',i)), S(ii,i), i =&gt; //.</span><span class="output-line" id="out104">[&gt; Line 382: ((assert ... as );(intro //)) 
[goal&gt; Focused goal (1/2):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H0: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
H1: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>)) = <span class="gf" style="font-weight: bold">orderOk</span> ||
    <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>) = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Meq0: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in105">
      case H1.</span><span class="output-line" id="out105">[&gt; Line 383: (case H1) 
[goal&gt; Focused goal (1/3):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H0: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
H1: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>)) = <span class="gf" style="font-weight: bold">orderOk</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Meq0: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in106">
        use orderTrans with SCpt(i)@S(ii,i), SCpt(i)@pred(S(ii',i)), SCpt(i)@S(ii',i) =&gt; //.</span><span class="output-line" id="out106">[&gt; Line 384: ((assert ... as );(intro //)) 
[goal&gt; Focused goal (1/3):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H0: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
H1: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>)) = <span class="gf" style="font-weight: bold">orderOk</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Meq0: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Meq1: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in107">
        by use orderStrict with SCpt(i)@S(ii,i), SCpt(i)@S(ii',i) =&gt; //.</span><span class="output-line" id="out107">[&gt; Line 385: (by (assert ... as );(intro //)) 
[goal&gt; Focused goal (1/2):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H0: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
H1: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>) = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Meq0: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in108">
        subst SCpt(i)@pred(S(ii',i)), SCpt(i)@S(ii,i).</span><span class="output-line" id="out108">[&gt; Line 386: (subst SCpt(i)@<span>pred</span>(S(ii',i)), SCpt(i)@S(ii,i)) 
[goal&gt; Focused goal (1/2):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H0: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; pred(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Meq0: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in109">
        by use orderStrict with SCpt(i)@S(ii,i), SCpt(i)@S(ii',i) =&gt; //.</span><span class="output-line" id="out109">[&gt; Line 387: (by (assert ... as );(intro //)) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in110">

    (* 2nd case: S(ii,i) &gt; S(ii',i) *)
    assert (pred(S(ii,i)) = S(ii',i) || pred(S(ii,i)) &gt; S(ii',i)) =&gt; //.</span><span class="output-line" id="out110">[&gt; Line 390: ((assert (<span>pred</span>(S(ii,i)) = S(ii',i) || <span>pred</span>(S(ii,i)) &gt; S(ii',i)));
             (intro //))

[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H0: pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="ga" style="color: #00AA00">S(ii',i)</span> || pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in111">
    case H0 =&gt; //.</span><span class="output-line" id="out111">[&gt; Line 391: ((case H0);(intro //)) 
[goal&gt; Focused goal (1/2):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H0: pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="ga" style="color: #00AA00">S(ii',i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in112">

      (* S(ii,i) &gt; pred(S(ii,i)) = S(ii',i) *)
      use counterIncreaseStrictly with ii,i =&gt; //.</span><span class="output-line" id="out112">[&gt; Line 394: ((assert ... as );(intro //)) 
[goal&gt; Focused goal (1/2):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H0: pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="ga" style="color: #00AA00">S(ii',i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Meq0: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in113">
      subst S(ii',i), pred(S(ii,i)).</span><span class="output-line" id="out113">[&gt; Line 395: (subst S(ii',i), <span>pred</span>(S(ii,i))) 
[goal&gt; Focused goal (1/2):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Meq0: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in114">
      by use orderStrict with SCpt(i)@pred(S(ii,i)), SCpt(i)@S(ii,i) =&gt; //.</span><span class="output-line" id="out114">[&gt; Line 396: (by (assert ... as );(intro //)) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H0: pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in115">

      (* S(ii,i) &gt; pred(S(ii,i)) &gt;  S(ii',i) *)
      use counterIncreaseStrictly with ii,i =&gt; //.</span><span class="output-line" id="out115">[&gt; Line 399: ((assert ... as );(intro //)) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H0: pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Meq0: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in116">
      use counterIncreaseBis with pred(S(ii,i)), S(ii',i), i =&gt; //.</span><span class="output-line" id="out116">[&gt; Line 400: ((assert ... as );(intro //)) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H0: pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H1: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)) = <span class="gf" style="font-weight: bold">orderOk</span> ||
    <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Meq0: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in117">
      case H1.</span><span class="output-line" id="out117">[&gt; Line 401: (case H1) 
[goal&gt; Focused goal (1/2):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H0: pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H1: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)) = <span class="gf" style="font-weight: bold">orderOk</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Meq0: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in118">
        use orderTrans with SCpt(i)@S(ii',i), SCpt(i)@pred(S(ii,i)), SCpt(i)@S(ii,i) =&gt; //.</span><span class="output-line" id="out118">[&gt; Line 402: ((assert ... as );(intro //)) 
[goal&gt; Focused goal (1/2):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H0: pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H1: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)) = <span class="gf" style="font-weight: bold">orderOk</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Meq0: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Meq1: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in119">
        by use orderStrict with SCpt(i)@S(ii',i), SCpt(i)@S(ii,i) =&gt; //.</span><span class="output-line" id="out119">[&gt; Line 403: (by (assert ... as );(intro //)) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H0: pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H1: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) =
      <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Meq0: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in120">
        subst SCpt(i)@pred(S(ii,i)), SCpt(i)@S(ii',i).</span><span class="output-line" id="out120">[&gt; Line 404: (subst SCpt(i)@<span>pred</span>(S(ii,i)), SCpt(i)@S(ii',i)) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii',j:index
Eq: <span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
H: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
H0: pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>) &gt; <span class="ga" style="color: #00AA00">S(ii',i)</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hap': <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii',i)</span>)
Hcpt: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> ~&lt; <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)))) = <span class="gf" style="font-weight: bold">orderOk</span>
Hexec': forall (t:timestamp), (t &lt;= <span class="ga" style="color: #00AA00">S(ii,i)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)
Hexec1: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Hexecpred: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">S(ii,i)</span>)
Hpid: <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">pid</span>(i)
Ht: <span class="ga" style="color: #00AA00">Press(i,j)</span> &lt; <span class="ga" style="color: #00AA00">S(ii,i)</span>
M1: <span class="gf" style="font-weight: bold">enc</span>(&lt;<span class="gn" style="color: #AA5500">sid</span>(i),<span class="gm" style="font-weight: bold; color: #AA00AA">cpt</span>(i,j)@<span class="ga" style="color: #00AA00">Press(i,j)</span>&gt;,<span class="gn" style="color: #AA5500">npr</span>(i,j),<span class="gn" style="color: #AA5500">k</span>(i)) = <span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>))
Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span>
Meq0: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii',i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Mneq: <span class="gf" style="font-weight: bold">dec</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>)),<span class="gn" style="color: #AA5500">k</span>(i)) &lt;&gt; <span class="gf" style="font-weight: bold">fail</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
ii' = ii

</span><span class="input-line" id="in121">
        by use orderStrict with SCpt(i)@S(ii',i), SCpt(i)@S(ii,i) =&gt; //.</span><span class="output-line" id="out121">[&gt; Line 405: (by (assert ... as );(intro //)) 
[goal&gt; Goal injective_correspondence is proved 
</span><span class="input-line" id="in122">
Qed.</span><span class="output-line" id="out122">Exiting proof mode.


</span><span class="input-line" id="in123">



(** Property 3: monotonicity.
This property states that the counter values associated to successful logins are
monotonically increasing in time.
Note that proving this property does not rely on any assumption on cryptographic
primitives: it relies only on reasonings about counter values.
**)
goal monotonicity (ii, ii1, i:index):
  happens(S(ii1,i),S(ii,i)) =&gt;
    exec@S(ii1,i) &amp;&amp; exec@S(ii,i)
      &amp;&amp; SCpt(i)@S(ii,i) ~&lt; SCpt(i)@S(ii1,i) = orderOk =&gt; 
        S(ii,i) &lt; S(ii1,i).</span><span class="output-line" id="out123">Goal monotonicity :
  <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
  (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;
   (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>) =&gt;
  <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>
</span><span class="input-line" id="in124">
Proof.</span><span class="output-line" id="out124">[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii1:index
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>) =&gt;
(<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span> &amp;&amp;
 (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>) =&gt;
<span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>

</span><span class="input-line" id="in125">
  intro Hap [Hexec H].</span><span class="output-line" id="out125">[&gt; Line 422: (intro Hap [Hexec H]) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii1:index
H: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>

</span><span class="input-line" id="in126">
  (** We introduce a case disjunction, and we will show that the cases
  `S(ii,i) = S(ii1,i)` and `S(ii,i) &gt; S(ii1,i)` are not possible, relying
  on previous lemmas and axioms on counter values. **)
  assert
    (S(ii,i) = S(ii1,i) || S(ii,i) &lt; S(ii1,i) || S(ii,i) &gt; S(ii1,i)) as Ht;
  1: constraints.</span><span class="output-line" id="out126">[&gt; Line 428: ((assert
              ((S(ii,i) = S(ii1,i) || S(ii,i) &lt; S(ii1,i)) ||
               S(ii,i) &gt; S(ii1,i)),
              Ht);
             1: constraints)

[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii1:index
H: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>
Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="ga" style="color: #00AA00">S(ii1,i)</span> || <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span> || <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>

</span><span class="input-line" id="in127">
  case Ht.</span><span class="output-line" id="out127">[&gt; Line 429: (case Ht) 
[goal&gt; Focused goal (1/3):
System: default
Variables: i,ii,ii1:index
H: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>
Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> = <span class="ga" style="color: #00AA00">S(ii1,i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>

</span><span class="input-line" id="in128">

  (* case S(ii,i) = S(ii1,i) *)
  by use orderStrict with SCpt(i)@S(ii,i),SCpt(i)@S(ii,i).</span><span class="output-line" id="out128">[&gt; Line 432: by (assert ... as ) 
[goal&gt; Focused goal (1/2):
System: default
Variables: i,ii,ii1:index
H: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>
Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>

</span><span class="input-line" id="in129">

  (* case S(ii,i) &lt; S(ii1,i) *)
  assumption.</span><span class="output-line" id="out129">[&gt; Line 435: assumption 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii1:index
H: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>
Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>

</span><span class="input-line" id="in130">

  (* case S(ii,i) &gt; S(ii1,i) *)
  use noreplayInv with ii1, ii, i as Meq =&gt; //.</span><span class="output-line" id="out130">[&gt; Line 438: ((assert ... as Meq);(intro //)) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii1:index
H: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>
Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>
Meq: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>

</span><span class="input-line" id="in131">
  use orderTrans with SCpt(i)@S(ii,i),SCpt(i)@S(ii1,i), SCpt(i)@S(ii,i) =&gt; //.</span><span class="output-line" id="out131">[&gt; Line 439: ((assert ... as );(intro //)) 
[goal&gt; Focused goal (1/1):
System: default
Variables: i,ii,ii1:index
H: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">S(ii,i)</span>, <span class="ga" style="color: #00AA00">S(ii1,i)</span>)
Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii1,i)</span> &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">S(ii,i)</span>
Ht: <span class="ga" style="color: #00AA00">S(ii,i)</span> &gt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>
Meq: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii1,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
Meq0: (<span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span> ~&lt; <span class="gm" style="font-weight: bold; color: #AA00AA">SCpt</span>(i)@<span class="ga" style="color: #00AA00">S(ii,i)</span>) = <span class="gf" style="font-weight: bold">orderOk</span>
<span class="sep" style="font-weight: bold">----------------------------------------</span>
<span class="ga" style="color: #00AA00">S(ii,i)</span> &lt; <span class="ga" style="color: #00AA00">S(ii1,i)</span>

</span><span class="input-line" id="in132">
  by use orderStrict with SCpt(i)@S(ii,i),SCpt(i)@S(ii,i).</span><span class="output-line" id="out132">[&gt; Line 440: by (assert ... as ) 
[goal&gt; Goal monotonicity is proved 
</span><span class="input-line" id="in133">
Qed.</span><span class="output-line" id="out133">Exiting proof mode.


</span></span>
<h1 id="about-this-tutorial">Example</h1>
<div class="example-left">
  <div class="example-buttons">
    <button type="button" class="command" onclick="goto_down()">-</button>
    <button type="button" class="command" onclick="goto_selected()">=></button>
    <button type="button" class="command" onclick="goto_up()">+</button>
    <button type="button" class="command" style="float: right;">doc</button>
  </div>
  <div class="example-code" style="height: 650px;	border-style: none solid solid solid;"><span id="in-line"></span></div>
</div>
<div class="example-left">
  <div class="example-code" style="height: 300px;	border-style: solid solid double none;"><span>Previously:</span>
<span id="prec-line"></span>
  </div>
  <div class="example-code" style="height: 400px;	border-style: none solid solid none;"><span id="out-line"></span></div>
</div>

<script src="script.js"></script>

</body>

