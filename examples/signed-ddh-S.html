<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="UTF-8">

  <title>Squirrel Prover - Squirrel Prover</title>
  
  <link rel="stylesheet" href="style.css">
</head>

<body onkeydown="key(event)">
<span style="display: none;"><span class="squirrel-step" id="step0">
<span class="input-line" id="in0">abstract ok : message<br>abstract ko : message<br><br>name skP : message<br>name skS : message<br><br>channel cP<br>channel cS<br><br>name a : index -&gt; message<br>name b : index -&gt; message<br>name k :  index -&gt; index -&gt; message<br><br>ddh g, (^) where group:message exposants:message.</span>
<span class="output-line" id="out0"></span>
<span class="com-line" id="com0"><h1 id="signed-ddh">SIGNED DDH</h1>
<p>The signed DDH protocol as described in [G] features two roles, P and S. Each role is associated to a secret key (skP and skS).</p>
<ul>
<li>P -&gt; S : &lt;pk(skP), g^a&gt;</li>
<li>S -&gt; P : &lt;pk(skS),g<sup>b&gt;,sign(&lt;&lt;g</sup>a,g^b&gt;,pk(skP)&gt;,skS)</li>
<li>P -&gt; S : sign(&lt;&lt;g<sup>b,g</sup>a&gt;,pk(skS)&gt;,skP)</li>
</ul>
<p>We consider multiple sessions but two agents only (one agent for the role P and one agent for the role S) and show the strong secrecy of the shared key.</p>
<ul>
<li>In this file <code>signed-ddh-S.sp</code>, we show that the key g<sup>a</sup>b as computed by S is indistinguishable from g^k with k fresh (system secretS).</li>
<li>In another file <code>signed-ddh-P.sp</code>, we show that the key g<sup>a</sup>b as computed by P is indistinguishable from g^k with k fresh (system secretP).</li>
</ul>
<p>[G] ISO/IEC 9798-3:2019, IT Security techniques – Entity authentication – Part 3: Mechanisms using digital signature techniques.</p>
<hr />
<p>Declarations are identical to the ones in <code>signed-ddh-P.sp</code>.</p>
</span>
</span>

<span class="squirrel-step" id="step1">
<span class="input-line" id="in1">signature sign,checksign,pk<br><br><br>process P(i:index) =<br>  out(cP, &lt;pk(skP),g^a(i)&gt;);<br>  in(cP, x2);<br>  let gs = snd(fst(x2)) in<br>  let pks = fst(fst(x2)) in<br>  if checksign(snd(x2),pks) = &lt;&lt;g^a(i),gs&gt;,pk(skP)&gt; &amp;&amp; pks = pk(skS) then<br>    out(cP,sign(&lt;&lt;gs,g^a(i)&gt;,pks&gt;,skP))<br><br>process Schall(j:index) =<br>  in(cS, x1);<br>  let gp = snd(x1) in<br>  let pkp = fst(x1) in<br>  if pkp = pk(skP) then<br>    out(cS, &lt; &lt;pk(skS),g^b(j)&gt;, sign(&lt;&lt;gp,g^b(j)&gt;,pkp&gt;,skS)&gt;);<br>    in(cS, x3);<br>    if checksign(x3,pkp) = &lt;&lt;g^b(j),gp&gt;,pk(skS)&gt; then<br>      out(cS,ok);<br>      in(cS, challenge);<br>      try find i such that gp = g^a(i) in<br>        out(cS, diff(g^a(i)^b(j),g^k(i,j)))<br>      else<br>        out(cS, diff(ok,ko))<br><br>system [secretS] (!_i P(i) | !_j Schall(j)).</span>
<span class="output-line" id="out1">Un-processed system:<br>  <br>  (!_i <span class="pn" style="font-weight:bold; color: #0000AA">P</span> i) | (!_j <span class="pn" style="font-weight:bold; color: #0000AA">Schall</span> j)<br><br>Processed system:<br>  <br>  (!_i<br>     P:<br>     <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cP</span>,pair(pk(skP),(g ^ a(i))));<br>     <span class="pio" style="font-weight: bold">in</span>(<span class="pc">cP</span>,<span class="pv" style="font-weight: bold; color: #AA00AA">x2</span>);<br>     <span class="pk" style="font-weight: bold">let</span> <span class="pv" style="font-weight: bold; color: #AA00AA">gs</span> = snd(fst(x2)) <span class="pk" style="font-weight: bold">in</span><br>     <span class="pk" style="font-weight: bold">let</span> <span class="pv" style="font-weight: bold; color: #AA00AA">pks</span> = fst(fst(x2)) <span class="pk" style="font-weight: bold">in</span><br>     <span class="pc" style="text-decoration: underline; color: #AA0000">if</span> (checksign(snd(x2),pks(i)) = pair(pair((g ^ a(i)),gs(i)),pk(skP)) &amp;&amp;<br>         pks(i) = pk(skS)) <span class="pc" style="text-decoration: underline; color: #AA0000">then</span><br>       P1: <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cP</span>,sign(pair(pair(gs(i),(g ^ a(i))),pks(i)),skP)); <span class="pn" style="font-weight:bold; color: #0000AA">null</span> <span class="pc" style="text-decoration: underline; color: #AA0000">else</span><br>       P2: <span class="pn" style="font-weight:bold; color: #0000AA">null</span>) |<br>  (!_j<br>     <span class="pio" style="font-weight: bold">in</span>(<span class="pc">cS</span>,<span class="pv" style="font-weight: bold; color: #AA00AA">x1</span>);<br>     <span class="pk" style="font-weight: bold">let</span> <span class="pv" style="font-weight: bold; color: #AA00AA">gp</span> = snd(x1) <span class="pk" style="font-weight: bold">in</span><br>     <span class="pk" style="font-weight: bold">let</span> <span class="pv" style="font-weight: bold; color: #AA00AA">pkp</span> = fst(x1) <span class="pk" style="font-weight: bold">in</span><br>     <span class="pc" style="text-decoration: underline; color: #AA0000">if</span> pkp(j) = pk(skP) <span class="pc" style="text-decoration: underline; color: #AA0000">then</span><br>       Schall:<br>       <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cS</span>,<br>       pair(pair(pk(skS),(g ^ b(j))),<br>             sign(pair(pair(gp(j),(g ^ b(j))),pkp(j)),skS)));<br>       <span class="pio" style="font-weight: bold">in</span>(<span class="pc">cS</span>,<span class="pv" style="font-weight: bold; color: #AA00AA">x3</span>);<br>       <span class="pc" style="text-decoration: underline; color: #AA0000">if</span> checksign(x3,pkp(j)) = pair(pair((g ^ b(j)),gp(j)),pk(skS)) <span class="pc" style="text-decoration: underline; color: #AA0000">then</span><br>         Schall1:<br>         <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cS</span>,ok);<br>         <span class="pio" style="font-weight: bold">in</span>(<span class="pc">cS</span>,<span class="pv" style="font-weight: bold; color: #AA00AA">challenge</span>);<br>         <span class="pc" style="text-decoration: underline; color: #AA0000">find</span> (i) <span class="pc" style="text-decoration: underline; color: #AA0000">such that</span> gp(j) = (g ^ a(i)) <span class="pc" style="text-decoration: underline; color: #AA0000">in</span><br>           Schall2: <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cS</span>,<span>diff</span>(((g ^ a(i)) ^ b(j)),(g ^ k(i,j)))); <span class="pn" style="font-weight:bold; color: #0000AA">null</span> <span class="pc" style="text-decoration: underline; color: #AA0000">else</span><br>           Schall3: <span class="pio" style="font-weight: bold">out</span>(<span class="pc">cS</span>,<span>diff</span>(ok,ko)); <span class="pn" style="font-weight:bold; color: #0000AA">null</span> <span class="pc" style="text-decoration: underline; color: #AA0000">else</span> Schall4: <span class="pn" style="font-weight:bold; color: #0000AA">null</span> <span class="pc" style="text-decoration: underline; color: #AA0000">else</span><br>       Schall5: <span class="pn" style="font-weight:bold; color: #0000AA">null</span>)<br><br>System secretS registered with actions (init,P,P1,P2,Schall,Schall1,Schall2,<br>                                         Schall3,Schall4,Schall5).<br></span>
<span class="com-line" id="com1"><p>The system <code>secretS</code> is the counterpart of the system <code>secretP</code> defined in the file <code>signed-ddh-P.sp</code>.</p>
<p>This time, we add an output at the end of the role of S.</p>
</span>
</span>

<span class="squirrel-step" id="step2">
<span class="input-line" id="in2">goal [secretS] S_charac (j:index):<br>  happens(Schall1(j)) =&gt;<br>    exec@Schall1(j) =&gt;<br>      exists (i:index), snd(input@Schall(j)) = g^a(i).</span>
<span class="output-line" id="out2">Goal S_charac :<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall1(j)</span>) =&gt;<br>  <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span> =&gt; exists (i:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))<br></span>
<span class="com-line" id="com2"><p>In the proof of strong secrecy for the system <code>secretS</code>, we will use the following property, stating that whenever S accepts a message from P, this message is of the form <code>&lt;&lt;_,x&gt;,_&gt;</code> where <code>x = g^a(i)</code>.</p>
</span>
</span>

<span class="squirrel-step" id="step3">
<span class="input-line" id="in3"><br>Proof.</span>
<span class="output-line" id="out3">[goal&gt; Focused goal (1/1):<br>System: secretS<br>Variables: j:index<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br><span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall1(j)</span>) =&gt;<br><span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span> =&gt; exists (i:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))<br><br></span>
</span>

<span class="squirrel-step" id="step4">
<span class="input-line" id="in4"><br>  intro Hap Hexec.</span>
<span class="output-line" id="out4">[goal&gt; Focused goal (1/1):<br>System: secretS<br>Variables: j:index<br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>D0: <span class="gm" style="font-weight: bold; color: #AA00AA">pkp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>D1: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall1(j)</span>))<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall1(j)</span>)<br>Hexec: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>exists (i:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))<br><br></span>
</span>

<span class="squirrel-step" id="step5">
<span class="input-line" id="in5"><br>  expand exec.</span>
<span class="output-line" id="out5">[goal&gt; Focused goal (1/1):<br>System: secretS<br>Variables: j:index<br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>D0: <span class="gm" style="font-weight: bold; color: #AA00AA">pkp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>D1: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall1(j)</span>))<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Schall1(j)</span>)<br>H0: <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall1(j)</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>exists (i:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))<br><br></span>
</span>

<span class="squirrel-step" id="step6">
<span class="input-line" id="in6"><br>  executable pred(Schall1(j)).</span>
<span class="output-line" id="out6">[goal&gt; Focused goal (1/1):<br>System: secretS<br>Variables: j:index<br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>D0: <span class="gm" style="font-weight: bold; color: #AA00AA">pkp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>D1: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall1(j)</span>))<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Schall1(j)</span>)<br>H0: <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span><br>H1: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Schall1(j)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall1(j)</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>exists (i:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))<br><br></span>
</span>

<span class="squirrel-step" id="step7">
<span class="input-line" id="in7"><br>  depends Schall(j), Schall1(j).</span>
<span class="output-line" id="out7">[goal&gt; Focused goal (1/1):<br>System: secretS<br>Variables: j:index<br>Clt: <span class="ga" style="color: #00AA00">Schall(j)</span> &lt; <span class="ga" style="color: #00AA00">Schall1(j)</span><br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>D0: <span class="gm" style="font-weight: bold; color: #AA00AA">pkp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>D1: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall1(j)</span>))<br>D2: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall(j)</span>))<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Schall1(j)</span>)<br>H0: <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span><br>H1: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Schall1(j)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall1(j)</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>exists (i:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))<br><br></span>
</span>

<span class="squirrel-step" id="step8">
<span class="input-line" id="in8"><br>  use H1 with Schall(j).</span>
<span class="output-line" id="out8">[goal&gt; Focused goal (1/1):<br>System: secretS<br>Variables: j:index<br>Clt: <span class="ga" style="color: #00AA00">Schall(j)</span> &lt; <span class="ga" style="color: #00AA00">Schall1(j)</span><br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>D0: <span class="gm" style="font-weight: bold; color: #AA00AA">pkp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>D1: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall1(j)</span>))<br>D2: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall(j)</span>))<br>D3: <span class="gm" style="font-weight: bold; color: #AA00AA">pkp</span>(j)@<span class="ga" style="color: #00AA00">Schall(j)</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Schall1(j)</span>)<br>H0: <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span><br>H1: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Schall1(j)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)<br>H2: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">Schall(j)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall1(j)</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>exists (i:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))<br><br></span>
</span>

<span class="squirrel-step" id="step9">
<span class="input-line" id="in9"><br>  expand exec, cond, pkp(j)@Schall1(j).</span>
<span class="output-line" id="out9">[goal&gt; Focused goal (1/1):<br>System: secretS<br>Variables: j:index<br>Clt: <span class="ga" style="color: #00AA00">Schall(j)</span> &lt; <span class="ga" style="color: #00AA00">Schall1(j)</span><br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>D1: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall1(j)</span>))<br>D2: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall(j)</span>))<br>D3: <span class="gm" style="font-weight: bold; color: #AA00AA">pkp</span>(j)@<span class="ga" style="color: #00AA00">Schall(j)</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Schall1(j)</span>)<br>H0: <span class="gf" style="font-weight: bold">checksign</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span>,<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)) =<br>    &lt;&lt;<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span>&gt;,<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skS</span>)&gt;<br>H1: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Schall1(j)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)<br>H2: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall1(j)</span>)<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">pkp</span>(j)@<span class="ga" style="color: #00AA00">Schall(j)</span> = <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skP</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>exists (i:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))<br><br></span>
</span>

<span class="squirrel-step" id="step10">
<span class="input-line" id="in10"><br>  assert fst(input@Schall(j)) = pk(skP) as Meq'.</span>
<span class="output-line" id="out10">[goal&gt; Focused goal (1/1):<br>System: secretS<br>Variables: j:index<br>Clt: <span class="ga" style="color: #00AA00">Schall(j)</span> &lt; <span class="ga" style="color: #00AA00">Schall1(j)</span><br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>D1: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall1(j)</span>))<br>D2: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall(j)</span>))<br>D3: <span class="gm" style="font-weight: bold; color: #AA00AA">pkp</span>(j)@<span class="ga" style="color: #00AA00">Schall(j)</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Schall1(j)</span>)<br>H0: <span class="gf" style="font-weight: bold">checksign</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span>,<span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)) =<br>    &lt;&lt;<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span>&gt;,<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skS</span>)&gt;<br>H1: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Schall1(j)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)<br>H2: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall1(j)</span>)<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">pkp</span>(j)@<span class="ga" style="color: #00AA00">Schall(j)</span> = <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skP</span>)<br>Meq': <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>) = <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skP</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>exists (i:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))<br><br></span>
</span>

<span class="squirrel-step" id="step11">
<span class="input-line" id="in11"><br>  rewrite Meq' in H0.</span>
<span class="output-line" id="out11">[goal&gt; Focused goal (1/1):<br>System: secretS<br>Variables: j:index<br>Clt: <span class="ga" style="color: #00AA00">Schall(j)</span> &lt; <span class="ga" style="color: #00AA00">Schall1(j)</span><br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>D1: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall1(j)</span>))<br>D2: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall(j)</span>))<br>D3: <span class="gm" style="font-weight: bold; color: #AA00AA">pkp</span>(j)@<span class="ga" style="color: #00AA00">Schall(j)</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Schall1(j)</span>)<br>H0: <span class="gf" style="font-weight: bold">checksign</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span>,<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skP</span>)) =<br>    &lt;&lt;<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span>&gt;,<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skS</span>)&gt;<br>H1: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Schall1(j)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)<br>H2: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall1(j)</span>)<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">pkp</span>(j)@<span class="ga" style="color: #00AA00">Schall(j)</span> = <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skP</span>)<br>Meq': <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>) = <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skP</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>exists (i:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))<br><br></span>
</span>

<span class="squirrel-step" id="step12">
<span class="input-line" id="in12"><br>  euf H0.</span>
<span class="output-line" id="out12">[goal&gt; Focused goal (1/1):<br>System: secretS<br>Variables: i,j:index<br>Clt: <span class="ga" style="color: #00AA00">Schall(j)</span> &lt; <span class="ga" style="color: #00AA00">Schall1(j)</span><br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>D1: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall1(j)</span>))<br>D2: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall(j)</span>))<br>D3: <span class="gm" style="font-weight: bold; color: #AA00AA">pkp</span>(j)@<span class="ga" style="color: #00AA00">Schall(j)</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Schall1(j)</span>)<br>H0: <span class="gf" style="font-weight: bold">checksign</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span>,<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skP</span>)) =<br>    &lt;&lt;<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span>&gt;,<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skS</span>)&gt;<br>H1: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Schall1(j)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)<br>H2: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>H3: <span class="ga" style="color: #00AA00">P1(i)</span> &lt;= <span class="ga" style="color: #00AA00">Schall1(j)</span> || <span class="ga" style="color: #00AA00">P1(i)</span> &lt; <span class="ga" style="color: #00AA00">Schall1(j)</span><br>Hap: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall1(j)</span>)<br>Meq: <span class="gm" style="font-weight: bold; color: #AA00AA">pkp</span>(j)@<span class="ga" style="color: #00AA00">Schall(j)</span> = <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skP</span>)<br>Meq': <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>) = <span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skP</span>)<br>Meq0: &lt;&lt;<span class="gm" style="font-weight: bold; color: #AA00AA">gs</span>(i)@<span class="ga" style="color: #00AA00">P1(i)</span>,<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)&gt;,<span class="gm" style="font-weight: bold; color: #AA00AA">pks</span>(i)@<span class="ga" style="color: #00AA00">P1(i)</span>&gt; =<br>      &lt;&lt;<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span>&gt;,<span class="gf" style="font-weight: bold">pk</span>(<span class="gn" style="color: #AA5500">skS</span>)&gt;<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>exists (i:index), <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))<br><br></span>
</span>

<span class="squirrel-step" id="step13">
<span class="input-line" id="in13"><br>  by exists i.</span>
<span class="output-line" id="out13">[goal&gt; Goal S_charac is proved <br></span>
</span>

<span class="squirrel-step" id="step14">
<span class="input-line" id="in14"><br>Qed.</span>
<span class="output-line" id="out14">Exiting proof mode.<br><br><br></span>
</span>

<span class="squirrel-step" id="step15">
<span class="input-line" id="in15">equiv [secretS] strongSecS.</span>
<span class="output-line" id="out15">Goal strongSecS :<br>  forall t:timestamp, <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@t<br></span>
<span class="com-line" id="com15"><p>We show the counterpart of the property <code>strongSecP</code>, this time for the system <code>secretS</code>. The proof is carried out exactly in the same way.</p>
</span>
</span>

<span class="squirrel-step" id="step16">
<span class="input-line" id="in16"><br>Proof.</span>
<span class="output-line" id="out16">[goal&gt; Focused goal (1/1):<br>Systems: secretS<br>Variables: t:timestamp<br>H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)]<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@t<br><br><br></span>
</span>

<span class="squirrel-step" id="step17">
<span class="input-line" id="in17"><br>  enrich<br>    skP, skS,<br>    seq(i:index -&gt;g^a(i)),<br>    seq(j:index -&gt;g^b(j)),<br>    seq(i,j:index -&gt;diff(g^a(i)^b(j),g^k(i,j))).</span>
<span class="output-line" id="out17">[goal&gt; Focused goal (1/1):<br>Systems: secretS<br>Variables: t:timestamp<br>H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(t)]<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))<br>1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br>3: <span class="gn" style="color: #AA5500">skS</span><br>4: <span class="gn" style="color: #AA5500">skP</span><br>5: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@t<br><br><br></span>
</span>

<span class="squirrel-step" id="step18">
<span class="input-line" id="in18"><br><br>  induction t; try (by expandall; apply IH).</span>
<span class="output-line" id="out18">[goal&gt; Focused goal (1/2):<br>Systems: secretS<br>H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">init</span>)]<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))<br>1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br>3: <span class="gn" style="color: #AA5500">skS</span><br>4: <span class="gn" style="color: #AA5500">skP</span><br>5: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@<span class="ga" style="color: #00AA00">init</span><br><br><br></span>
</span>

<span class="squirrel-step" id="step19">
<span class="input-line" id="in19"><br><br>  (* init *)<br>  expandall.</span>
<span class="output-line" id="out19">[goal&gt; Focused goal (1/2):<br>Systems: secretS<br>H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">init</span>)]<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))<br>1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br>3: <span class="gn" style="color: #AA5500">skS</span><br>4: <span class="gn" style="color: #AA5500">skP</span><br><br><br></span>
</span>

<span class="squirrel-step" id="step20">
<span class="input-line" id="in20"><br>  by ddh g,a,b,k.</span>
<span class="output-line" id="out20">[goal&gt; Focused goal (1/1):<br>Systems: secretS<br>Variables: j:index<br>H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall3(j)</span>)]<br>IH: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j))),<br>    seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))), seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))), <span class="gn" style="color: #AA5500">skS</span>, <span class="gn" style="color: #AA5500">skP</span>,<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall3(j)</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))<br>1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br>3: <span class="gn" style="color: #AA5500">skS</span><br>4: <span class="gn" style="color: #AA5500">skP</span><br>5: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@<span class="ga" style="color: #00AA00">Schall3(j)</span><br><br><br></span>
</span>

<span class="squirrel-step" id="step21">
<span class="input-line" id="in21"><br><br>  (* Schall3 *)<br>  expand frame, exec, output.</span>
<span class="output-line" id="out21">[goal&gt; Focused goal (1/1):<br>Systems: secretS<br>Variables: j:index<br>H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall3(j)</span>)]<br>IH: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j))),<br>    seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))), seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))), <span class="gn" style="color: #AA5500">skS</span>, <span class="gn" style="color: #AA5500">skP</span>,<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall3(j)</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))<br>1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br>3: <span class="gn" style="color: #AA5500">skS</span><br>4: <span class="gn" style="color: #AA5500">skP</span><br>5: &lt;<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall3(j)</span>),<br>    &lt;<span class="gf" style="font-weight: bold">of_bool</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Schall3(j)</span>) &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Schall3(j)</span>),<br>     if (<span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Schall3(j)</span>) &amp;&amp; <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Schall3(j)</span>) then diff(<span class="gf" style="font-weight: bold">ok</span>,<span class="gf" style="font-weight: bold">ko</span>)&gt;&gt;<br><br><br></span>
</span>

<span class="squirrel-step" id="step22">
<span class="input-line" id="in22"><br>  equivalent exec@pred(Schall3(j)) &amp;&amp; cond@Schall3(j), False.</span>
<span class="output-line" id="out22">[goal&gt; Focused goal (1/2):<br>System: secretS<br>Variables: j:index<br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall3(j)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall3(j)</span>)<br>H0: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Schall3(j)</span>)<br>H1: <span class="gm" style="font-weight: bold; color: #AA00AA">cond</span>@<span class="ga" style="color: #00AA00">Schall3(j)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>false<br><br></span>
</span>

<span class="squirrel-step" id="step23">
<span class="input-line" id="in23"><br>    expand cond.</span>
<span class="output-line" id="out23">[goal&gt; Focused goal (1/2):<br>System: secretS<br>Variables: j:index<br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall3(j)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall3(j)</span>)<br>H0: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Schall3(j)</span>)<br>H1: forall (i:index), not(<span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall3(j)</span> = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>false<br><br></span>
</span>

<span class="squirrel-step" id="step24">
<span class="input-line" id="in24"><br>    executable pred(Schall3(j)).</span>
<span class="output-line" id="out24">[goal&gt; Focused goal (1/2):<br>System: secretS<br>Variables: j:index<br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall3(j)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall3(j)</span>)<br>H0: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Schall3(j)</span>)<br>H1: forall (i:index), not(<span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall3(j)</span> = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br>H2: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Schall3(j)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>false<br><br></span>
</span>

<span class="squirrel-step" id="step25">
<span class="input-line" id="in25"><br>    depends Schall1(j), Schall3(j).</span>
<span class="output-line" id="out25">[goal&gt; Focused goal (1/2):<br>System: secretS<br>Variables: j:index<br>Clt: <span class="ga" style="color: #00AA00">Schall1(j)</span> &lt; <span class="ga" style="color: #00AA00">Schall3(j)</span><br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall3(j)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall3(j)</span>)<br>H0: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Schall3(j)</span>)<br>H1: forall (i:index), not(<span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall3(j)</span> = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br>H2: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Schall3(j)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>false<br><br></span>
</span>

<span class="squirrel-step" id="step26">
<span class="input-line" id="in26"><br>    use H2 with Schall1(j).</span>
<span class="output-line" id="out26">[goal&gt; Focused goal (1/2):<br>System: secretS<br>Variables: j:index<br>Clt: <span class="ga" style="color: #00AA00">Schall1(j)</span> &lt; <span class="ga" style="color: #00AA00">Schall3(j)</span><br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall3(j)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>D0: <span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>D1: <span class="gm" style="font-weight: bold; color: #AA00AA">pkp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>D2: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall1(j)</span>))<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall3(j)</span>)<br>H0: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Schall3(j)</span>)<br>H1: forall (i:index), not(<span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall3(j)</span> = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br>H2: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Schall3(j)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)<br>H3: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span><br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>false<br><br></span>
</span>

<span class="squirrel-step" id="step27">
<span class="input-line" id="in27"><br>    use S_charac with j.</span>
<span class="output-line" id="out27">[goal&gt; Focused goal (1/2):<br>System: secretS<br>Variables: i,j:index<br>Clt: <span class="ga" style="color: #00AA00">Schall1(j)</span> &lt; <span class="ga" style="color: #00AA00">Schall3(j)</span><br>D: <span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall3(j)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>D0: <span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>D1: <span class="gm" style="font-weight: bold; color: #AA00AA">pkp</span>(j)@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">fst</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>)<br>D2: <span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span> = <span class="gf" style="font-weight: bold">att</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall1(j)</span>))<br>H: <span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall3(j)</span>)<br>H0: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@pred(<span class="ga" style="color: #00AA00">Schall3(j)</span>)<br>H1: forall (i:index), not(<span class="gm" style="font-weight: bold; color: #AA00AA">gp</span>(j)@<span class="ga" style="color: #00AA00">Schall3(j)</span> = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br>H2: forall (t:timestamp), (t &lt; <span class="ga" style="color: #00AA00">Schall3(j)</span> =&gt; <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@t)<br>H3: <span class="gm" style="font-weight: bold; color: #AA00AA">exec</span>@<span class="ga" style="color: #00AA00">Schall1(j)</span><br>Meq: <span class="gf" style="font-weight: bold">snd</span>(<span class="gm" style="font-weight: bold; color: #AA00AA">input</span>@<span class="ga" style="color: #00AA00">Schall(j)</span>) = (<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>false<br><br></span>
</span>

<span class="squirrel-step" id="step28">
<span class="input-line" id="in28"><br>    by use H1 with i.</span>
<span class="output-line" id="out28">[goal&gt; Focused goal (1/1):<br>Systems: secretS<br>Variables: j:index<br>H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall3(j)</span>)]<br>IH: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j))),<br>    seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))), seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))), <span class="gn" style="color: #AA5500">skS</span>, <span class="gn" style="color: #AA5500">skP</span>,<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall3(j)</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))<br>1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br>3: <span class="gn" style="color: #AA5500">skS</span><br>4: <span class="gn" style="color: #AA5500">skP</span><br>5: &lt;<span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall3(j)</span>),&lt;<span class="gf" style="font-weight: bold">of_bool</span>(false),if false then diff(<span class="gf" style="font-weight: bold">ok</span>,<span class="gf" style="font-weight: bold">ko</span>)&gt;&gt;<br><br><br></span>
</span>

<span class="squirrel-step" id="step29">
<span class="input-line" id="in29"><br>  fa 5.</span>
<span class="output-line" id="out29">[goal&gt; Focused goal (1/1):<br>Systems: secretS<br>Variables: j:index<br>H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall3(j)</span>)]<br>IH: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j))),<br>    seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))), seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))), <span class="gn" style="color: #AA5500">skS</span>, <span class="gn" style="color: #AA5500">skP</span>,<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall3(j)</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))<br>1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br>3: <span class="gn" style="color: #AA5500">skS</span><br>4: <span class="gn" style="color: #AA5500">skP</span><br>5: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall3(j)</span>)<br>6: &lt;<span class="gf" style="font-weight: bold">of_bool</span>(false),if false then diff(<span class="gf" style="font-weight: bold">ok</span>,<span class="gf" style="font-weight: bold">ko</span>)&gt;<br><br><br></span>
</span>

<span class="squirrel-step" id="step30">
<span class="input-line" id="in30"> fa 6.</span>
<span class="output-line" id="out30">[goal&gt; Focused goal (1/1):<br>Systems: secretS<br>Variables: j:index<br>H: [<span class="gm" style="font-weight: bold; color: #AA00AA">happens</span>(<span class="ga" style="color: #00AA00">Schall3(j)</span>)]<br>IH: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j))),<br>    seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j))), seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i))), <span class="gn" style="color: #AA5500">skS</span>, <span class="gn" style="color: #AA5500">skP</span>,<br>    <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall3(j)</span>)<br><span class="sep" style="font-weight: bold">----------------------------------------</span><br>0: seq(i,j:index-&gt;diff(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i) ^ <span class="gn" style="color: #AA5500">b</span>(j),<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">k</span>(i,j)))<br>1: seq(j:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">b</span>(j)))<br>2: seq(i:index-&gt;(<span class="gf" style="font-weight: bold">g</span> ^ <span class="gn" style="color: #AA5500">a</span>(i)))<br>3: <span class="gn" style="color: #AA5500">skS</span><br>4: <span class="gn" style="color: #AA5500">skP</span><br>5: <span class="gm" style="font-weight: bold; color: #AA00AA">frame</span>@pred(<span class="ga" style="color: #00AA00">Schall3(j)</span>)<br>6: if false then diff(<span class="gf" style="font-weight: bold">ok</span>,<span class="gf" style="font-weight: bold">ko</span>)<br><br><br></span>
</span>

<span class="squirrel-step" id="step31">
<span class="input-line" id="in31"><br>  by noif 6.</span>
<span class="output-line" id="out31">[goal&gt; Goal strongSecS is proved <br></span>
</span>

<span class="squirrel-step" id="step32">
<span class="input-line" id="in32"><br>Qed.</span>
<span class="output-line" id="out32">Exiting proof mode.<br><br><br></span>
</span>

</span>
<div class="page-header">
  <img src="../logo-circular.png" class="logo">
  <h1 class="project-tagline">Squirrel Prover</h1>
  <a href="https://squirrel-prover.github.io/examples.html" class="header-button">
    <button type="button" class="header-button">Exit</button>
  </a>
  <button type="button" class="header-button" onclick="help()" id="button-panel">Help</button>
</div>

<div class="help-panel" id="help-panel">
  Press the left and right arrows to do and undo an instruction.
  <br><br>
  Alternatively, you can double-click or an instruction.
  <br><br>
  <span style="color: #8B0000;" onmouseenter="highlightOn('in-zone')" onmouseleave="highlightOff('in-zone')">This zone</span> show a squirrel file. You can double-click on a commentary to collapse it for better readabilility.
  <br><br>
  <span style="color: #8B0000;" onmouseenter="highlightOn('out-zone')" onmouseleave="highlightOff('out-zone')">This zone</span> show the output given by Squirrel.
  <br><br>
  <span style="color: #8B0000;" onmouseenter="highlightOn('prec-zone')" onmouseleave="highlightOff('prec-zone')">This zone</span> show the output of the previous instruction to explicit the change caused by a tactic.
</div>

<div class="mainsection" id="main">
  <div class="example-grid">
    <div class="example-col example-col-left" id="in-zone">
      <p class="example-code"><span id="in-line"></span></p>
    </div>
    <div class="example-col example-col-right">
      <div class="example-code example-code-right" style="height: 45%;	border-bottom: 4px double #8B0000;" id="prec-zone"><span>Previously:</span><br><br><span id="prec-line"></span>
      </div>
      <div style="position: relative;">
      <button type="button" class="prec-button" onclick="hidePrec()" id="prec-button" >Hide</button>
      </div>
      <div class="example-code example-code-right" style="height: 55%;" id="out-zone"><span id="out-line"></span>
      </div>
    </div>
  </div>
</div>

<script src="script.js"></script>

</body>

